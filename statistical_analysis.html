<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dylan Carter">

<title>Statistical Analyses</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="statistical_analysis_files/libs/clipboard/clipboard.min.js"></script>
<script src="statistical_analysis_files/libs/quarto-html/quarto.js"></script>
<script src="statistical_analysis_files/libs/quarto-html/popper.min.js"></script>
<script src="statistical_analysis_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="statistical_analysis_files/libs/quarto-html/anchor.min.js"></script>
<link href="statistical_analysis_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="statistical_analysis_files/libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="statistical_analysis_files/libs/quarto-html/quarto-syntax-highlighting-dark-8ea72dc5fed832574809a9c94082fbbb.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="statistical_analysis_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="statistical_analysis_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="statistical_analysis_files/libs/bootstrap/bootstrap-81e35ebdb4125010edbabe6010586085.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="statistical_analysis_files/libs/bootstrap/bootstrap-dark-7189104584608726a80707a12c970cfd.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script src="statistical_analysis_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="statistical_analysis_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#load-all-required-packages" id="toc-load-all-required-packages" class="nav-link active" data-scroll-target="#load-all-required-packages">Load all required packages</a></li>
  <li><a href="#demographic-and-anthropometric-data-analysis" id="toc-demographic-and-anthropometric-data-analysis" class="nav-link" data-scroll-target="#demographic-and-anthropometric-data-analysis">Demographic and anthropometric data analysis</a>
  <ul class="collapse">
  <li><a href="#plotting" id="toc-plotting" class="nav-link" data-scroll-target="#plotting">Plotting</a></li>
  </ul></li>
  <li><a href="#motor-unit-data-analyses" id="toc-motor-unit-data-analyses" class="nav-link" data-scroll-target="#motor-unit-data-analyses">Motor unit data analyses</a></li>
  <li><a href="#coherence-plotting" id="toc-coherence-plotting" class="nav-link" data-scroll-target="#coherence-plotting">Coherence plotting</a></li>
  <li><a href="#clustering-analysis" id="toc-clustering-analysis" class="nav-link" data-scroll-target="#clustering-analysis">Clustering analysis</a></li>
  <li><a href="#online-resource-1" id="toc-online-resource-1" class="nav-link" data-scroll-target="#online-resource-1">Online Resource 1</a></li>
  <li><a href="#online-resource-2" id="toc-online-resource-2" class="nav-link" data-scroll-target="#online-resource-2">Online Resource 2</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Statistical Analyses</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Dylan Carter </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="load-all-required-packages" class="level2">
<h2 class="anchored" data-anchor-id="load-all-required-packages">Load all required packages</h2>
<p>Install if required:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("tidyverse")</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("boot")</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("bootES")</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("kableExtra")</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("ggpubr")</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("ggpp")</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("gt")</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("patchwork")</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("rsvg")</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("grid")</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># if (!require("devtools")) install.packages("devtools")</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># devtools::install_github("psyteachr/introdataviz")</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("ggtext")</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("ggbeeswarm")</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("lme4")</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("lmerTest")</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("merTools")</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("emmeans")</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("performance")</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("qqplotr")</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("ggplotify")</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("dtwclust")</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("cluster")</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("ggh4x")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Load:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootES)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(introdataviz)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpp)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rsvg)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grid)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggbeeswarm)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(merTools)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(qqplotr)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggtext)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplotify)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtable)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dtwclust)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cluster)</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggh4x)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12765</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="demographic-and-anthropometric-data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="demographic-and-anthropometric-data-analysis">Demographic and anthropometric data analysis</h2>
<p>Load input data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>demographic_anthropometric_force_data <span class="ot">&lt;-</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_csv</span>(<span class="st">"demographic_anthropometric_force_data.csv"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">testing_group =</span> <span class="fu">as.factor</span>(testing_group))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="descriptives-table" class="level4">
<h4 class="anchored" data-anchor-id="descriptives-table">Descriptives table</h4>
<p><strong>Table 1</strong> Anthropometric and demographic data. Shown as means (<em>±</em> standard deviation (SD)).</p>
<div class="cell">
<details class="code-fold">
<summary>Show function to create descriptives table</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FUNCTION: create_descriptives_table</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Creates formatted table for several descriptive variables.</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># (age, height, mass, hand training time, testing group)</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Inputs:</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># - data: "demographic_anthropometric_force_data.csv".</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Outputs:</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co"># - Formatted table of descriptive measures</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>create_descriptives_table <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 1: Select and rename relevant columns for analysis</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select demographic variables and testing group</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Rename columns to more readable format for final table</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  general_descriptives <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(age, height, mass, specific_training_time, testing_group) <span class="sc">%&gt;%</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Hand Training Time</span><span class="st">`</span> <span class="ot">=</span> specific_training_time,</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Age</span><span class="st">`</span> <span class="ot">=</span> age,</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Height</span><span class="st">`</span> <span class="ot">=</span> height,</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Mass</span><span class="st">`</span> <span class="ot">=</span> mass</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 2: Calculate summary statistics by testing group</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Group data by testing_group and calculate mean and SD for each variable</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># .names parameter creates new column names in format: variable_statistic</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(testing_group) <span class="sc">%&gt;%</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="fu">list</span>(</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">mean =</span> <span class="sc">~</span><span class="fu">mean</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>),  <span class="co"># Calculate mean, removing NA values</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">sd =</span> <span class="sc">~</span><span class="fu">sd</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>)       <span class="co"># Calculate std dev, removing NA values</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>    ), <span class="at">.names =</span> <span class="st">"{col}_{fn}"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 3: Reshape data for presentation</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># First pivot: Transform summary statistics into separate rows</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Converts from wide to long format</span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">cols =</span> <span class="sc">-</span>testing_group,           <span class="co"># Keep testing_group as is</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"Variable"</span>, <span class="st">".value"</span>), <span class="co"># Split column names into variable name and statistic type</span></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">names_pattern =</span> <span class="st">"^(.*)_(mean|sd)$"</span>  <span class="co"># Pattern to match column names</span></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Second pivot: Create separate columns for each testing group</span></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Transforms data to have mean and SD columns for each group</span></span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">names_from =</span> testing_group,      <span class="co"># Create columns based on testing group</span></span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">values_from =</span> <span class="fu">c</span>(mean, sd)        <span class="co"># Spread mean and SD values</span></span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 4: Format table using gt (great table) package</span></span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>  general_descriptives <span class="sc">%&gt;%</span></span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Format all numeric columns to 2 decimal places</span></span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fmt_number</span>(</span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> <span class="fu">everything</span>(),</span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>      <span class="at">decimals =</span> <span class="dv">2</span></span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 5: Rename columns with clear, formatted labels</span></span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cols_label</span>(</span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>      <span class="at">Variable =</span> <span class="st">"Measure"</span>,</span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>      <span class="at">mean_dexterity =</span> <span class="st">"Mean"</span>,</span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>      <span class="at">sd_dexterity =</span> <span class="fu">md</span>(<span class="st">"&amp;plusmn;SD"</span>),  <span class="co"># Plus/minus symbol (markdown)</span></span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>      <span class="at">mean_strength =</span> <span class="st">"Mean"</span>,</span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>      <span class="at">sd_strength =</span> <span class="fu">md</span>(<span class="st">"&amp;plusmn;SD"</span>)    <span class="co"># Plus/minus symbol (markdown)</span></span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 6: Add column groupings (spanners)</span></span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Group strength-related columns</span></span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_spanner</span>(</span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="st">"Strength-trained"</span>,</span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> <span class="fu">c</span>(mean_strength, sd_strength)</span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Group dexterity-related columns</span></span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_spanner</span>(</span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="st">"Dexterity-Trained"</span>,</span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> <span class="fu">c</span>(mean_dexterity, sd_dexterity)</span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb4-79"><a href="#cb4-79" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-80"><a href="#cb4-80" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 7: Set column widths for consistent formatting</span></span>
<span id="cb4-81"><a href="#cb4-81" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cols_width</span>(</span>
<span id="cb4-82"><a href="#cb4-82" aria-hidden="true" tabindex="-1"></a>      Variable <span class="sc">~</span> <span class="fu">px</span>(<span class="dv">250</span>),       <span class="co"># Variable names get more space</span></span>
<span id="cb4-83"><a href="#cb4-83" aria-hidden="true" tabindex="-1"></a>      <span class="fu">everything</span>() <span class="sc">~</span> <span class="fu">px</span>(<span class="dv">100</span>)    <span class="co"># All other columns same width</span></span>
<span id="cb4-84"><a href="#cb4-84" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb4-85"><a href="#cb4-85" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-86"><a href="#cb4-86" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 8: Apply table styling options</span></span>
<span id="cb4-87"><a href="#cb4-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_options</span>(</span>
<span id="cb4-88"><a href="#cb4-88" aria-hidden="true" tabindex="-1"></a>      <span class="at">table.background.color =</span> <span class="st">"white"</span>,</span>
<span id="cb4-89"><a href="#cb4-89" aria-hidden="true" tabindex="-1"></a>      <span class="at">row.striping.background_color =</span> <span class="st">"white"</span>,</span>
<span id="cb4-90"><a href="#cb4-90" aria-hidden="true" tabindex="-1"></a>      <span class="at">table_body.hlines.style =</span> <span class="st">"none"</span>,           <span class="co"># Remove horizontal lines in body</span></span>
<span id="cb4-91"><a href="#cb4-91" aria-hidden="true" tabindex="-1"></a>      <span class="at">column_labels.border.bottom.color =</span> <span class="st">"black"</span>, <span class="co"># Add borders to column labels</span></span>
<span id="cb4-92"><a href="#cb4-92" aria-hidden="true" tabindex="-1"></a>      <span class="at">column_labels.border.top.color =</span> <span class="st">"black"</span>,</span>
<span id="cb4-93"><a href="#cb4-93" aria-hidden="true" tabindex="-1"></a>      <span class="at">table_body.border.bottom.color =</span> <span class="st">"black"</span>,   <span class="co"># Add border to bottom of table</span></span>
<span id="cb4-94"><a href="#cb4-94" aria-hidden="true" tabindex="-1"></a>      <span class="at">table.border.top.color =</span> <span class="st">"black"</span>,           <span class="co"># Add border to top of table</span></span>
<span id="cb4-95"><a href="#cb4-95" aria-hidden="true" tabindex="-1"></a>      <span class="at">table.border.bottom.color =</span> <span class="st">"black"</span>,</span>
<span id="cb4-96"><a href="#cb4-96" aria-hidden="true" tabindex="-1"></a>      <span class="at">heading.border.bottom.color =</span> <span class="st">"black"</span></span>
<span id="cb4-97"><a href="#cb4-97" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb4-98"><a href="#cb4-98" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-99"><a href="#cb4-99" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 9: Disable row striping</span></span>
<span id="cb4-100"><a href="#cb4-100" aria-hidden="true" tabindex="-1"></a>    <span class="fu">opt_row_striping</span>(</span>
<span id="cb4-101"><a href="#cb4-101" aria-hidden="true" tabindex="-1"></a>      <span class="at">row_striping =</span> <span class="cn">FALSE</span></span>
<span id="cb4-102"><a href="#cb4-102" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-103"><a href="#cb4-103" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>descriptive_table <span class="ot">&lt;-</span> <span class="fu">create_descriptives_table</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  demographic_anthropometric_force_data)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>descriptive_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="msngxoybdp" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#msngxoybdp table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#msngxoybdp thead, #msngxoybdp tbody, #msngxoybdp tfoot, #msngxoybdp tr, #msngxoybdp td, #msngxoybdp th {
  border-style: none;
}

#msngxoybdp p {
  margin: 0;
  padding: 0;
}

#msngxoybdp .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #000000;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#msngxoybdp .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#msngxoybdp .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#msngxoybdp .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#msngxoybdp .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#msngxoybdp .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
}

#msngxoybdp .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#msngxoybdp .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#msngxoybdp .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#msngxoybdp .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#msngxoybdp .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#msngxoybdp .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#msngxoybdp .gt_spanner_row {
  border-bottom-style: hidden;
}

#msngxoybdp .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#msngxoybdp .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#msngxoybdp .gt_from_md > :first-child {
  margin-top: 0;
}

#msngxoybdp .gt_from_md > :last-child {
  margin-bottom: 0;
}

#msngxoybdp .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: none;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#msngxoybdp .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#msngxoybdp .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#msngxoybdp .gt_row_group_first td {
  border-top-width: 2px;
}

#msngxoybdp .gt_row_group_first th {
  border-top-width: 2px;
}

#msngxoybdp .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#msngxoybdp .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#msngxoybdp .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#msngxoybdp .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#msngxoybdp .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#msngxoybdp .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#msngxoybdp .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#msngxoybdp .gt_striped {
  background-color: #FFFFFF;
}

#msngxoybdp .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
}

#msngxoybdp .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#msngxoybdp .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#msngxoybdp .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#msngxoybdp .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#msngxoybdp .gt_left {
  text-align: left;
}

#msngxoybdp .gt_center {
  text-align: center;
}

#msngxoybdp .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#msngxoybdp .gt_font_normal {
  font-weight: normal;
}

#msngxoybdp .gt_font_bold {
  font-weight: bold;
}

#msngxoybdp .gt_font_italic {
  font-style: italic;
}

#msngxoybdp .gt_super {
  font-size: 65%;
}

#msngxoybdp .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#msngxoybdp .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#msngxoybdp .gt_indent_1 {
  text-indent: 5px;
}

#msngxoybdp .gt_indent_2 {
  text-indent: 10px;
}

#msngxoybdp .gt_indent_3 {
  text-indent: 15px;
}

#msngxoybdp .gt_indent_4 {
  text-indent: 20px;
}

#msngxoybdp .gt_indent_5 {
  text-indent: 25px;
}

#msngxoybdp .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#msngxoybdp div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings gt_spanner_row header">
<th rowspan="2" id="Measure" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Measure</th>
<th colspan="2" id="Dexterity-Trained" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><span class="gt_column_spanner">Dexterity-Trained</span></th>
<th colspan="2" id="Strength-trained" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><span class="gt_column_spanner">Strength-trained</span></th>
</tr>
<tr class="gt_col_headings even">
<th id="Mean" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Mean</th>
<th id="<div data-qmd-base64=&quot;JnBsdXNtbjtTRA==&quot;><div class='gt_from_md'><p>±SD</p>
</div></div>" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col"><p>±SD</p></th>
<th id="Mean" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Mean</th>
<th id="<div data-qmd-base64=&quot;JnBsdXNtbjtTRA==&quot;><div class='gt_from_md'><p>±SD</p>
</div></div>" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col"><p>±SD</p></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Variable">Age</td>
<td class="gt_row gt_right" headers="mean_dexterity">23.00</td>
<td class="gt_row gt_right" headers="sd_dexterity">5.27</td>
<td class="gt_row gt_right" headers="mean_strength">23.70</td>
<td class="gt_row gt_right" headers="sd_strength">4.06</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variable">Height</td>
<td class="gt_row gt_right" headers="mean_dexterity">182.80</td>
<td class="gt_row gt_right" headers="sd_dexterity">7.26</td>
<td class="gt_row gt_right" headers="mean_strength">174.04</td>
<td class="gt_row gt_right" headers="sd_strength">5.94</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variable">Mass</td>
<td class="gt_row gt_right" headers="mean_dexterity">74.99</td>
<td class="gt_row gt_right" headers="sd_dexterity">9.22</td>
<td class="gt_row gt_right" headers="mean_strength">67.41</td>
<td class="gt_row gt_right" headers="sd_strength">8.66</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variable">Hand Training Time</td>
<td class="gt_row gt_right" headers="mean_dexterity">12.10</td>
<td class="gt_row gt_right" headers="sd_dexterity">4.04</td>
<td class="gt_row gt_right" headers="mean_strength">13.47</td>
<td class="gt_row gt_right" headers="sd_strength">4.55</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="calculate-bootstrapped-means-and-95-confidence-intervals-for-each-group" class="level4">
<h4 class="anchored" data-anchor-id="calculate-bootstrapped-means-and-95-confidence-intervals-for-each-group">Calculate bootstrapped means and 95% confidence intervals for each group</h4>
<ul>
<li><p>Each calculation uses 10000 bootstrapped samples (with replacement).</p></li>
<li><p>The calculations are used later for plotting.</p></li>
<li><p>NOTE: this script may produce bootstrapped means and 95% CI marginally different from those published. This is common with the bootstrapping approach, as bootstrapping involves random resampling of data. The changes will be minimal, given we have set a seed at the beginning of this script, and will not affect overall conclusions.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show functions to calculate group mean and 95% CI</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FUNCTION: calculate_group_boot_confint</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculates bootstrap confidence intervals separately for dexterity and strength groups</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Inputs:</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># - dataframe: "demographic_anthropometric_force_data.csv". </span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># - columns to exclude: participant ID and testing group (as these do not need to be analysed).</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># - number of bootstrap replicates: R = 10000 is used.</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Outputs:</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co"># - dataframe containing bootstrapped means and 95% confidence intervals for each group/column</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>calculate_group_boot_confint <span class="ot">&lt;-</span> <span class="cf">function</span>(data, <span class="at">exclude_columns =</span> <span class="fu">c</span>(<span class="st">"participant"</span>, <span class="st">"testing_group"</span>), <span class="at">R =</span> <span class="dv">10000</span>) {</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get columns to analyze (excluding specified ones)</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  columns_to_include <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="fu">names</span>(data), exclude_columns)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Process each column with the bootstrapping "boot" function.</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  ci_means <span class="ot">&lt;-</span> <span class="fu">lapply</span>(columns_to_include, <span class="cf">function</span>(column) {</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Bootstrap for dexterity group means</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    results_dexterity <span class="ot">&lt;-</span> <span class="fu">boot</span>(data, </span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>                              \(data, indices) <span class="fu">mean_per_group</span>(data, indices, <span class="st">"dexterity"</span>, column), </span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>                              R)</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Bootstrap for strength group means</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    results_strength <span class="ot">&lt;-</span> <span class="fu">boot</span>(data, </span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>                             \(data, indices) <span class="fu">mean_per_group</span>(data, indices, <span class="st">"strength"</span>, column), </span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>                             R)</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate 95% confidence intervals using percentile method</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>    ci_dexterity <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(results_dexterity, <span class="at">type =</span> <span class="st">"perc"</span>)</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>    ci_strength <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(results_strength, <span class="at">type =</span> <span class="st">"perc"</span>)</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Combine results into single dataframe with group means and 95% CIs</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">Testing_Variable =</span> column,</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">testing_group =</span> <span class="fu">c</span>(<span class="st">"dexterity"</span>, <span class="st">"strength"</span>),</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">Mean =</span> <span class="fu">c</span>(<span class="fu">mean</span>(data[[column]][data<span class="sc">$</span>testing_group <span class="sc">==</span> <span class="st">"dexterity"</span>]),</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>               <span class="fu">mean</span>(data[[column]][data<span class="sc">$</span>testing_group <span class="sc">==</span> <span class="st">"strength"</span>])),</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">Lower_CI =</span> <span class="fu">c</span>(ci_dexterity<span class="sc">$</span>percent[<span class="dv">4</span>], ci_strength<span class="sc">$</span>percent[<span class="dv">4</span>]),  <span class="co"># 2.5th percentile</span></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">Upper_CI =</span> <span class="fu">c</span>(ci_dexterity<span class="sc">$</span>percent[<span class="dv">5</span>], ci_strength<span class="sc">$</span>percent[<span class="dv">5</span>])   <span class="co"># 97.5th percentile</span></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">do.call</span>(rbind, ci_means) <span class="sc">%&gt;%</span>   <span class="co"># Combine all results</span></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">'Mean'</span>, <span class="st">'Lower_CI'</span>, <span class="st">'Upper_CI'</span>), \(x) <span class="fu">round</span>(x, <span class="dv">5</span>))) <span class="co"># Round to 5 decimal places</span></span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a><span class="co"># HELPER FUNCTION: mean_per_group</span></span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function to calculate mean for a specific group during bootstrap</span></span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Used by calculate_group_boot_confint</span></span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>mean_per_group <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices, testing_group, column) {</span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> data[indices, ]  <span class="co"># Get bootstrap sample</span></span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>  group_data <span class="ot">&lt;-</span> d[[column]][d<span class="sc">$</span>testing_group <span class="sc">==</span> testing_group]  <span class="co"># Extract group data</span></span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(group_data))  <span class="co"># Calculate mean</span></span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>group_means_and_ci_boot <span class="ot">&lt;-</span> <span class="fu">calculate_group_boot_confint</span>(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    demographic_anthropometric_force_data)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>rounded_group_means_and_ci_boot <span class="ot">&lt;-</span> group_means_and_ci_boot <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">'Mean'</span>, <span class="st">'Lower_CI'</span>, <span class="st">'Upper_CI'</span>), \(x) <span class="fu">round</span>(x, <span class="dv">2</span>))) <span class="co"># Round to 2dp</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(rounded_group_means_and_ci_boot) <span class="sc">%&gt;%</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collapse_rows</span>(<span class="at">columns =</span> <span class="dv">1</span>, <span class="at">valign =</span> <span class="st">"middle"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Testing_Variable</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">testing_group</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Lower_CI</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Upper_CI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="2" style="text-align: left; vertical-align: middle !important;">age</td>
<td style="text-align: left;">dexterity</td>
<td style="text-align: right;">23.00</td>
<td style="text-align: right;">20.11</td>
<td style="text-align: right;">26.50</td>
</tr>
<tr class="even">
<td style="text-align: left;">strength</td>
<td style="text-align: right;">23.70</td>
<td style="text-align: right;">21.67</td>
<td style="text-align: right;">26.50</td>
</tr>
<tr class="odd">
<td rowspan="2" style="text-align: left; vertical-align: middle !important;">height</td>
<td style="text-align: left;">dexterity</td>
<td style="text-align: right;">182.80</td>
<td style="text-align: right;">178.61</td>
<td style="text-align: right;">187.37</td>
</tr>
<tr class="even">
<td style="text-align: left;">strength</td>
<td style="text-align: right;">174.04</td>
<td style="text-align: right;">170.58</td>
<td style="text-align: right;">177.73</td>
</tr>
<tr class="odd">
<td rowspan="2" style="text-align: left; vertical-align: middle !important;">mass</td>
<td style="text-align: left;">dexterity</td>
<td style="text-align: right;">74.99</td>
<td style="text-align: right;">69.07</td>
<td style="text-align: right;">80.33</td>
</tr>
<tr class="even">
<td style="text-align: left;">strength</td>
<td style="text-align: right;">67.41</td>
<td style="text-align: right;">62.37</td>
<td style="text-align: right;">72.79</td>
</tr>
<tr class="odd">
<td rowspan="2" style="text-align: left; vertical-align: middle !important;">forearm_circumference</td>
<td style="text-align: left;">dexterity</td>
<td style="text-align: right;">264.20</td>
<td style="text-align: right;">256.86</td>
<td style="text-align: right;">271.73</td>
</tr>
<tr class="even">
<td style="text-align: left;">strength</td>
<td style="text-align: right;">276.50</td>
<td style="text-align: right;">262.64</td>
<td style="text-align: right;">287.22</td>
</tr>
<tr class="odd">
<td rowspan="2" style="text-align: left; vertical-align: middle !important;">fds_thickness</td>
<td style="text-align: left;">dexterity</td>
<td style="text-align: right;">191.65</td>
<td style="text-align: right;">175.22</td>
<td style="text-align: right;">206.42</td>
</tr>
<tr class="even">
<td style="text-align: left;">strength</td>
<td style="text-align: right;">195.11</td>
<td style="text-align: right;">173.71</td>
<td style="text-align: right;">217.02</td>
</tr>
<tr class="odd">
<td rowspan="2" style="text-align: left; vertical-align: middle !important;">time_taken_to_complete_dexterity</td>
<td style="text-align: left;">dexterity</td>
<td style="text-align: right;">15.47</td>
<td style="text-align: right;">14.26</td>
<td style="text-align: right;">16.64</td>
</tr>
<tr class="even">
<td style="text-align: left;">strength</td>
<td style="text-align: right;">17.54</td>
<td style="text-align: right;">16.29</td>
<td style="text-align: right;">18.93</td>
</tr>
<tr class="odd">
<td rowspan="2" style="text-align: left; vertical-align: middle !important;">dexterity_accuracy</td>
<td style="text-align: left;">dexterity</td>
<td style="text-align: right;">98.45</td>
<td style="text-align: right;">97.46</td>
<td style="text-align: right;">99.44</td>
</tr>
<tr class="even">
<td style="text-align: left;">strength</td>
<td style="text-align: right;">99.38</td>
<td style="text-align: right;">98.45</td>
<td style="text-align: right;">100.00</td>
</tr>
<tr class="odd">
<td rowspan="2" style="text-align: left; vertical-align: middle !important;">dexterity_attempts</td>
<td style="text-align: left;">dexterity</td>
<td style="text-align: right;">1.10</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.33</td>
</tr>
<tr class="even">
<td style="text-align: left;">strength</td>
<td style="text-align: right;">1.10</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.33</td>
</tr>
<tr class="odd">
<td rowspan="2" style="text-align: left; vertical-align: middle !important;">max_force</td>
<td style="text-align: left;">dexterity</td>
<td style="text-align: right;">112.64</td>
<td style="text-align: right;">99.47</td>
<td style="text-align: right;">124.69</td>
</tr>
<tr class="even">
<td style="text-align: left;">strength</td>
<td style="text-align: right;">130.02</td>
<td style="text-align: right;">119.56</td>
<td style="text-align: right;">139.16</td>
</tr>
<tr class="odd">
<td rowspan="2" style="text-align: left; vertical-align: middle !important;">max_force_bodymass_normalised</td>
<td style="text-align: left;">dexterity</td>
<td style="text-align: right;">1.53</td>
<td style="text-align: right;">1.30</td>
<td style="text-align: right;">1.76</td>
</tr>
<tr class="even">
<td style="text-align: left;">strength</td>
<td style="text-align: right;">1.94</td>
<td style="text-align: right;">1.80</td>
<td style="text-align: right;">2.09</td>
</tr>
<tr class="odd">
<td rowspan="2" style="text-align: left; vertical-align: middle !important;">max_force_fds_thickness_normalised</td>
<td style="text-align: left;">dexterity</td>
<td style="text-align: right;">0.59</td>
<td style="text-align: right;">0.53</td>
<td style="text-align: right;">0.65</td>
</tr>
<tr class="even">
<td style="text-align: left;">strength</td>
<td style="text-align: right;">0.68</td>
<td style="text-align: right;">0.62</td>
<td style="text-align: right;">0.75</td>
</tr>
<tr class="odd">
<td rowspan="2" style="text-align: left; vertical-align: middle !important;">max_force_forearm_circumference_normalised</td>
<td style="text-align: left;">dexterity</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">0.47</td>
</tr>
<tr class="even">
<td style="text-align: left;">strength</td>
<td style="text-align: right;">0.47</td>
<td style="text-align: right;">0.45</td>
<td style="text-align: right;">0.50</td>
</tr>
<tr class="odd">
<td rowspan="2" style="text-align: left; vertical-align: middle !important;">specific_training_time</td>
<td style="text-align: left;">dexterity</td>
<td style="text-align: right;">12.10</td>
<td style="text-align: right;">9.89</td>
<td style="text-align: right;">14.67</td>
</tr>
<tr class="even">
<td style="text-align: left;">strength</td>
<td style="text-align: right;">13.47</td>
<td style="text-align: right;">10.75</td>
<td style="text-align: right;">16.25</td>
</tr>
<tr class="odd">
<td rowspan="2" style="text-align: left; vertical-align: middle !important;">general_resistance_training_time</td>
<td style="text-align: left;">dexterity</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">1.33</td>
</tr>
<tr class="even">
<td style="text-align: left;">strength</td>
<td style="text-align: right;">1.10</td>
<td style="text-align: right;">0.29</td>
<td style="text-align: right;">2.17</td>
</tr>
<tr class="odd">
<td rowspan="2" style="text-align: left; vertical-align: middle !important;">cov_force_15</td>
<td style="text-align: left;">dexterity</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.05</td>
</tr>
<tr class="even">
<td style="text-align: left;">strength</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.04</td>
</tr>
<tr class="odd">
<td rowspan="2" style="text-align: left; vertical-align: middle !important;">cov_force_35</td>
<td style="text-align: left;">dexterity</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.03</td>
</tr>
<tr class="even">
<td style="text-align: left;">strength</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.03</td>
</tr>
<tr class="odd">
<td rowspan="2" style="text-align: left; vertical-align: middle !important;">cov_force_55</td>
<td style="text-align: left;">dexterity</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.03</td>
</tr>
<tr class="even">
<td style="text-align: left;">strength</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.03</td>
</tr>
<tr class="odd">
<td rowspan="2" style="text-align: left; vertical-align: middle !important;">cov_force_70</td>
<td style="text-align: left;">dexterity</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.03</td>
</tr>
<tr class="even">
<td style="text-align: left;">strength</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.03</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="calculate-mean-differences-and-95-confidence-intervals" class="level4">
<h4 class="anchored" data-anchor-id="calculate-mean-differences-and-95-confidence-intervals">Calculate mean differences and 95% confidence intervals</h4>
<p><strong>Each calculation uses the formula</strong></p>
<ul>
<li><p><span class="math inline">\(\bar{x}_{(dexterity-trained)}- \bar{x}_{(strength-trained)}\)</span>.</p></li>
<li><p>Therefore:</p>
<ul>
<li><p>If CI is <em>positive and doesn’t cross 0</em>: dexterity-trained&gt;strength-trained.</p></li>
<li><p>If CI is <em>negative and doesn’t cross 0</em>: strength-trained&gt;dexterity-trained.</p></li>
<li><p>If CI <em>crosses 0</em>: no difference between groups.</p></li>
</ul></li>
<li><p>NOTE: this script may produce bootstrapped mean differences and 95% CI marginally different from those published. This is common with the bootstrapping approach, as bootstrapping involves random resampling. The changes will be incredibly minimal, given we have set a seed at the beginning of this script, and would not affect overall conclusions.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show functions to calculate mean differences and 95% CI</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FUNCTION: calculate_meandiff_boot_confint</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculates bootstrap confidence intervals for differences between groups</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Inputs:</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co"># - dataframe: "demographic_anthropometric_force_data.csv". </span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># - columns to exclude: participant ID and testing group (as these do not need to be analysed).</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co"># - number of bootstrap replicates: R = 10000 is used.</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Outputs:</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co"># - dataframe containing bootstrapped group difference of means and their 95% confidence intervals.</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>calculate_meandiff_boot_confint <span class="ot">&lt;-</span> <span class="cf">function</span>(data, <span class="at">exclude_columns =</span> <span class="fu">c</span>(<span class="st">"participant"</span>, <span class="st">"testing_group"</span>), <span class="at">R =</span> <span class="dv">10000</span>) {</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  columns_to_include <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="fu">names</span>(data), exclude_columns)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Process each column with the bootstrapping "boot" function.</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  ci_results <span class="ot">&lt;-</span> <span class="fu">lapply</span>(columns_to_include, <span class="cf">function</span>(column) {</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate bootstrap samples of mean differences</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    results <span class="ot">&lt;-</span> <span class="fu">boot</span>(data, \(data, indices) <span class="fu">mean_diff</span>(data, indices, column), R)</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>    ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(results, <span class="at">type =</span> <span class="st">"perc"</span>)  <span class="co"># Get confidence intervals</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Store results with column name</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">Testing_Variable =</span> column,</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">Mean_Diff =</span> <span class="fu">mean_diff</span>(data, <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data), column),</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">Lower_CI =</span> ci<span class="sc">$</span>percent[<span class="dv">4</span>],    <span class="co"># 2.5th percentile</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">Upper_CI =</span> ci<span class="sc">$</span>percent[<span class="dv">5</span>]     <span class="co"># 97.5th percentile</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine and round results</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">do.call</span>(rbind, ci_results) <span class="sc">%&gt;%</span> </span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">'Mean_Diff'</span>, <span class="st">'Lower_CI'</span>, <span class="st">'Upper_CI'</span>), \(x) <span class="fu">round</span>(x, <span class="dv">5</span>))) <span class="co"># Round to 5 decimal places</span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a><span class="co"># HELPER FUNCTION: mean_diff</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function to calculate difference in means between groups</span></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Used by calculate_meandiff_boot_confint</span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>mean_diff <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices, column) {</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> data[indices, ]  <span class="co"># Get bootstrap sample</span></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate means for each group</span></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>  dexterity <span class="ot">&lt;-</span> d[[column]][d<span class="sc">$</span>testing_group <span class="sc">==</span> <span class="st">"dexterity"</span>]</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>  strength <span class="ot">&lt;-</span> d[[column]][d<span class="sc">$</span>testing_group <span class="sc">==</span> <span class="st">"strength"</span>]</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(dexterity) <span class="sc">-</span> <span class="fu">mean</span>(strength))  <span class="co"># Return difference</span></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>mean_difference_ci_boot <span class="ot">&lt;-</span> <span class="fu">calculate_meandiff_boot_confint</span>(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  demographic_anthropometric_force_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>rounded_mean_difference_ci_boot <span class="ot">&lt;-</span> mean_difference_ci_boot <span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">'Mean_Diff'</span>, <span class="st">'Lower_CI'</span>, <span class="st">'Upper_CI'</span>), \(x) <span class="fu">round</span>(x, <span class="dv">2</span>))) <span class="co"># Round to 2 dp</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(rounded_mean_difference_ci_boot) <span class="sc">%&gt;%</span> </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>,<span class="st">"condensed"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Testing_Variable</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mean_Diff</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Lower_CI</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Upper_CI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">age</td>
<td style="text-align: right;">-0.70</td>
<td style="text-align: right;">-4.50</td>
<td style="text-align: right;">3.40</td>
</tr>
<tr class="even">
<td style="text-align: left;">height</td>
<td style="text-align: right;">8.76</td>
<td style="text-align: right;">3.21</td>
<td style="text-align: right;">14.59</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mass</td>
<td style="text-align: right;">7.58</td>
<td style="text-align: right;">-0.47</td>
<td style="text-align: right;">15.02</td>
</tr>
<tr class="even">
<td style="text-align: left;">forearm_circumference</td>
<td style="text-align: right;">-12.30</td>
<td style="text-align: right;">-25.90</td>
<td style="text-align: right;">3.39</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fds_thickness</td>
<td style="text-align: right;">-3.46</td>
<td style="text-align: right;">-30.52</td>
<td style="text-align: right;">22.19</td>
</tr>
<tr class="even">
<td style="text-align: left;">time_taken_to_complete_dexterity</td>
<td style="text-align: right;">-2.07</td>
<td style="text-align: right;">-3.87</td>
<td style="text-align: right;">-0.40</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dexterity_accuracy</td>
<td style="text-align: right;">-0.93</td>
<td style="text-align: right;">-2.17</td>
<td style="text-align: right;">0.39</td>
</tr>
<tr class="even">
<td style="text-align: left;">dexterity_attempts</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">-0.27</td>
<td style="text-align: right;">0.27</td>
</tr>
<tr class="odd">
<td style="text-align: left;">max_force</td>
<td style="text-align: right;">-17.38</td>
<td style="text-align: right;">-33.26</td>
<td style="text-align: right;">-1.37</td>
</tr>
<tr class="even">
<td style="text-align: left;">max_force_bodymass_normalised</td>
<td style="text-align: right;">-0.41</td>
<td style="text-align: right;">-0.68</td>
<td style="text-align: right;">-0.14</td>
</tr>
<tr class="odd">
<td style="text-align: left;">max_force_fds_thickness_normalised</td>
<td style="text-align: right;">-0.09</td>
<td style="text-align: right;">-0.18</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">max_force_forearm_circumference_normalised</td>
<td style="text-align: right;">-0.04</td>
<td style="text-align: right;">-0.09</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">specific_training_time</td>
<td style="text-align: right;">-1.37</td>
<td style="text-align: right;">-4.93</td>
<td style="text-align: right;">2.41</td>
</tr>
<tr class="even">
<td style="text-align: left;">general_resistance_training_time</td>
<td style="text-align: right;">-0.35</td>
<td style="text-align: right;">-1.55</td>
<td style="text-align: right;">0.67</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cov_force_15</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">cov_force_35</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cov_force_55</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">cov_force_70</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.01</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Median difference between groups for number of attempts at dexterity task:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>medians <span class="ot">&lt;-</span> demographic_anthropometric_force_data <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(testing_group <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"dexterity"</span>, <span class="st">"strength"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(testing_group) <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">median_attempts =</span> <span class="fu">median</span>(dexterity_attempts, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>median_diff <span class="ot">&lt;-</span> <span class="fu">diff</span>(medians<span class="sc">$</span>median_attempts)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"dexterity-trained median attempts ="</span>, medians<span class="sc">$</span>median_attempts[<span class="dv">1</span>],</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"</span><span class="sc">\n</span><span class="st">strength-trained median attempts ="</span>, medians<span class="sc">$</span>median_attempts[<span class="dv">2</span>],</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"</span><span class="sc">\n</span><span class="st">median difference = "</span>, median_diff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>dexterity-trained median attempts = 1 
strength-trained median attempts = 1 
median difference =  0</code></pre>
</div>
</div>
</section>
<section id="calculate-bootstrapped-effect-sizes-and-their-95-confidence-intervals" class="level4">
<h4 class="anchored" data-anchor-id="calculate-bootstrapped-effect-sizes-and-their-95-confidence-intervals">Calculate bootstrapped effect sizes and their 95% confidence intervals</h4>
<ul>
<li>Calculates bootstrapped between-group effect sizes as Cohen’s <span class="math inline">\(d\)</span>.</li>
<li>NOTE: this script may produce bootstrapped effect sizes and their 95% CI marginally different from those published. This is common with the bootstrapping approach, as bootstrapping involves random resampling. The changes will be incredibly minimal, given we have set a seed at the beginning of this script, and would not affect overall conclusions.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show function to calculate effect sizes</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FUNCTION: apply_bootES</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculates Cohen's d effect size using bootES package</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Inputs:</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># - dataframe: "demographic_anthropometric_force_data.csv". </span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># - column_name: columns for analysis</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co"># - number of bootstrap replicates: R = 10000 is used.</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Outputs:</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co"># - BootES results: Cohen's d effect size and 95% confidence intervals, along with other metrics.</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: returns NULL for non-numeric columns</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>apply_bootES <span class="ot">&lt;-</span> <span class="cf">function</span>(data, column_name, <span class="at">R =</span> <span class="dv">10000</span>) {</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.numeric</span>(data[[column_name]])) {</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Prepare data for bootES analysis</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>    combined_boot <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">select</span>(testing_group, <span class="fu">all_of</span>(column_name))</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Run bootES with 10000 replicates</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bootES</span>(combined_boot, </span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>           R, </span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>           <span class="at">data.col =</span> column_name, </span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>           <span class="at">group.col =</span> <span class="st">"testing_group"</span>,</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>           <span class="at">contrast =</span> <span class="fu">c</span>(<span class="st">"strength"</span>,<span class="st">"dexterity"</span>),</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>           <span class="at">effect.type =</span> <span class="st">"cohens.d"</span>)</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>columns_to_analyze <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(names</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                              (demographic_anthropometric_force_data), </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"testing_group"</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>                              )</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>effect_sizes_boot <span class="ot">&lt;-</span> <span class="fu">setNames</span>(</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lapply</span>(columns_to_analyze, \(x) </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>         <span class="fu">apply_bootES</span>(demographic_anthropometric_force_data, </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>                      x)),columns_to_analyze)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>effect_sizes_boot <span class="ot">&lt;-</span> <span class="fu">Filter</span>(<span class="fu">Negate</span>(is.null), </span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>                            effect_sizes_boot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><p>Effect sizes:</p>
<ul>
<li><p>Trivial when <span class="math inline">\(d &lt; 0.2\)</span>.</p></li>
<li><p>Small when <span class="math inline">\(d = 0.2 - 0.5\)</span>.</p></li>
<li><p>Moderate when <span class="math inline">\(d = 0.5 - 0.8\)</span>.</p></li>
<li><p>Large when <span class="math inline">\(d \ge 0.8\)</span>.</p></li>
</ul></li>
<li><p>Confidence Intervals:</p>
<ul>
<li><p>If CI is <em>positive and doesn’t cross 0</em>: dexterity-trained&gt;strength-trained.</p></li>
<li><p>If CI is <em>negative and doesn’t cross 0</em>: strength-trained&gt;dexterity-trained.</p></li>
<li><p>If CI <em>crosses 0</em>: no difference between groups.</p></li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show function to convert effect size results to dataframe</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FUNCTION: boot_results_to_df</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Converts bootES results to a df for easier viewing</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Inputs:</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co"># - boot_list: a list of results from several colimns using the apply_bootES function.</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Outputs:</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co"># - dataframe: containing Cohen's d effect size and 95% confidence intervals.</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>boot_results_to_df <span class="ot">&lt;-</span> <span class="cf">function</span>(boot_list) {</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Test_Variable =</span> <span class="fu">names</span>(boot_list),</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">Cohens_d =</span> <span class="fu">sapply</span>(boot_list, <span class="cf">function</span>(x) <span class="fu">round</span>(x<span class="sc">$</span>t0, <span class="dv">2</span>)),        <span class="co"># Round to 2 decimal places</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">Lower_CI =</span> <span class="fu">sapply</span>(boot_list, <span class="cf">function</span>(x) <span class="fu">round</span>(x<span class="sc">$</span>bounds[<span class="dv">1</span>], <span class="dv">2</span>)), <span class="co"># Round to 2 decimal places</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">Upper_CI =</span> <span class="fu">sapply</span>(boot_list, <span class="cf">function</span>(x) <span class="fu">round</span>(x<span class="sc">$</span>bounds[<span class="dv">2</span>], <span class="dv">2</span>))  <span class="co"># Round to 2 decimal places</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>effect_sizes_table <span class="ot">&lt;-</span> <span class="fu">boot_results_to_df</span>(effect_sizes_boot) <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Test_Variable <span class="sc">!=</span> <span class="st">"participant"</span>) <span class="co"># Remove participant ID effect sizes.</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(effect_sizes_table, <span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>,<span class="st">"condensed"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Test_Variable</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Cohens_d</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Lower_CI</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Upper_CI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">age</td>
<td style="text-align: right;">-0.15</td>
<td style="text-align: right;">-1.19</td>
<td style="text-align: right;">0.79</td>
</tr>
<tr class="even">
<td style="text-align: left;">height</td>
<td style="text-align: right;">1.32</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">2.24</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mass</td>
<td style="text-align: right;">0.85</td>
<td style="text-align: right;">-0.20</td>
<td style="text-align: right;">1.95</td>
</tr>
<tr class="even">
<td style="text-align: left;">forearm_circumference</td>
<td style="text-align: right;">-0.72</td>
<td style="text-align: right;">-2.06</td>
<td style="text-align: right;">0.43</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fds_thickness</td>
<td style="text-align: right;">-0.11</td>
<td style="text-align: right;">-1.05</td>
<td style="text-align: right;">0.86</td>
</tr>
<tr class="even">
<td style="text-align: left;">time_taken_to_complete_dexterity</td>
<td style="text-align: right;">-1.01</td>
<td style="text-align: right;">-1.82</td>
<td style="text-align: right;">-0.11</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dexterity_accuracy</td>
<td style="text-align: right;">-0.63</td>
<td style="text-align: right;">-2.05</td>
<td style="text-align: right;">0.20</td>
</tr>
<tr class="even">
<td style="text-align: left;">dexterity_attempts</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">-0.88</td>
<td style="text-align: right;">0.67</td>
</tr>
<tr class="odd">
<td style="text-align: left;">max_force</td>
<td style="text-align: right;">-0.93</td>
<td style="text-align: right;">-1.88</td>
<td style="text-align: right;">0.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">max_force_bodymass_normalised</td>
<td style="text-align: right;">-1.28</td>
<td style="text-align: right;">-2.27</td>
<td style="text-align: right;">-0.31</td>
</tr>
<tr class="odd">
<td style="text-align: left;">max_force_fds_thickness_normalised</td>
<td style="text-align: right;">-0.83</td>
<td style="text-align: right;">-1.68</td>
<td style="text-align: right;">0.16</td>
</tr>
<tr class="even">
<td style="text-align: left;">max_force_forearm_circumference_normalised</td>
<td style="text-align: right;">-0.77</td>
<td style="text-align: right;">-1.67</td>
<td style="text-align: right;">0.17</td>
</tr>
<tr class="odd">
<td style="text-align: left;">specific_training_time</td>
<td style="text-align: right;">-0.32</td>
<td style="text-align: right;">-1.28</td>
<td style="text-align: right;">0.68</td>
</tr>
<tr class="even">
<td style="text-align: left;">general_resistance_training_time</td>
<td style="text-align: right;">-0.27</td>
<td style="text-align: right;">-1.08</td>
<td style="text-align: right;">0.77</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cov_force_15</td>
<td style="text-align: right;">0.58</td>
<td style="text-align: right;">-0.44</td>
<td style="text-align: right;">1.30</td>
</tr>
<tr class="even">
<td style="text-align: left;">cov_force_35</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">-0.55</td>
<td style="text-align: right;">2.07</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cov_force_55</td>
<td style="text-align: right;">0.60</td>
<td style="text-align: right;">-0.37</td>
<td style="text-align: right;">1.76</td>
</tr>
<tr class="even">
<td style="text-align: left;">cov_force_70</td>
<td style="text-align: right;">0.72</td>
<td style="text-align: right;">-0.30</td>
<td style="text-align: right;">1.61</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="run-linear-regression-analyses" class="level4">
<h4 class="anchored" data-anchor-id="run-linear-regression-analyses">Run linear regression analyses</h4>
<p>Equation used for linear regression analyses were:</p>
<p><span class="math display">\[
COV \sim Force_{max}
\]</span></p>
<p>Units:</p>
<ul>
<li><p>COV: %</p></li>
<li><p>Force: N</p></li>
</ul>
<p>Note: check_model plots are in for models 15%, 35%, 55% and 70% MVC (in that order).</p>
<div class="cell">
<details class="code-fold">
<summary>Show functions to calculate linear regression analyses</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FUNCTION: prepare_force_data</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># This function prepares force data for plotting</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Inputs:</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co"># - data: "demographic_anthropometric_force_data.csv".</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Outputs:</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co"># - Long data: transformed data for linear regression analyses</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>prepare_force_data <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  force_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"15"</span>, <span class="st">"35"</span>, <span class="st">"55"</span>, <span class="st">"70"</span>)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create long format data</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  long_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(max_force, testing_group, <span class="fu">all_of</span>(<span class="fu">paste0</span>(<span class="st">"cov_force_"</span>, force_levels))) <span class="sc">%&gt;%</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"cov_force_"</span>),</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">names_to =</span> <span class="st">"force_level"</span>,</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">values_to =</span> <span class="st">"cov_force"</span>,</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">names_prefix =</span> <span class="st">"cov_force_"</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">force_level_label =</span> <span class="fu">paste0</span>(force_level, <span class="st">"% MVC"</span>),</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">cov_force_pct =</span> cov_force <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(long_data)</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a><span class="co"># FUNCTION: calculate_lm_force_COV</span></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculates linear model statistics and creates performance plots</span></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Inputs:</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a><span class="co"># - long_data (from previous function)</span></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Outputs:</span></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a><span class="co"># - Table of statistics from the lm of max force and COV</span></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a><span class="co"># - Performance plots for each model</span></span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>calculate_lm_force_COV <span class="ot">&lt;-</span> <span class="cf">function</span>(long_data) {</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>  stats_data <span class="ot">&lt;-</span> long_data <span class="sc">%&gt;%</span></span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(force_level, force_level_label) <span class="sc">%&gt;%</span></span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">do</span>({</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>      model <span class="ot">&lt;-</span> <span class="fu">lm</span>(cov_force_pct <span class="sc">~</span> max_force, <span class="at">data =</span> .)</span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>      model_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(model)</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>      <span class="co"># # Create performance plot with title</span></span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>      plot_title <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">unique</span>(.<span class="sc">$</span>force_level_label))</span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>      check1 <span class="ot">&lt;-</span> <span class="fu">plot</span>(<span class="fu">check_heteroscedasticity</span>(model))</span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>      check2 <span class="ot">&lt;-</span> <span class="fu">plot</span>(<span class="fu">check_normality</span>(model))</span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>      check3 <span class="ot">&lt;-</span> <span class="fu">plot</span>(<span class="fu">check_predictions</span>(model))</span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>      plot_obj <span class="ot">&lt;-</span> check1 <span class="sc">+</span> check2 <span class="sc">+</span> check3 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">guides =</span> <span class="st">"collect"</span>) <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">title =</span> plot_title) <span class="sc">&amp;</span></span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(plot_obj)</span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Extract coefficients</span></span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a>      intercept <span class="ot">&lt;-</span> model_summary<span class="sc">$</span>coefficients[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a>      slope <span class="ot">&lt;-</span> model_summary<span class="sc">$</span>coefficients[<span class="dv">2</span>, <span class="dv">1</span>]</span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Get confidence intervals for slope</span></span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a>      ci <span class="ot">&lt;-</span> <span class="fu">confint</span>(model, <span class="at">level =</span> <span class="fl">0.95</span>)</span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a>      slope_ci_lower <span class="ot">&lt;-</span> <span class="fu">round</span>(ci[<span class="dv">2</span>, <span class="dv">1</span>], <span class="dv">2</span>)</span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a>      slope_ci_upper <span class="ot">&lt;-</span> <span class="fu">round</span>(ci[<span class="dv">2</span>, <span class="dv">2</span>], <span class="dv">2</span>)</span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb17-65"><a href="#cb17-65" aria-hidden="true" tabindex="-1"></a>      <span class="fu">data.frame</span>(</span>
<span id="cb17-66"><a href="#cb17-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">r_squared =</span> <span class="fu">round</span>(model_summary<span class="sc">$</span>r.squared,<span class="dv">2</span>),</span>
<span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a>        <span class="at">adj_r_squared =</span> <span class="fu">round</span>(model_summary<span class="sc">$</span>adj.r.squared,<span class="dv">2</span>),</span>
<span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">intercept =</span> <span class="fu">round</span>(intercept,<span class="dv">2</span>),</span>
<span id="cb17-69"><a href="#cb17-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">slope =</span> <span class="fu">round</span>(slope,<span class="dv">2</span>),</span>
<span id="cb17-70"><a href="#cb17-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">slope_ci_lower =</span> slope_ci_lower,</span>
<span id="cb17-71"><a href="#cb17-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">slope_ci_upper =</span> slope_ci_upper</span>
<span id="cb17-72"><a href="#cb17-72" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb17-73"><a href="#cb17-73" aria-hidden="true" tabindex="-1"></a>    }) <span class="sc">%&gt;%</span></span>
<span id="cb17-74"><a href="#cb17-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb17-75"><a href="#cb17-75" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb17-76"><a href="#cb17-76" aria-hidden="true" tabindex="-1"></a>      <span class="at">r2_text =</span> <span class="fu">paste0</span>(<span class="st">"Adj. R² = "</span>, <span class="fu">gsub</span>(<span class="st">"-"</span>, <span class="st">"−"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, adj_r_squared))),</span>
<span id="cb17-77"><a href="#cb17-77" aria-hidden="true" tabindex="-1"></a>      <span class="at">formula_text =</span> <span class="fu">paste0</span>(</span>
<span id="cb17-78"><a href="#cb17-78" aria-hidden="true" tabindex="-1"></a>        <span class="st">"y = "</span>, </span>
<span id="cb17-79"><a href="#cb17-79" aria-hidden="true" tabindex="-1"></a>        <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, intercept), </span>
<span id="cb17-80"><a href="#cb17-80" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ifelse</span>(slope <span class="sc">&gt;=</span> <span class="dv">0</span>, <span class="st">" + "</span>, <span class="st">" − "</span>), </span>
<span id="cb17-81"><a href="#cb17-81" aria-hidden="true" tabindex="-1"></a>        <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, <span class="fu">abs</span>(slope)), <span class="st">"x"</span></span>
<span id="cb17-82"><a href="#cb17-82" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb17-83"><a href="#cb17-83" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-84"><a href="#cb17-84" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-85"><a href="#cb17-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(stats_data)</span>
<span id="cb17-86"><a href="#cb17-86" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the data</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>long_data <span class="ot">&lt;-</span> <span class="fu">prepare_force_data</span>(demographic_anthropometric_force_data)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate statistics with confidence intervals</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>stats_data <span class="ot">&lt;-</span> <span class="fu">calculate_lm_force_COV</span>(long_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="statistical_analysis_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="652"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="statistical_analysis_files/figure-html/unnamed-chunk-17-2.png" class="img-fluid figure-img" width="652"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="statistical_analysis_files/figure-html/unnamed-chunk-17-3.png" class="img-fluid figure-img" width="652"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="statistical_analysis_files/figure-html/unnamed-chunk-17-4.png" class="img-fluid figure-img" width="652"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the statistics data</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>stats_table_data <span class="ot">&lt;-</span> stats_data <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(force_level, r2_text, formula_text))</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(stats_table_data, <span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>,<span class="st">"condensed"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">force_level_label</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">r_squared</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">adj_r_squared</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">intercept</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">slope</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">slope_ci_lower</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">slope_ci_upper</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">15% MVC</td>
<td style="text-align: right;">0.45</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">7.39</td>
<td style="text-align: right;">-0.03</td>
<td style="text-align: right;">-0.05</td>
<td style="text-align: right;">-0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">35% MVC</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">3.64</td>
<td style="text-align: right;">-0.01</td>
<td style="text-align: right;">-0.02</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">55% MVC</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">3.85</td>
<td style="text-align: right;">-0.01</td>
<td style="text-align: right;">-0.03</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">70% MVC</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">-0.01</td>
<td style="text-align: right;">3.56</td>
<td style="text-align: right;">-0.01</td>
<td style="text-align: right;">-0.02</td>
<td style="text-align: right;">0.01</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="plotting" class="level3">
<h3 class="anchored" data-anchor-id="plotting">Plotting</h3>
<ul>
<li><p>Notes:</p>
<ul>
<li><p>Female data points were tagged after their creation using an “F” in Inkscape.</p></li>
<li><p>Some styling and organisation of plots were done in InkScape after their creation. All data elements were kept identical to their output, only aesthetic changes were made.</p></li>
</ul></li>
</ul>
<section id="maximum-force-output-plot" class="level4">
<h4 class="anchored" data-anchor-id="maximum-force-output-plot">Maximum force output plot</h4>
<div class="cell">
<details class="code-fold">
<summary>Show function to create maxmium and nornalised force plots</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FUNCTION: create_force_plot</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Creates raincloud plots for maximum force metrics.</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Inputs:</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co"># - data: "demographic_anthropometric_force_data.csv".</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co"># - ci_data: output from the function "calculate_group_boot_confint" in "calculate_bootstrap_confidence_intervals.R".</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co"># - force_var: column name of the force variable used (i.e. "max_force" or "max_force_forearm_circumference_normalised").</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="co"># - y_label: Label of the y-axis (such as "Force Output (N)")</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="co"># - strip label: 90 degree rotated plot title in grey shaded box (such as "Gross Force").</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Outputs:</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="co"># - Force variable raincloud plots.</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>create_force_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(data, ci_data, force_var, y_label, strip_label) {</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Controls spacing of the rain/jitter plot elements</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>  rain_height <span class="ot">&lt;-</span> <span class="fl">0.07</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add a dummy faceting variable to the data</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>  data<span class="sc">$</span>facet_var <span class="ot">&lt;-</span> strip_label</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter confidence interval data and add faceting variable</span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>  ci_data_filtered <span class="ot">&lt;-</span> ci_data[ci_data<span class="sc">$</span>Testing_Variable <span class="sc">==</span> force_var, ]</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>  ci_data_filtered<span class="sc">$</span>facet_var <span class="ot">&lt;-</span> strip_label</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ensure consistent ordering of groups in visualization</span></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 'strength' appears before 'dexterity' in the plot</span></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>  data<span class="sc">$</span>testing_group <span class="ot">&lt;-</span> <span class="fu">factor</span>(data<span class="sc">$</span>testing_group, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"strength"</span>, <span class="st">"dexterity"</span>))</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Begin building the plot with multiple layers.</span></span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Layer 1: Violin plots ("clouds").</span></span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Shows distribution kernel density of the data (uses the introdataviz package).</span></span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>    introdataviz<span class="sc">::</span><span class="fu">geom_flat_violin</span>(</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> data, </span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> .data[[force_var]], <span class="at">fill =</span> testing_group), </span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">trim =</span> <span class="cn">FALSE</span>,  <span class="co"># Don't trim the tails of the distribution</span></span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">alpha =</span> <span class="fl">0.9</span>,   <span class="co"># Slight transparency</span></span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">show.legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> rain_height <span class="sc">+</span> <span class="fl">0.07</span>)  <span class="co"># Shift position slightly</span></span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Layer 2: Individual participant data points ("rain")</span></span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Jittered points showing participant raw data</span></span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(</span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> data, </span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> .data[[force_var]], <span class="at">colour =</span> testing_group, <span class="at">shape =</span> testing_group), </span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="fl">2.2</span>,</span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">stroke =</span> <span class="fl">0.5</span>,</span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true" tabindex="-1"></a>      <span class="at">show.legend =</span> <span class="cn">FALSE</span>,  <span class="co"># Hide from legend since shown in violin plot</span></span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> rain_height <span class="sc">-</span> <span class="fl">0.055</span>)  <span class="co"># Add random noise</span></span>
<span id="cb20-53"><a href="#cb20-53" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb20-54"><a href="#cb20-54" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-55"><a href="#cb20-55" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Layer 3: Box plots</span></span>
<span id="cb20-56"><a href="#cb20-56" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Show quartiles and median</span></span>
<span id="cb20-57"><a href="#cb20-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(</span>
<span id="cb20-58"><a href="#cb20-58" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> data, </span>
<span id="cb20-59"><a href="#cb20-59" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> .data[[force_var]], <span class="at">fill =</span> testing_group), </span>
<span id="cb20-60"><a href="#cb20-60" aria-hidden="true" tabindex="-1"></a>      <span class="at">width =</span> <span class="fl">0.07</span>, </span>
<span id="cb20-61"><a href="#cb20-61" aria-hidden="true" tabindex="-1"></a>      <span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="co"># Hide from legend since shown in violin plot</span></span>
<span id="cb20-62"><a href="#cb20-62" aria-hidden="true" tabindex="-1"></a>      <span class="at">outlier.shape =</span> <span class="cn">NA</span>,  <span class="co"># Hide outliers since shown in rain plot</span></span>
<span id="cb20-63"><a href="#cb20-63" aria-hidden="true" tabindex="-1"></a>      <span class="at">position =</span> <span class="fu">position_dodgenudge</span>(<span class="at">width =</span> <span class="fl">0.075</span>, <span class="at">x =</span> <span class="sc">-</span>rain_height <span class="sc">*</span> <span class="fl">1.8</span>) <span class="co"># Change position to be below "rain".</span></span>
<span id="cb20-64"><a href="#cb20-64" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb20-65"><a href="#cb20-65" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-66"><a href="#cb20-66" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Layer 4: Confidence intervals</span></span>
<span id="cb20-67"><a href="#cb20-67" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Show mean and CI from bootstrap analysis positioned inside the "clouds"</span></span>
<span id="cb20-68"><a href="#cb20-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_pointrange</span>(</span>
<span id="cb20-69"><a href="#cb20-69" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> ci_data_filtered, </span>
<span id="cb20-70"><a href="#cb20-70" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> Mean, <span class="at">ymin =</span> Lower_CI, <span class="at">ymax =</span> Upper_CI, </span>
<span id="cb20-71"><a href="#cb20-71" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> testing_group, <span class="at">shape =</span> testing_group, <span class="at">fill =</span> testing_group), </span>
<span id="cb20-72"><a href="#cb20-72" aria-hidden="true" tabindex="-1"></a>      <span class="at">linewidth =</span> <span class="dv">1</span>, </span>
<span id="cb20-73"><a href="#cb20-73" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="fl">0.6</span>, </span>
<span id="cb20-74"><a href="#cb20-74" aria-hidden="true" tabindex="-1"></a>      <span class="at">show.legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb20-75"><a href="#cb20-75" aria-hidden="true" tabindex="-1"></a>      <span class="at">position =</span> <span class="fu">position_dodgenudge</span>(<span class="at">x =</span> rain_height <span class="sc">+</span> <span class="fl">0.14</span>, </span>
<span id="cb20-76"><a href="#cb20-76" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">width =</span> <span class="fl">0.05</span>) <span class="co"># Position inside the "clouds".</span></span>
<span id="cb20-77"><a href="#cb20-77" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb20-78"><a href="#cb20-78" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-79"><a href="#cb20-79" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add faceting with placeholder variable</span></span>
<span id="cb20-80"><a href="#cb20-80" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(facet_var), <span class="at">switch =</span> <span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb20-81"><a href="#cb20-81" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-82"><a href="#cb20-82" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Configure scales and coordinate system</span></span>
<span id="cb20-83"><a href="#cb20-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">name =</span> <span class="st">""</span>, <span class="at">expand =</span> <span class="fu">c</span>(rain_height <span class="sc">*</span> <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.7</span>)) <span class="sc">+</span></span>
<span id="cb20-84"><a href="#cb20-84" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>() <span class="sc">+</span></span>
<span id="cb20-85"><a href="#cb20-85" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span>  <span class="co"># Flip coordinates for horizontal layout</span></span>
<span id="cb20-86"><a href="#cb20-86" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb20-87"><a href="#cb20-87" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Apply theme and styling which will be consistent across plots</span></span>
<span id="cb20-88"><a href="#cb20-88" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb20-89"><a href="#cb20-89" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb20-90"><a href="#cb20-90" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb20-91"><a href="#cb20-91" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb20-92"><a href="#cb20-92" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb20-93"><a href="#cb20-93" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.line.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb20-94"><a href="#cb20-94" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey70"</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>),</span>
<span id="cb20-95"><a href="#cb20-95" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb20-96"><a href="#cb20-96" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey70"</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>),</span>
<span id="cb20-97"><a href="#cb20-97" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb20-98"><a href="#cb20-98" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb20-99"><a href="#cb20-99" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb20-100"><a href="#cb20-100" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb20-101"><a href="#cb20-101" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"grey90"</span>, <span class="at">color =</span> <span class="cn">NA</span>),  <span class="co"># Remove the box around facet labels</span></span>
<span id="cb20-102"><a href="#cb20-102" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb20-103"><a href="#cb20-103" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(</span>
<span id="cb20-104"><a href="#cb20-104" aria-hidden="true" tabindex="-1"></a>        <span class="at">angle =</span> <span class="dv">90</span>,</span>
<span id="cb20-105"><a href="#cb20-105" aria-hidden="true" tabindex="-1"></a>        <span class="at">face =</span> <span class="st">"bold"</span>,</span>
<span id="cb20-106"><a href="#cb20-106" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">12</span></span>
<span id="cb20-107"><a href="#cb20-107" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb20-108"><a href="#cb20-108" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb20-109"><a href="#cb20-109" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-110"><a href="#cb20-110" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add labels and titles</span></span>
<span id="cb20-111"><a href="#cb20-111" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb20-112"><a href="#cb20-112" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> y_label,</span>
<span id="cb20-113"><a href="#cb20-113" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> <span class="st">"Testing Group"</span></span>
<span id="cb20-114"><a href="#cb20-114" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb20-115"><a href="#cb20-115" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-116"><a href="#cb20-116" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define consistent visual encoding for testing groups</span></span>
<span id="cb20-117"><a href="#cb20-117" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"strength"</span> <span class="ot">=</span> <span class="dv">21</span>, <span class="st">"dexterity"</span> <span class="ot">=</span> <span class="dv">24</span>),</span>
<span id="cb20-118"><a href="#cb20-118" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"strength"</span> <span class="ot">=</span> <span class="st">"Strength-Trained"</span>, <span class="st">"dexterity"</span> <span class="ot">=</span> <span class="st">"Dexterity-Trained"</span>)) <span class="sc">+</span></span>
<span id="cb20-119"><a href="#cb20-119" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"strength"</span> <span class="ot">=</span> <span class="st">"#fe9d5d"</span>, <span class="st">"dexterity"</span> <span class="ot">=</span> <span class="st">"#365373"</span>),</span>
<span id="cb20-120"><a href="#cb20-120" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"strength"</span> <span class="ot">=</span> <span class="st">"Strength-Trained"</span>, <span class="st">"dexterity"</span> <span class="ot">=</span> <span class="st">"Dexterity-Trained"</span>)) <span class="sc">+</span></span>
<span id="cb20-121"><a href="#cb20-121" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"strength"</span> <span class="ot">=</span> <span class="st">"#fe9d5d"</span>, <span class="st">"dexterity"</span> <span class="ot">=</span> <span class="st">"#456990"</span>),</span>
<span id="cb20-122"><a href="#cb20-122" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"strength"</span> <span class="ot">=</span> <span class="st">"Strength-Trained"</span>, <span class="st">"dexterity"</span> <span class="ot">=</span> <span class="st">"Dexterity-Trained"</span>))</span>
<span id="cb20-123"><a href="#cb20-123" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>gross_force_plot <span class="ot">&lt;-</span> <span class="fu">create_force_plot</span>(</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>   demographic_anthropometric_force_data,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>   group_means_and_ci_boot,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>   <span class="st">"max_force"</span>,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>   <span class="st">"Force (N)"</span>,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>   <span class="st">"Gross Force"</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="forearm-circumference-normalised-force-output-plot" class="level4">
<h4 class="anchored" data-anchor-id="forearm-circumference-normalised-force-output-plot">Forearm-circumference normalised force output plot</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>norm_force_plot <span class="ot">&lt;-</span> <span class="fu">create_force_plot</span>(</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  demographic_anthropometric_force_data,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  group_means_and_ci_boot,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"max_force_forearm_circumference_normalised"</span>,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Force/unit forearm circumference (N/cm)"</span>,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Normalized Force"</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="create-coefficient-of-variation-of-steady-force-plot" class="level4">
<h4 class="anchored" data-anchor-id="create-coefficient-of-variation-of-steady-force-plot">Create coefficient of variation of steady force plot</h4>
<div class="cell">
<details class="code-fold">
<summary>Show function to create coefficient of variation of steady force plot</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FUNCTION: create_cov_force_plot</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Creates faceted plot that shows 95% CI and raw data points for foce steadiness (coefficient of varation of force)</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># during the submaximal force trials</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Inputs:</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co"># - data: "demographic_anthropometric_force_data.csv".</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="co"># - ci_data: output from the function "calculate_group_boot_confint" in "calculate_bootstrap_confidence_intervals.R".</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Outputs:</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="co"># - Force steadiness plot (coefficient of variation of force).</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>create_cov_force_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(data, ci_data) {</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Prepare coefficient of variation (COV) of force data for plotting</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select relevant columns</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  plot_cov <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(participant, testing_group, cov_force_15, cov_force_35, cov_force_55, cov_force_70)</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert wide format to long format for plotting</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>  plot_cov_force_long <span class="ot">&lt;-</span> plot_cov <span class="sc">%&gt;%</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(testing_group, participant), </span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>                 <span class="at">names_to =</span> <span class="st">"Variable"</span>, </span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>                 <span class="at">values_to =</span> <span class="st">"Value"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Recode variable names and set factor levels for proper ordering</span></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Convert numeric suffixes to percentage labels</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">Variable =</span> <span class="fu">factor</span>(<span class="fu">recode</span>(Variable,</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"cov_force_15"</span> <span class="ot">=</span> <span class="st">"15%"</span>,</span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"cov_force_35"</span> <span class="ot">=</span> <span class="st">"35%"</span>,</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"cov_force_55"</span> <span class="ot">=</span> <span class="st">"55%"</span>,</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"cov_force_70"</span> <span class="ot">=</span> <span class="st">"70%"</span>),</span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>                        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"70%"</span>, <span class="st">"55%"</span>, <span class="st">"35%"</span>, <span class="st">"15%"</span>)),  <span class="co"># Order from high to low</span></span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">testing_group =</span> <span class="fu">factor</span>(testing_group, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"strength"</span>, <span class="st">"dexterity"</span>))</span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Similarly prepare confidence interval data</span></span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>  plot_cov_force_CI <span class="ot">&lt;-</span> ci_data <span class="sc">%&gt;%</span> </span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Testing_Variable <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"cov_force_15"</span>, <span class="st">"cov_force_35"</span>, <span class="st">"cov_force_55"</span>, <span class="st">"cov_force_70"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">Variable =</span> <span class="fu">factor</span>(<span class="fu">recode</span>(Testing_Variable,</span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"cov_force_15"</span> <span class="ot">=</span> <span class="st">"15%"</span>,</span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"cov_force_35"</span> <span class="ot">=</span> <span class="st">"35%"</span>,</span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"cov_force_55"</span> <span class="ot">=</span> <span class="st">"55%"</span>,</span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"cov_force_70"</span> <span class="ot">=</span> <span class="st">"70%"</span>),</span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a>                        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"70%"</span>, <span class="st">"55%"</span>, <span class="st">"35%"</span>, <span class="st">"15%"</span>)),</span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">testing_group =</span> <span class="fu">factor</span>(testing_group, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"strength"</span>, <span class="st">"dexterity"</span>))</span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb23-48"><a href="#cb23-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-49"><a href="#cb23-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create multi-panel plot</span></span>
<span id="cb23-50"><a href="#cb23-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb23-51"><a href="#cb23-51" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Layer 1: Individual participant data points with jitter.</span></span>
<span id="cb23-52"><a href="#cb23-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">data =</span> plot_cov_force_long, </span>
<span id="cb23-53"><a href="#cb23-53" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">y =</span> testing_group, <span class="at">color =</span> testing_group, <span class="at">shape =</span> testing_group), </span>
<span id="cb23-54"><a href="#cb23-54" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="fl">2.5</span>, </span>
<span id="cb23-55"><a href="#cb23-55" aria-hidden="true" tabindex="-1"></a>                <span class="at">stroke =</span> <span class="fl">0.5</span>, </span>
<span id="cb23-56"><a href="#cb23-56" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_jitterdodge</span>(<span class="at">jitter.width =</span> <span class="fl">0.05</span>, <span class="at">dodge.width =</span> <span class="fl">0.5</span>),</span>
<span id="cb23-57"><a href="#cb23-57" aria-hidden="true" tabindex="-1"></a>                <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb23-58"><a href="#cb23-58" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-59"><a href="#cb23-59" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Layer 2: Bootstrapped mean and 95% confidence intervals</span></span>
<span id="cb23-60"><a href="#cb23-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_pointrange</span>(<span class="at">data =</span> plot_cov_force_CI, </span>
<span id="cb23-61"><a href="#cb23-61" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">aes</span>(<span class="at">x =</span> Mean, <span class="at">y =</span> testing_group, </span>
<span id="cb23-62"><a href="#cb23-62" aria-hidden="true" tabindex="-1"></a>                        <span class="at">xmin =</span> Lower_CI, <span class="at">xmax =</span> Upper_CI, </span>
<span id="cb23-63"><a href="#cb23-63" aria-hidden="true" tabindex="-1"></a>                        <span class="at">color =</span> testing_group, <span class="at">shape =</span> testing_group, </span>
<span id="cb23-64"><a href="#cb23-64" aria-hidden="true" tabindex="-1"></a>                        <span class="at">fill =</span> testing_group),</span>
<span id="cb23-65"><a href="#cb23-65" aria-hidden="true" tabindex="-1"></a>                    <span class="at">size =</span> <span class="dv">1</span>, </span>
<span id="cb23-66"><a href="#cb23-66" aria-hidden="true" tabindex="-1"></a>                    <span class="at">linewidth =</span> <span class="fl">1.7</span>, </span>
<span id="cb23-67"><a href="#cb23-67" aria-hidden="true" tabindex="-1"></a>                    <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb23-68"><a href="#cb23-68" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-69"><a href="#cb23-69" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create separate panels for each force level</span></span>
<span id="cb23-70"><a href="#cb23-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(Variable), <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">switch =</span> <span class="st">"y"</span>) <span class="sc">+</span> </span>
<span id="cb23-71"><a href="#cb23-71" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-72"><a href="#cb23-72" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Apply theme and styling which will be consistent across plots</span></span>
<span id="cb23-73"><a href="#cb23-73" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb23-74"><a href="#cb23-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb23-75"><a href="#cb23-75" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb23-76"><a href="#cb23-76" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb23-77"><a href="#cb23-77" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"grey70"</span>),</span>
<span id="cb23-78"><a href="#cb23-78" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb23-79"><a href="#cb23-79" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb23-80"><a href="#cb23-80" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb23-81"><a href="#cb23-81" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb23-82"><a href="#cb23-82" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb23-83"><a href="#cb23-83" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb23-84"><a href="#cb23-84" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb23-85"><a href="#cb23-85" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.line.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb23-86"><a href="#cb23-86" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">size =</span> <span class="dv">11</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb23-87"><a href="#cb23-87" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb23-88"><a href="#cb23-88" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb23-89"><a href="#cb23-89" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.3</span>, <span class="at">colour =</span> <span class="st">"grey80"</span>),</span>
<span id="cb23-90"><a href="#cb23-90" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"grey90"</span>, <span class="at">color =</span> <span class="cn">NA</span>)</span>
<span id="cb23-91"><a href="#cb23-91" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb23-92"><a href="#cb23-92" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-93"><a href="#cb23-93" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add labels and configure scales</span></span>
<span id="cb23-94"><a href="#cb23-94" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"COV"</span>,</span>
<span id="cb23-95"><a href="#cb23-95" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Percentage of MVC"</span>,</span>
<span id="cb23-96"><a href="#cb23-96" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> <span class="st">"Testing Group"</span>,</span>
<span id="cb23-97"><a href="#cb23-97" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">"Testing Group"</span>, </span>
<span id="cb23-98"><a href="#cb23-98" aria-hidden="true" tabindex="-1"></a>         <span class="at">shape =</span> <span class="st">"Testing Group"</span>) <span class="sc">+</span></span>
<span id="cb23-99"><a href="#cb23-99" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent) <span class="sc">+</span>  <span class="co"># Format x-axis as force level percentages</span></span>
<span id="cb23-100"><a href="#cb23-100" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-101"><a href="#cb23-101" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Apply consistent visual encoding for testing groups</span></span>
<span id="cb23-102"><a href="#cb23-102" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"strength"</span> <span class="ot">=</span> <span class="dv">21</span>, <span class="st">"dexterity"</span> <span class="ot">=</span> <span class="dv">24</span>),</span>
<span id="cb23-103"><a href="#cb23-103" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"strength"</span> <span class="ot">=</span> <span class="st">"Strength-Trained"</span>, <span class="st">"dexterity"</span> <span class="ot">=</span> <span class="st">"Dexterity-Trained"</span>)) <span class="sc">+</span></span>
<span id="cb23-104"><a href="#cb23-104" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"strength"</span> <span class="ot">=</span> <span class="st">"#fe9d5d"</span>, <span class="st">"dexterity"</span> <span class="ot">=</span> <span class="st">"#456990"</span>),</span>
<span id="cb23-105"><a href="#cb23-105" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"strength"</span> <span class="ot">=</span> <span class="st">"Strength-Trained"</span>, <span class="st">"dexterity"</span> <span class="ot">=</span> <span class="st">"Dexterity-Trained"</span>)) <span class="sc">+</span></span>
<span id="cb23-106"><a href="#cb23-106" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"strength"</span> <span class="ot">=</span> <span class="st">"#fe9d5d"</span>, <span class="st">"dexterity"</span> <span class="ot">=</span> <span class="st">"#456990"</span>),</span>
<span id="cb23-107"><a href="#cb23-107" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"strength"</span> <span class="ot">=</span> <span class="st">"Strength-Trained"</span>, <span class="st">"dexterity"</span> <span class="ot">=</span> <span class="st">"Dexterity-Trained"</span>))</span>
<span id="cb23-108"><a href="#cb23-108" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>cov_plot <span class="ot">&lt;-</span> <span class="fu">create_cov_force_plot</span>(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  demographic_anthropometric_force_data, </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  group_means_and_ci_boot</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="linear-regression-plots" class="level4">
<h4 class="anchored" data-anchor-id="linear-regression-plots">Linear regression plots</h4>
<div class="cell">
<details class="code-fold">
<summary>Show functions to calculate linear regression analyses</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FUNCTION: create_lm_plots</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculates </span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Inputs:</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="co"># - long_data (from linear regression function above)</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co"># - stats_data (from linear regression function above)</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Outputs:</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="co"># - Plot of lm for each force level.</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>create_lm_plots <span class="ot">&lt;-</span> <span class="cf">function</span>(long_data, stats_data) {</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(long_data, <span class="fu">aes</span>(<span class="at">x =</span> max_force, <span class="at">y =</span> cov_force_pct, <span class="at">color =</span> testing_group, <span class="at">shape =</span> testing_group)) <span class="sc">+</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Regression line</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span>, </span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">fill =</span> <span class="st">"grey90"</span>, <span class="at">alpha =</span> <span class="dv">1</span>, </span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="fu">aes</span>(<span class="at">x =</span> max_force, <span class="at">y =</span> cov_force_pct)) <span class="sc">+</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Participant data points</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">stroke =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># R² text</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">data =</span> stats_data,</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> <span class="cn">Inf</span>, <span class="at">y =</span> <span class="cn">Inf</span>, <span class="at">label =</span> r2_text),</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>              <span class="at">hjust =</span> <span class="fl">1.1</span>, <span class="at">vjust =</span> <span class="fl">3.7</span>,</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">3.2</span>, <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>              <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Slope text</span></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">data =</span> stats_data,</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> <span class="cn">Inf</span>, <span class="at">y =</span> <span class="cn">Inf</span>, <span class="at">label =</span> formula_text),</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>              <span class="at">hjust =</span> <span class="fl">1.1</span>, <span class="at">vjust =</span> <span class="fl">1.7</span>,</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">3.2</span>, <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>              <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(. <span class="sc">~</span> force_level_label, <span class="at">scales =</span> <span class="st">"free_x"</span>) <span class="sc">+</span></span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Max Force (N)"</span>, <span class="at">y =</span> <span class="st">"COV Force (%)"</span>) <span class="sc">+</span></span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">pretty_breaks</span>(<span class="at">n =</span> <span class="dv">3</span>), </span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">paste0</span>(x, <span class="st">"%"</span>)) <span class="sc">+</span></span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"strength"</span> <span class="ot">=</span> <span class="dv">21</span>, <span class="st">"dexterity"</span> <span class="ot">=</span> <span class="dv">24</span>),</span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"strength"</span> <span class="ot">=</span> <span class="st">"Strength-Trained"</span>, </span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"dexterity"</span> <span class="ot">=</span> <span class="st">"Dexterity-Trained"</span>)) <span class="sc">+</span></span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="fu">max</span>(long_data<span class="sc">$</span>cov_force_pct, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="fl">1.05</span>)) <span class="sc">+</span></span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(</span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Testing Group"</span>,</span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"strength"</span> <span class="ot">=</span> <span class="st">"#fe9d5d"</span>, <span class="st">"dexterity"</span> <span class="ot">=</span> <span class="st">"#456990"</span>),</span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"strength"</span> <span class="ot">=</span> <span class="st">"Strength-Trained"</span>, <span class="st">"dexterity"</span> <span class="ot">=</span> <span class="st">"Dexterity-Trained"</span>)</span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"grey70"</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>),</span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="cn">NA</span>, <span class="at">fill =</span> <span class="st">"grey90"</span>),</span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb25-58"><a href="#cb25-58" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey70"</span>, <span class="at">linewidth =</span> <span class="fl">0.3</span>),</span>
<span id="cb25-59"><a href="#cb25-59" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"none"</span></span>
<span id="cb25-60"><a href="#cb25-60" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-61"><a href="#cb25-61" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-62"><a href="#cb25-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb25-63"><a href="#cb25-63" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>lm_plot <span class="ot">&lt;-</span> <span class="fu">create_lm_plots</span>(long_data, stats_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="combine-plots-into-final-paneled-plot" class="level4">
<h4 class="anchored" data-anchor-id="combine-plots-into-final-paneled-plot">Combine plots into final paneled plot</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> (gross_force_plot<span class="sc">|</span> norm_force_plot) <span class="sc">/</span> (cov_plot) <span class="sc">/</span> (lm_plot) <span class="sc">+</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">guides =</span> <span class="st">'collect'</span>, <span class="co"># Collect all legends</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">heights =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.6</span>, <span class="fl">0.2</span>) <span class="co"># Adjust height proportions</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">theme =</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)) <span class="sc">&amp;</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.tag.position =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">1.01</span>))</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>combined_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="statistical_analysis_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="652"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="motor-unit-data-analyses" class="level2">
<h2 class="anchored" data-anchor-id="motor-unit-data-analyses">Motor unit data analyses</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>mu_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"mu_data.csv"</span>, </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="at">testing_group =</span> <span class="fu">col_factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"dexterity"</span>, </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"strength"</span>)), <span class="at">force_level =</span> <span class="fu">col_factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"15"</span>, </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"35"</span>, <span class="st">"55"</span>, <span class="st">"70"</span>)), <span class="at">trial =</span> <span class="fu">col_factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"1"</span>, </span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">"2"</span>, <span class="st">"3"</span>)), <span class="at">muscle =</span> <span class="fu">col_factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"apb"</span>, </span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"fds"</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="motor-unit-table" class="level4">
<h4 class="anchored" data-anchor-id="motor-unit-table">Motor unit table</h4>
<div class="cell">
<details class="code-fold">
<summary>Show functions to create table of average MUs per participant</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FUNCTION: create_MU_summary_table</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculates </span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Inputs:</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co"># - mu_data</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Outputs:</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="co"># - Table of identified MUs across the three trials, per participant and for each force level.</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>create_MU_summary_table <span class="ot">&lt;-</span> <span class="cf">function</span>(mu_data) {</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create summary table</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>  summary_table <span class="ot">&lt;-</span> mu_data <span class="sc">%&gt;%</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(force_level, muscle, testing_group) <span class="sc">%&gt;%</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">n_participants =</span> <span class="fu">n_distinct</span>(participant),</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">avg_motor_units =</span> <span class="fu">n</span>() <span class="sc">/</span> <span class="fu">n_distinct</span>(participant),</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Reshape to have separate columns for each measure</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">names_from =</span> <span class="fu">c</span>(testing_group, muscle),</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">values_from =</span> <span class="fu">c</span>(n_participants, avg_motor_units),</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">names_sep =</span> <span class="st">"_"</span></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Reorder columns to group by testing_group first</span></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>  desired_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"force_level"</span>)</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(testing_group <span class="cf">in</span> <span class="fu">c</span>(<span class="st">"strength"</span>, <span class="st">"dexterity"</span>)) {</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(muscle <span class="cf">in</span> <span class="fu">c</span>(<span class="st">"apb"</span>, <span class="st">"fds"</span>)) {</span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>      desired_order <span class="ot">&lt;-</span> <span class="fu">c</span>(desired_order,</span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">paste0</span>(<span class="st">"n_participants_"</span>, testing_group, <span class="st">"_"</span>, muscle),</span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">paste0</span>(<span class="st">"avg_motor_units_"</span>, testing_group, <span class="st">"_"</span>, muscle))</span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>  summary_table <span class="ot">&lt;-</span> summary_table <span class="sc">%&gt;%</span></span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">all_of</span>(desired_order))</span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create GT table</span></span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a>  final_table <span class="ot">&lt;-</span> summary_table <span class="sc">%&gt;%</span></span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gt</span>()</span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># First add the lower level (muscle) spanners</span></span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(testing_group <span class="cf">in</span> <span class="fu">c</span>(<span class="st">"strength"</span>, <span class="st">"dexterity"</span>)) {</span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add APB spanner</span></span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a>    apb_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"n_participants_"</span>, testing_group, <span class="st">"_apb"</span>),</span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"avg_motor_units_"</span>, testing_group, <span class="st">"_apb"</span>)</span>
<span id="cb29-50"><a href="#cb29-50" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb29-51"><a href="#cb29-51" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-52"><a href="#cb29-52" aria-hidden="true" tabindex="-1"></a>    final_table <span class="ot">&lt;-</span> final_table <span class="sc">%&gt;%</span></span>
<span id="cb29-53"><a href="#cb29-53" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tab_spanner</span>(</span>
<span id="cb29-54"><a href="#cb29-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="st">"APB"</span>,</span>
<span id="cb29-55"><a href="#cb29-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">columns =</span> <span class="fu">all_of</span>(apb_cols),</span>
<span id="cb29-56"><a href="#cb29-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">id =</span> <span class="fu">paste0</span>(testing_group, <span class="st">"_apb"</span>)</span>
<span id="cb29-57"><a href="#cb29-57" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb29-58"><a href="#cb29-58" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-59"><a href="#cb29-59" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add FDS spanner</span></span>
<span id="cb29-60"><a href="#cb29-60" aria-hidden="true" tabindex="-1"></a>    fds_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb29-61"><a href="#cb29-61" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"n_participants_"</span>, testing_group, <span class="st">"_fds"</span>),</span>
<span id="cb29-62"><a href="#cb29-62" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"avg_motor_units_"</span>, testing_group, <span class="st">"_fds"</span>)</span>
<span id="cb29-63"><a href="#cb29-63" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb29-64"><a href="#cb29-64" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-65"><a href="#cb29-65" aria-hidden="true" tabindex="-1"></a>    final_table <span class="ot">&lt;-</span> final_table <span class="sc">%&gt;%</span></span>
<span id="cb29-66"><a href="#cb29-66" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tab_spanner</span>(</span>
<span id="cb29-67"><a href="#cb29-67" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="st">"FDS"</span>,</span>
<span id="cb29-68"><a href="#cb29-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">columns =</span> <span class="fu">all_of</span>(fds_cols),</span>
<span id="cb29-69"><a href="#cb29-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">id =</span> <span class="fu">paste0</span>(testing_group, <span class="st">"_fds"</span>)</span>
<span id="cb29-70"><a href="#cb29-70" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb29-71"><a href="#cb29-71" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb29-72"><a href="#cb29-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-73"><a href="#cb29-73" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Then add the top level (testing_group) spanners</span></span>
<span id="cb29-74"><a href="#cb29-74" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Strength-trained columns</span></span>
<span id="cb29-75"><a href="#cb29-75" aria-hidden="true" tabindex="-1"></a>  strength_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb29-76"><a href="#cb29-76" aria-hidden="true" tabindex="-1"></a>    <span class="st">"n_participants_strength_apb"</span>,</span>
<span id="cb29-77"><a href="#cb29-77" aria-hidden="true" tabindex="-1"></a>    <span class="st">"avg_motor_units_strength_apb"</span>,</span>
<span id="cb29-78"><a href="#cb29-78" aria-hidden="true" tabindex="-1"></a>    <span class="st">"n_participants_strength_fds"</span>,</span>
<span id="cb29-79"><a href="#cb29-79" aria-hidden="true" tabindex="-1"></a>    <span class="st">"avg_motor_units_strength_fds"</span></span>
<span id="cb29-80"><a href="#cb29-80" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-81"><a href="#cb29-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-82"><a href="#cb29-82" aria-hidden="true" tabindex="-1"></a>  final_table <span class="ot">&lt;-</span> final_table <span class="sc">%&gt;%</span></span>
<span id="cb29-83"><a href="#cb29-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_spanner</span>(</span>
<span id="cb29-84"><a href="#cb29-84" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="st">"Strength-trained"</span>,</span>
<span id="cb29-85"><a href="#cb29-85" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> <span class="fu">all_of</span>(strength_cols),</span>
<span id="cb29-86"><a href="#cb29-86" aria-hidden="true" tabindex="-1"></a>      <span class="at">id =</span> <span class="st">"strength"</span></span>
<span id="cb29-87"><a href="#cb29-87" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb29-88"><a href="#cb29-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-89"><a href="#cb29-89" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Dexterity-trained columns</span></span>
<span id="cb29-90"><a href="#cb29-90" aria-hidden="true" tabindex="-1"></a>  dexterity_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb29-91"><a href="#cb29-91" aria-hidden="true" tabindex="-1"></a>    <span class="st">"n_participants_dexterity_apb"</span>,</span>
<span id="cb29-92"><a href="#cb29-92" aria-hidden="true" tabindex="-1"></a>    <span class="st">"avg_motor_units_dexterity_apb"</span>,</span>
<span id="cb29-93"><a href="#cb29-93" aria-hidden="true" tabindex="-1"></a>    <span class="st">"n_participants_dexterity_fds"</span>,</span>
<span id="cb29-94"><a href="#cb29-94" aria-hidden="true" tabindex="-1"></a>    <span class="st">"avg_motor_units_dexterity_fds"</span></span>
<span id="cb29-95"><a href="#cb29-95" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-96"><a href="#cb29-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-97"><a href="#cb29-97" aria-hidden="true" tabindex="-1"></a>  final_table <span class="ot">&lt;-</span> final_table <span class="sc">%&gt;%</span></span>
<span id="cb29-98"><a href="#cb29-98" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_spanner</span>(</span>
<span id="cb29-99"><a href="#cb29-99" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="st">"Dexterity-trained"</span>,</span>
<span id="cb29-100"><a href="#cb29-100" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> <span class="fu">all_of</span>(dexterity_cols),</span>
<span id="cb29-101"><a href="#cb29-101" aria-hidden="true" tabindex="-1"></a>      <span class="at">id =</span> <span class="st">"dexterity"</span></span>
<span id="cb29-102"><a href="#cb29-102" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb29-103"><a href="#cb29-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-104"><a href="#cb29-104" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add column labels</span></span>
<span id="cb29-105"><a href="#cb29-105" aria-hidden="true" tabindex="-1"></a>  col_labels <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">force_level =</span> <span class="st">"Force Level"</span>)</span>
<span id="cb29-106"><a href="#cb29-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-107"><a href="#cb29-107" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define column labels systematically</span></span>
<span id="cb29-108"><a href="#cb29-108" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(testing_group <span class="cf">in</span> <span class="fu">c</span>(<span class="st">"strength"</span>, <span class="st">"dexterity"</span>)) {</span>
<span id="cb29-109"><a href="#cb29-109" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(muscle_name <span class="cf">in</span> <span class="fu">c</span>(<span class="st">"apb"</span>, <span class="st">"fds"</span>)) {</span>
<span id="cb29-110"><a href="#cb29-110" aria-hidden="true" tabindex="-1"></a>      col_labels[[<span class="fu">paste0</span>(<span class="st">"n_participants_"</span>, testing_group, <span class="st">"_"</span>, muscle_name)]] <span class="ot">&lt;-</span> <span class="st">"N"</span></span>
<span id="cb29-111"><a href="#cb29-111" aria-hidden="true" tabindex="-1"></a>      col_labels[[<span class="fu">paste0</span>(<span class="st">"avg_motor_units_"</span>, testing_group, <span class="st">"_"</span>, muscle_name)]] <span class="ot">&lt;-</span> <span class="st">"No. MUs"</span></span>
<span id="cb29-112"><a href="#cb29-112" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb29-113"><a href="#cb29-113" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb29-114"><a href="#cb29-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-115"><a href="#cb29-115" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply formatting</span></span>
<span id="cb29-116"><a href="#cb29-116" aria-hidden="true" tabindex="-1"></a>  final_table <span class="ot">&lt;-</span> final_table <span class="sc">%&gt;%</span></span>
<span id="cb29-117"><a href="#cb29-117" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_options</span>(</span>
<span id="cb29-118"><a href="#cb29-118" aria-hidden="true" tabindex="-1"></a>      <span class="at">column_labels.font.weight =</span> <span class="st">"bold"</span>,</span>
<span id="cb29-119"><a href="#cb29-119" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Table borders</span></span>
<span id="cb29-120"><a href="#cb29-120" aria-hidden="true" tabindex="-1"></a>      <span class="at">table.border.top.color =</span> <span class="st">"black"</span>,</span>
<span id="cb29-121"><a href="#cb29-121" aria-hidden="true" tabindex="-1"></a>      <span class="at">table.border.top.width =</span> <span class="fu">px</span>(<span class="fl">1.5</span>),</span>
<span id="cb29-122"><a href="#cb29-122" aria-hidden="true" tabindex="-1"></a>      <span class="at">table.border.bottom.color =</span> <span class="st">"black"</span>,</span>
<span id="cb29-123"><a href="#cb29-123" aria-hidden="true" tabindex="-1"></a>      <span class="at">table.border.bottom.width =</span> <span class="fu">px</span>(<span class="fl">1.5</span>),</span>
<span id="cb29-124"><a href="#cb29-124" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Column label borders</span></span>
<span id="cb29-125"><a href="#cb29-125" aria-hidden="true" tabindex="-1"></a>      <span class="at">column_labels.border.top.color =</span> <span class="st">"black"</span>,</span>
<span id="cb29-126"><a href="#cb29-126" aria-hidden="true" tabindex="-1"></a>      <span class="at">column_labels.border.top.width =</span> <span class="fu">px</span>(<span class="fl">1.5</span>),</span>
<span id="cb29-127"><a href="#cb29-127" aria-hidden="true" tabindex="-1"></a>      <span class="at">column_labels.border.bottom.color =</span> <span class="st">"black"</span>,</span>
<span id="cb29-128"><a href="#cb29-128" aria-hidden="true" tabindex="-1"></a>      <span class="at">column_labels.border.bottom.width =</span> <span class="fu">px</span>(<span class="fl">1.5</span>),</span>
<span id="cb29-129"><a href="#cb29-129" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Row group borders</span></span>
<span id="cb29-130"><a href="#cb29-130" aria-hidden="true" tabindex="-1"></a>      <span class="at">row_group.border.top.color =</span> <span class="st">"black"</span>,</span>
<span id="cb29-131"><a href="#cb29-131" aria-hidden="true" tabindex="-1"></a>      <span class="at">row_group.border.top.width =</span> <span class="fu">px</span>(<span class="fl">1.5</span>),</span>
<span id="cb29-132"><a href="#cb29-132" aria-hidden="true" tabindex="-1"></a>      <span class="at">row_group.border.bottom.color =</span> <span class="st">"black"</span>,</span>
<span id="cb29-133"><a href="#cb29-133" aria-hidden="true" tabindex="-1"></a>      <span class="at">row_group.border.bottom.width =</span> <span class="fu">px</span>(<span class="fl">1.5</span>),</span>
<span id="cb29-134"><a href="#cb29-134" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Body borders</span></span>
<span id="cb29-135"><a href="#cb29-135" aria-hidden="true" tabindex="-1"></a>      <span class="at">table_body.border.top.color =</span> <span class="st">"black"</span>,</span>
<span id="cb29-136"><a href="#cb29-136" aria-hidden="true" tabindex="-1"></a>      <span class="at">table_body.border.top.width =</span> <span class="fu">px</span>(<span class="fl">1.5</span>),</span>
<span id="cb29-137"><a href="#cb29-137" aria-hidden="true" tabindex="-1"></a>      <span class="at">table_body.border.bottom.color =</span> <span class="st">"black"</span>,</span>
<span id="cb29-138"><a href="#cb29-138" aria-hidden="true" tabindex="-1"></a>      <span class="at">table_body.border.bottom.width =</span> <span class="fu">px</span>(<span class="fl">1.5</span>),</span>
<span id="cb29-139"><a href="#cb29-139" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Spanner borders</span></span>
<span id="cb29-140"><a href="#cb29-140" aria-hidden="true" tabindex="-1"></a>      <span class="at">heading.border.bottom.color =</span> <span class="st">"black"</span>,</span>
<span id="cb29-141"><a href="#cb29-141" aria-hidden="true" tabindex="-1"></a>      <span class="at">heading.border.bottom.width =</span> <span class="fu">px</span>(<span class="fl">1.5</span>)</span>
<span id="cb29-142"><a href="#cb29-142" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb29-143"><a href="#cb29-143" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_style</span>(</span>
<span id="cb29-144"><a href="#cb29-144" aria-hidden="true" tabindex="-1"></a>      <span class="at">style =</span> <span class="fu">list</span>(</span>
<span id="cb29-145"><a href="#cb29-145" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cell_text</span>(<span class="at">weight =</span> <span class="st">"bold"</span>),</span>
<span id="cb29-146"><a href="#cb29-146" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cell_borders</span>(</span>
<span id="cb29-147"><a href="#cb29-147" aria-hidden="true" tabindex="-1"></a>          <span class="at">sides =</span> <span class="fu">c</span>(<span class="st">"top"</span>, <span class="st">"bottom"</span>),</span>
<span id="cb29-148"><a href="#cb29-148" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb29-149"><a href="#cb29-149" aria-hidden="true" tabindex="-1"></a>          <span class="at">weight =</span> <span class="fu">px</span>(<span class="fl">1.5</span>)</span>
<span id="cb29-150"><a href="#cb29-150" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb29-151"><a href="#cb29-151" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb29-152"><a href="#cb29-152" aria-hidden="true" tabindex="-1"></a>      <span class="at">locations =</span> <span class="fu">cells_column_spanners</span>()</span>
<span id="cb29-153"><a href="#cb29-153" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb29-154"><a href="#cb29-154" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add borders between column labels</span></span>
<span id="cb29-155"><a href="#cb29-155" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_style</span>(</span>
<span id="cb29-156"><a href="#cb29-156" aria-hidden="true" tabindex="-1"></a>      <span class="at">style =</span> <span class="fu">cell_borders</span>(</span>
<span id="cb29-157"><a href="#cb29-157" aria-hidden="true" tabindex="-1"></a>        <span class="at">sides =</span> <span class="fu">c</span>(<span class="st">"top"</span>, <span class="st">"bottom"</span>),</span>
<span id="cb29-158"><a href="#cb29-158" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb29-159"><a href="#cb29-159" aria-hidden="true" tabindex="-1"></a>        <span class="at">weight =</span> <span class="fu">px</span>(<span class="fl">1.5</span>)</span>
<span id="cb29-160"><a href="#cb29-160" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb29-161"><a href="#cb29-161" aria-hidden="true" tabindex="-1"></a>      <span class="at">locations =</span> <span class="fu">cells_column_labels</span>()</span>
<span id="cb29-162"><a href="#cb29-162" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb29-163"><a href="#cb29-163" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add borders to data cells - finer and lighter grey</span></span>
<span id="cb29-164"><a href="#cb29-164" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_style</span>(</span>
<span id="cb29-165"><a href="#cb29-165" aria-hidden="true" tabindex="-1"></a>      <span class="at">style =</span> <span class="fu">cell_borders</span>(</span>
<span id="cb29-166"><a href="#cb29-166" aria-hidden="true" tabindex="-1"></a>        <span class="at">sides =</span> <span class="fu">c</span>(<span class="st">"top"</span>, <span class="st">"bottom"</span>),</span>
<span id="cb29-167"><a href="#cb29-167" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">"#D3D3D3"</span>,</span>
<span id="cb29-168"><a href="#cb29-168" aria-hidden="true" tabindex="-1"></a>        <span class="at">weight =</span> <span class="fu">px</span>(<span class="fl">0.5</span>)</span>
<span id="cb29-169"><a href="#cb29-169" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb29-170"><a href="#cb29-170" aria-hidden="true" tabindex="-1"></a>      <span class="at">locations =</span> <span class="fu">cells_body</span>()</span>
<span id="cb29-171"><a href="#cb29-171" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb29-172"><a href="#cb29-172" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Keep the bottom border of the last row thick and black</span></span>
<span id="cb29-173"><a href="#cb29-173" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_style</span>(</span>
<span id="cb29-174"><a href="#cb29-174" aria-hidden="true" tabindex="-1"></a>      <span class="at">style =</span> <span class="fu">cell_borders</span>(</span>
<span id="cb29-175"><a href="#cb29-175" aria-hidden="true" tabindex="-1"></a>        <span class="at">sides =</span> <span class="st">"bottom"</span>,</span>
<span id="cb29-176"><a href="#cb29-176" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb29-177"><a href="#cb29-177" aria-hidden="true" tabindex="-1"></a>        <span class="at">weight =</span> <span class="fu">px</span>(<span class="fl">1.5</span>)</span>
<span id="cb29-178"><a href="#cb29-178" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb29-179"><a href="#cb29-179" aria-hidden="true" tabindex="-1"></a>      <span class="at">locations =</span> <span class="fu">cells_body</span>(</span>
<span id="cb29-180"><a href="#cb29-180" aria-hidden="true" tabindex="-1"></a>        <span class="at">rows =</span> <span class="fu">nrow</span>(summary_table)</span>
<span id="cb29-181"><a href="#cb29-181" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb29-182"><a href="#cb29-182" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb29-183"><a href="#cb29-183" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Make force_level values bold</span></span>
<span id="cb29-184"><a href="#cb29-184" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_style</span>(</span>
<span id="cb29-185"><a href="#cb29-185" aria-hidden="true" tabindex="-1"></a>      <span class="at">style =</span> <span class="fu">cell_text</span>(<span class="at">weight =</span> <span class="st">"bold"</span>),</span>
<span id="cb29-186"><a href="#cb29-186" aria-hidden="true" tabindex="-1"></a>      <span class="at">locations =</span> <span class="fu">cells_body</span>(<span class="at">columns =</span> force_level)</span>
<span id="cb29-187"><a href="#cb29-187" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb29-188"><a href="#cb29-188" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cols_label</span>(<span class="sc">!!!</span>col_labels) <span class="sc">%&gt;%</span></span>
<span id="cb29-189"><a href="#cb29-189" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Transform text to add %</span></span>
<span id="cb29-190"><a href="#cb29-190" aria-hidden="true" tabindex="-1"></a>    <span class="fu">text_transform</span>(</span>
<span id="cb29-191"><a href="#cb29-191" aria-hidden="true" tabindex="-1"></a>      <span class="at">locations =</span> <span class="fu">cells_body</span>(<span class="at">columns =</span> force_level),</span>
<span id="cb29-192"><a href="#cb29-192" aria-hidden="true" tabindex="-1"></a>      <span class="at">fn =</span> <span class="cf">function</span>(x) <span class="fu">paste0</span>(x, <span class="st">"%"</span>)</span>
<span id="cb29-193"><a href="#cb29-193" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb29-194"><a href="#cb29-194" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fmt_number</span>(</span>
<span id="cb29-195"><a href="#cb29-195" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> <span class="fu">contains</span>(<span class="st">"avg_motor_units"</span>),</span>
<span id="cb29-196"><a href="#cb29-196" aria-hidden="true" tabindex="-1"></a>      <span class="at">decimals =</span> <span class="dv">1</span></span>
<span id="cb29-197"><a href="#cb29-197" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb29-198"><a href="#cb29-198" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Center align numeric columns</span></span>
<span id="cb29-199"><a href="#cb29-199" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cols_align</span>(</span>
<span id="cb29-200"><a href="#cb29-200" aria-hidden="true" tabindex="-1"></a>      <span class="at">align =</span> <span class="st">"center"</span>,</span>
<span id="cb29-201"><a href="#cb29-201" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> <span class="sc">-</span>force_level</span>
<span id="cb29-202"><a href="#cb29-202" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb29-203"><a href="#cb29-203" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cols_align</span>(</span>
<span id="cb29-204"><a href="#cb29-204" aria-hidden="true" tabindex="-1"></a>      <span class="at">align =</span> <span class="st">"left"</span>,</span>
<span id="cb29-205"><a href="#cb29-205" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> force_level</span>
<span id="cb29-206"><a href="#cb29-206" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb29-207"><a href="#cb29-207" aria-hidden="true" tabindex="-1"></a>    <span class="fu">opt_horizontal_padding</span>(<span class="at">scale =</span> <span class="fl">2.6</span>)</span>
<span id="cb29-208"><a href="#cb29-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-209"><a href="#cb29-209" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return the table</span></span>
<span id="cb29-210"><a href="#cb29-210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(final_table)</span>
<span id="cb29-211"><a href="#cb29-211" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>final_table <span class="ot">&lt;-</span> <span class="fu">create_MU_summary_table</span>(mu_data)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>final_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="gnnmdobdoj" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#gnnmdobdoj table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#gnnmdobdoj thead, #gnnmdobdoj tbody, #gnnmdobdoj tfoot, #gnnmdobdoj tr, #gnnmdobdoj td, #gnnmdobdoj th {
  border-style: none;
}

#gnnmdobdoj p {
  margin: 0;
  padding: 0;
}

#gnnmdobdoj .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 1.5px;
  border-top-color: #000000;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 1.5px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#gnnmdobdoj .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#gnnmdobdoj .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 13px;
  padding-right: 13px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#gnnmdobdoj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 13px;
  padding-right: 13px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#gnnmdobdoj .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gnnmdobdoj .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 1.5px;
  border-bottom-color: #000000;
}

#gnnmdobdoj .gt_col_headings {
  border-top-style: solid;
  border-top-width: 1.5px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1.5px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gnnmdobdoj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 13px;
  padding-right: 13px;
  overflow-x: hidden;
}

#gnnmdobdoj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#gnnmdobdoj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#gnnmdobdoj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#gnnmdobdoj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 1.5px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#gnnmdobdoj .gt_spanner_row {
  border-bottom-style: hidden;
}

#gnnmdobdoj .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 13px;
  padding-right: 13px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 1.5px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1.5px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#gnnmdobdoj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 1.5px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1.5px;
  border-bottom-color: #000000;
  vertical-align: middle;
}

#gnnmdobdoj .gt_from_md > :first-child {
  margin-top: 0;
}

#gnnmdobdoj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#gnnmdobdoj .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 13px;
  padding-right: 13px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#gnnmdobdoj .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 13px;
  padding-right: 13px;
}

#gnnmdobdoj .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 13px;
  padding-right: 13px;
  vertical-align: top;
}

#gnnmdobdoj .gt_row_group_first td {
  border-top-width: 1.5px;
}

#gnnmdobdoj .gt_row_group_first th {
  border-top-width: 1.5px;
}

#gnnmdobdoj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 13px;
  padding-right: 13px;
}

#gnnmdobdoj .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#gnnmdobdoj .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#gnnmdobdoj .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 13px;
  padding-right: 13px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gnnmdobdoj .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 13px;
  padding-right: 13px;
}

#gnnmdobdoj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 13px;
  padding-right: 13px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#gnnmdobdoj .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 13px;
  padding-right: 13px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#gnnmdobdoj .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#gnnmdobdoj .gt_table_body {
  border-top-style: solid;
  border-top-width: 1.5px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1.5px;
  border-bottom-color: #000000;
}

#gnnmdobdoj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gnnmdobdoj .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 13px;
  padding-right: 13px;
}

#gnnmdobdoj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gnnmdobdoj .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 13px;
  padding-right: 13px;
}

#gnnmdobdoj .gt_left {
  text-align: left;
}

#gnnmdobdoj .gt_center {
  text-align: center;
}

#gnnmdobdoj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#gnnmdobdoj .gt_font_normal {
  font-weight: normal;
}

#gnnmdobdoj .gt_font_bold {
  font-weight: bold;
}

#gnnmdobdoj .gt_font_italic {
  font-style: italic;
}

#gnnmdobdoj .gt_super {
  font-size: 65%;
}

#gnnmdobdoj .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#gnnmdobdoj .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#gnnmdobdoj .gt_indent_1 {
  text-indent: 5px;
}

#gnnmdobdoj .gt_indent_2 {
  text-indent: 10px;
}

#gnnmdobdoj .gt_indent_3 {
  text-indent: 15px;
}

#gnnmdobdoj .gt_indent_4 {
  text-indent: 20px;
}

#gnnmdobdoj .gt_indent_5 {
  text-indent: 25px;
}

#gnnmdobdoj .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#gnnmdobdoj div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings gt_spanner_row header">
<th class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" style="font-weight: bold; border-top-width: 1.5px; border-top-style: solid; border-top-color: black; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: black; font-weight: bold; border-top-width: 1.5px; border-top-style: solid; border-top-color: black; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: black" scope="col"></th>
<th colspan="4" id="Strength-trained" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" style="font-weight: bold; border-top-width: 1.5px; border-top-style: solid; border-top-color: black; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: black; font-weight: bold; border-top-width: 1.5px; border-top-style: solid; border-top-color: black; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: black" scope="colgroup"><span class="gt_column_spanner">Strength-trained</span></th>
<th colspan="4" id="Dexterity-trained" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" style="font-weight: bold; border-top-width: 1.5px; border-top-style: solid; border-top-color: black; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: black; font-weight: bold; border-top-width: 1.5px; border-top-style: solid; border-top-color: black; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: black" scope="colgroup"><span class="gt_column_spanner">Dexterity-trained</span></th>
</tr>
<tr class="gt_col_headings gt_spanner_row even">
<th rowspan="2" id="Force Level" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="border-top-width: 1.5px; border-top-style: solid; border-top-color: black; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: black" scope="col">Force Level</th>
<th colspan="2" id="APB" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" style="font-weight: bold; border-top-width: 1.5px; border-top-style: solid; border-top-color: black; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: black" scope="colgroup"><span class="gt_column_spanner">APB</span></th>
<th colspan="2" id="FDS" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" style="font-weight: bold; border-top-width: 1.5px; border-top-style: solid; border-top-color: black; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: black" scope="colgroup"><span class="gt_column_spanner">FDS</span></th>
<th colspan="2" id="APB" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" style="font-weight: bold; border-top-width: 1.5px; border-top-style: solid; border-top-color: black; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: black" scope="colgroup"><span class="gt_column_spanner">APB</span></th>
<th colspan="2" id="FDS" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" style="font-weight: bold; border-top-width: 1.5px; border-top-style: solid; border-top-color: black; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: black" scope="colgroup"><span class="gt_column_spanner">FDS</span></th>
</tr>
<tr class="gt_col_headings header">
<th id="N" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="border-top-width: 1.5px; border-top-style: solid; border-top-color: black; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: black" scope="col">N</th>
<th id="No. MUs" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="border-top-width: 1.5px; border-top-style: solid; border-top-color: black; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: black" scope="col">No. MUs</th>
<th id="N" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="border-top-width: 1.5px; border-top-style: solid; border-top-color: black; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: black" scope="col">N</th>
<th id="No. MUs" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="border-top-width: 1.5px; border-top-style: solid; border-top-color: black; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: black" scope="col">No. MUs</th>
<th id="N" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="border-top-width: 1.5px; border-top-style: solid; border-top-color: black; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: black" scope="col">N</th>
<th id="No. MUs" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="border-top-width: 1.5px; border-top-style: solid; border-top-color: black; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: black" scope="col">No. MUs</th>
<th id="N" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="border-top-width: 1.5px; border-top-style: solid; border-top-color: black; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: black" scope="col">N</th>
<th id="No. MUs" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="border-top-width: 1.5px; border-top-style: solid; border-top-color: black; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: black" scope="col">No. MUs</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="force_level" style="border-top-width: 0.5px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 0.5px; border-bottom-style: solid; border-bottom-color: #D3D3D3; font-weight: bold">15%</td>
<td class="gt_row gt_center" headers="n_participants_strength_apb" style="border-top-width: 0.5px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 0.5px; border-bottom-style: solid; border-bottom-color: #D3D3D3">6</td>
<td class="gt_row gt_center" headers="avg_motor_units_strength_apb" style="border-top-width: 0.5px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 0.5px; border-bottom-style: solid; border-bottom-color: #D3D3D3">4.3</td>
<td class="gt_row gt_center" headers="n_participants_strength_fds" style="border-top-width: 0.5px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 0.5px; border-bottom-style: solid; border-bottom-color: #D3D3D3">3</td>
<td class="gt_row gt_center" headers="avg_motor_units_strength_fds" style="border-top-width: 0.5px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 0.5px; border-bottom-style: solid; border-bottom-color: #D3D3D3">3.3</td>
<td class="gt_row gt_center" headers="n_participants_dexterity_apb" style="border-top-width: 0.5px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 0.5px; border-bottom-style: solid; border-bottom-color: #D3D3D3">9</td>
<td class="gt_row gt_center" headers="avg_motor_units_dexterity_apb" style="border-top-width: 0.5px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 0.5px; border-bottom-style: solid; border-bottom-color: #D3D3D3">4.0</td>
<td class="gt_row gt_center" headers="n_participants_dexterity_fds" style="border-top-width: 0.5px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 0.5px; border-bottom-style: solid; border-bottom-color: #D3D3D3">4</td>
<td class="gt_row gt_center" headers="avg_motor_units_dexterity_fds" style="border-top-width: 0.5px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 0.5px; border-bottom-style: solid; border-bottom-color: #D3D3D3">2.0</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="force_level" style="border-top-width: 0.5px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 0.5px; border-bottom-style: solid; border-bottom-color: #D3D3D3; font-weight: bold">35%</td>
<td class="gt_row gt_center" headers="n_participants_strength_apb" style="border-top-width: 0.5px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 0.5px; border-bottom-style: solid; border-bottom-color: #D3D3D3">10</td>
<td class="gt_row gt_center" headers="avg_motor_units_strength_apb" style="border-top-width: 0.5px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 0.5px; border-bottom-style: solid; border-bottom-color: #D3D3D3">8.3</td>
<td class="gt_row gt_center" headers="n_participants_strength_fds" style="border-top-width: 0.5px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 0.5px; border-bottom-style: solid; border-bottom-color: #D3D3D3">5</td>
<td class="gt_row gt_center" headers="avg_motor_units_strength_fds" style="border-top-width: 0.5px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 0.5px; border-bottom-style: solid; border-bottom-color: #D3D3D3">7.2</td>
<td class="gt_row gt_center" headers="n_participants_dexterity_apb" style="border-top-width: 0.5px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 0.5px; border-bottom-style: solid; border-bottom-color: #D3D3D3">10</td>
<td class="gt_row gt_center" headers="avg_motor_units_dexterity_apb" style="border-top-width: 0.5px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 0.5px; border-bottom-style: solid; border-bottom-color: #D3D3D3">9.7</td>
<td class="gt_row gt_center" headers="n_participants_dexterity_fds" style="border-top-width: 0.5px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 0.5px; border-bottom-style: solid; border-bottom-color: #D3D3D3">5</td>
<td class="gt_row gt_center" headers="avg_motor_units_dexterity_fds" style="border-top-width: 0.5px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 0.5px; border-bottom-style: solid; border-bottom-color: #D3D3D3">4.6</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="force_level" style="border-top-width: 0.5px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 0.5px; border-bottom-style: solid; border-bottom-color: #D3D3D3; font-weight: bold">55%</td>
<td class="gt_row gt_center" headers="n_participants_strength_apb" style="border-top-width: 0.5px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 0.5px; border-bottom-style: solid; border-bottom-color: #D3D3D3">10</td>
<td class="gt_row gt_center" headers="avg_motor_units_strength_apb" style="border-top-width: 0.5px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 0.5px; border-bottom-style: solid; border-bottom-color: #D3D3D3">18.1</td>
<td class="gt_row gt_center" headers="n_participants_strength_fds" style="border-top-width: 0.5px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 0.5px; border-bottom-style: solid; border-bottom-color: #D3D3D3">10</td>
<td class="gt_row gt_center" headers="avg_motor_units_strength_fds" style="border-top-width: 0.5px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 0.5px; border-bottom-style: solid; border-bottom-color: #D3D3D3">8.1</td>
<td class="gt_row gt_center" headers="n_participants_dexterity_apb" style="border-top-width: 0.5px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 0.5px; border-bottom-style: solid; border-bottom-color: #D3D3D3">10</td>
<td class="gt_row gt_center" headers="avg_motor_units_dexterity_apb" style="border-top-width: 0.5px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 0.5px; border-bottom-style: solid; border-bottom-color: #D3D3D3">15.9</td>
<td class="gt_row gt_center" headers="n_participants_dexterity_fds" style="border-top-width: 0.5px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 0.5px; border-bottom-style: solid; border-bottom-color: #D3D3D3">7</td>
<td class="gt_row gt_center" headers="avg_motor_units_dexterity_fds" style="border-top-width: 0.5px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 0.5px; border-bottom-style: solid; border-bottom-color: #D3D3D3">7.0</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="force_level" style="border-top-width: 0.5px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: black; font-weight: bold">70%</td>
<td class="gt_row gt_center" headers="n_participants_strength_apb" style="border-top-width: 0.5px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: black">9</td>
<td class="gt_row gt_center" headers="avg_motor_units_strength_apb" style="border-top-width: 0.5px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: black">18.1</td>
<td class="gt_row gt_center" headers="n_participants_strength_fds" style="border-top-width: 0.5px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: black">9</td>
<td class="gt_row gt_center" headers="avg_motor_units_strength_fds" style="border-top-width: 0.5px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: black">11.9</td>
<td class="gt_row gt_center" headers="n_participants_dexterity_apb" style="border-top-width: 0.5px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: black">10</td>
<td class="gt_row gt_center" headers="avg_motor_units_dexterity_apb" style="border-top-width: 0.5px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: black">19.1</td>
<td class="gt_row gt_center" headers="n_participants_dexterity_fds" style="border-top-width: 0.5px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: black">9</td>
<td class="gt_row gt_center" headers="avg_motor_units_dexterity_fds" style="border-top-width: 0.5px; border-top-style: solid; border-top-color: #D3D3D3; border-bottom-width: 1.5px; border-bottom-style: solid; border-bottom-color: black">6.9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="linear-mixed-effects-model" class="level4">
<h4 class="anchored" data-anchor-id="linear-mixed-effects-model">Linear mixed effects model</h4>
<p>This is a linear mixed effects model of average firing rate.</p>
<ul>
<li><p>The fixed effects, which are all interaction terms include:</p>
<ul>
<li><p>Testing group.</p></li>
<li><p>Force level.</p></li>
<li><p>Muscle being tested.</p></li>
</ul></li>
<li><p>The random effects is:</p>
<ul>
<li><p>Participant.</p></li>
<li><p>Firing (or recruitment) threshold.</p></li>
</ul></li>
</ul>
<div class="cell" data-warnings="false">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>model_participant_firing_threhsold <span class="ot">&lt;-</span> <span class="fu">lmer</span>(avg_firing_rate </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>                                           <span class="sc">~</span> testing_group </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>                                           <span class="sc">*</span> force_level </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>                                           <span class="sc">*</span> muscle</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>                                           <span class="sc">+</span>(<span class="dv">1</span><span class="sc">|</span>participant) </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>                                           <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>firing_threshold),</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">data=</span>mu_data</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>                                           )</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_participant_firing_threhsold)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: avg_firing_rate ~ testing_group * force_level * muscle + (1 |  
    participant) + (1 | firing_threshold)
   Data: mu_data

REML criterion at convergence: 8652.4

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-2.18965 -0.46806 -0.00462  0.50564  2.68590 

Random effects:
 Groups           Name        Variance Std.Dev.
 firing_threshold (Intercept) 19.387   4.403   
 participant      (Intercept)  2.378   1.542   
 Residual                     24.558   4.956   
Number of obs: 1312, groups:  firing_threshold, 1233; participant, 20

Fixed effects:
                                               Estimate Std. Error        df
(Intercept)                                      8.9756     1.2206  306.4061
testing_groupstrength                            0.5606     1.8517  380.8512
force_level35                                    8.7190     1.3141 1294.7817
force_level55                                   10.8926     1.2344 1289.9666
force_level70                                   12.8065     1.2230 1289.0139
musclefds                                       -3.5144     2.6246 1279.3408
testing_groupstrength:force_level35             -6.0901     2.0046 1295.7599
testing_groupstrength:force_level55             -2.5711     1.8632 1289.5843
testing_groupstrength:force_level70             -1.3839     1.8591 1287.8217
testing_groupstrength:musclefds                 -0.6201     3.6155 1294.8645
force_level35:musclefds                         -9.4995     3.0297 1283.6760
force_level55:musclefds                         -8.2725     2.8193 1268.3432
force_level70:musclefds                         -9.2254     2.8046 1265.5318
testing_groupstrength:force_level35:musclefds    8.8483     4.1451 1293.0045
testing_groupstrength:force_level55:musclefds    3.7329     3.8653 1291.0599
testing_groupstrength:force_level70:musclefds    3.1491     3.8484 1291.0855
                                              t value Pr(&gt;|t|)    
(Intercept)                                     7.353 1.78e-12 ***
testing_groupstrength                           0.303  0.76226    
force_level35                                   6.635 4.75e-11 ***
force_level55                                   8.824  &lt; 2e-16 ***
force_level70                                  10.472  &lt; 2e-16 ***
musclefds                                      -1.339  0.18080    
testing_groupstrength:force_level35            -3.038  0.00243 ** 
testing_groupstrength:force_level55            -1.380  0.16784    
testing_groupstrength:force_level70            -0.744  0.45680    
testing_groupstrength:musclefds                -0.172  0.86385    
force_level35:musclefds                        -3.135  0.00175 ** 
force_level55:musclefds                        -2.934  0.00340 ** 
force_level70:musclefds                        -3.289  0.00103 ** 
testing_groupstrength:force_level35:musclefds   2.135  0.03298 *  
testing_groupstrength:force_level55:musclefds   0.966  0.33436    
testing_groupstrength:force_level70:musclefds   0.818  0.41335    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<section id="check-model-assumptions-and-fit" class="level5">
<h5 class="anchored" data-anchor-id="check-model-assumptions-and-fit">Check model assumptions and fit:</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>check1 <span class="ot">&lt;-</span> <span class="fu">plot</span>(<span class="fu">check_heteroscedasticity</span>(model_participant_firing_threhsold))</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>check2 <span class="ot">&lt;-</span> <span class="fu">plot</span>(<span class="fu">check_normality</span>(model_participant_firing_threhsold))</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>check3 <span class="ot">&lt;-</span> <span class="fu">plot</span>(<span class="fu">check_predictions</span>(model_participant_firing_threhsold))</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>check1 <span class="sc">+</span> check2 <span class="sc">+</span> check3 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">guides =</span> <span class="st">"collect"</span>) <span class="sc">&amp;</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="statistical_analysis_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="652"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model_performance</span>(model_participant_firing_threhsold)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC      |     AICc |      BIC | R2 (cond.) | R2 (marg.) |   ICC |  RMSE | Sigma
--------------------------------------------------------------------------------
8690.351 | 8690.939 | 8788.758 |      0.674 |      0.385 | 0.470 | 3.719 | 4.956</code></pre>
</div>
</div>
</section>
</section>
<section id="average-firing-rate-calculations-using-estimated-marginal-means" class="level4">
<h4 class="anchored" data-anchor-id="average-firing-rate-calculations-using-estimated-marginal-means">Average firing rate calculations using estimated marginal means</h4>
<p>Here we calculate the average firing rate estimated marginal means and 95% confidence intervals. These were calculated for each testing group and muscle, conditioned on force level.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model_participant_firing_threhsold, </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>               pairwise </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>               <span class="sc">~</span> testing_group </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>               <span class="sc">|</span> force_level </span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>               <span class="sc">+</span> muscle, </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">adjust =</span> <span class="st">'BH'</span>, </span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">infer =</span> T)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>emm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$emmeans
force_level = 15, muscle = apb:
 testing_group emmean    SE     df lower.CL upper.CL t.ratio p.value
 dexterity       8.98 1.224  312.3    6.568    11.38   7.335  &lt;.0001
 strength        9.54 1.395  462.1    6.794    12.28   6.834  &lt;.0001

force_level = 35, muscle = apb:
 testing_group emmean    SE     df lower.CL upper.CL t.ratio p.value
 dexterity      17.69 0.859   86.2   15.986    19.40  20.589  &lt;.0001
 strength       12.17 0.901  107.5   10.380    13.95  13.507  &lt;.0001

force_level = 55, muscle = apb:
 testing_group emmean    SE     df lower.CL upper.CL t.ratio p.value
 dexterity      19.87 0.736   48.9   18.389    21.35  26.991  &lt;.0001
 strength       17.86 0.696   41.4   16.452    19.26  25.653  &lt;.0001

force_level = 70, muscle = apb:
 testing_group emmean    SE     df lower.CL upper.CL t.ratio p.value
 dexterity      21.78 0.704   41.4   20.362    23.20  30.956  &lt;.0001
 strength       20.96 0.724   46.9   19.503    22.41  28.966  &lt;.0001

force_level = 15, muscle = fds:
 testing_group emmean    SE     df lower.CL upper.CL t.ratio p.value
 dexterity       5.46 2.424 1088.5    0.705    10.22   2.253  0.0245
 strength        5.40 2.165  987.6    1.154     9.65   2.495  0.0127

force_level = 35, muscle = fds:
 testing_group emmean    SE     df lower.CL upper.CL t.ratio p.value
 dexterity       4.68 1.502  500.3    1.730     7.63   3.117  0.0019
 strength        7.38 1.252  308.0    4.916     9.84   5.894  &lt;.0001

force_level = 55, muscle = fds:
 testing_group emmean    SE     df lower.CL upper.CL t.ratio p.value
 dexterity       8.08 1.120  204.2    5.873    10.29   7.214  &lt;.0001
 strength        9.18 0.894  106.0    7.412    10.96  10.277  &lt;.0001

force_level = 70, muscle = fds:
 testing_group emmean    SE     df lower.CL upper.CL t.ratio p.value
 dexterity       9.04 0.996  157.4    7.075    11.01   9.078  &lt;.0001
 strength       10.75 0.829   78.0    9.098    12.40  12.967  &lt;.0001

Degrees-of-freedom method: kenward-roger 
Confidence level used: 0.95 

$contrasts
force_level = 15, muscle = apb:
 contrast             estimate   SE     df lower.CL upper.CL t.ratio p.value
 dexterity - strength  -0.5606 1.86  387.6  -4.2095    3.088  -0.302  0.7628

force_level = 35, muscle = apb:
 contrast             estimate   SE     df lower.CL upper.CL t.ratio p.value
 dexterity - strength   5.5296 1.24   96.5   3.0587    8.000   4.442  &lt;.0001

force_level = 55, muscle = apb:
 contrast             estimate   SE     df lower.CL upper.CL t.ratio p.value
 dexterity - strength   2.0105 1.01   45.1  -0.0299    4.051   1.984  0.0533

force_level = 70, muscle = apb:
 contrast             estimate   SE     df lower.CL upper.CL t.ratio p.value
 dexterity - strength   0.8233 1.01   44.1  -1.2106    2.857   0.816  0.4190

force_level = 15, muscle = fds:
 contrast             estimate   SE     df lower.CL upper.CL t.ratio p.value
 dexterity - strength   0.0595 3.25 1062.0  -6.3178    6.437   0.018  0.9854

force_level = 35, muscle = fds:
 contrast             estimate   SE     df lower.CL upper.CL t.ratio p.value
 dexterity - strength  -2.6986 1.96  407.0  -6.5422    1.145  -1.380  0.1683

force_level = 55, muscle = fds:
 contrast             estimate   SE     df lower.CL upper.CL t.ratio p.value
 dexterity - strength  -1.1023 1.43  154.7  -3.9330    1.728  -0.769  0.4429

force_level = 70, muscle = fds:
 contrast             estimate   SE     df lower.CL upper.CL t.ratio p.value
 dexterity - strength  -1.7057 1.30  114.9  -4.2725    0.861  -1.316  0.1907

Degrees-of-freedom method: kenward-roger 
Confidence level used: 0.95 </code></pre>
</div>
</div>
</section>
<section id="plotting-1" class="level4">
<h4 class="anchored" data-anchor-id="plotting-1">Plotting</h4>
<p>Here the average firing rate is plotted, which each muscle in its own facet.</p>
<ul>
<li><p>NOTE:</p>
<ul>
<li><p>15% MVC in the FDS muscle was not included in the analysis due to the low number of identified motor units.</p></li>
<li><p>Some styling and organisation of plots were done in InkScape after their creation. All data elements were kept identical to their output, only aesthetic changes were made.</p></li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show function for plotting</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FUNCTION: create_emmeans_plot</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Creates geom_point plot for the estimated marginal mean motor unit firing rate </span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co"># at each force level and for each muscle.</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Inputs:</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="co"># - data: output from the EMmeans function used for calculation of estimated marginal means            in linear</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="co">#         mixed effects models</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Outputs:</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="co"># - Plot of EMM average motor unit firing rate faceted by muscle.</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>create_emmeans_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(emm) {</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Process estimated marginal means data:</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># - Rename columns for clarity </span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># - Convert force levels to numeric</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># - Format group names</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># - Filter to include only specific force levels for each muscle</span></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>  processed_emm_data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(emm<span class="sc">$</span>emmeans) <span class="sc">%&gt;%</span></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">Mean =</span> emmean, </span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>           <span class="at">Lower_CI =</span> lower.CL, </span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>           <span class="at">Upper_CI =</span> upper.CL) <span class="sc">%&gt;%</span></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">force_level =</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"MVC"</span>, <span class="st">""</span>, <span class="fu">as.character</span>(force_level))),</span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">muscle =</span> <span class="fu">case_when</span>(</span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>        muscle <span class="sc">==</span> <span class="st">"apb"</span> <span class="sc">~</span> <span class="st">"Abductor Pollicis Brevis"</span>,</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>        muscle <span class="sc">==</span> <span class="st">"fds"</span> <span class="sc">~</span> <span class="st">"Flexor Digitorum Superficialis"</span>,</span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> muscle</span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">testing_group =</span> <span class="fu">case_when</span>(</span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a>        testing_group <span class="sc">==</span> <span class="st">"strength"</span> <span class="sc">~</span> <span class="st">"Strength-Trained"</span>,</span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a>        testing_group <span class="sc">==</span> <span class="st">"dexterity"</span> <span class="sc">~</span> <span class="st">"Dexterity-Trained"</span>,</span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> testing_group</span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filter data to include:</span></span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># - APB muscle: 15%, 35%, 55%, 70% force levels</span></span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># - FDS muscle: 35%, 55%, 70% force levels</span></span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>((muscle <span class="sc">==</span> <span class="st">"Abductor Pollicis Brevis"</span> <span class="sc">&amp;</span> force_level <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">35</span>, <span class="dv">55</span>, <span class="dv">70</span>)) <span class="sc">|</span></span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a>             (muscle <span class="sc">==</span> <span class="st">"Flexor Digitorum Superficialis"</span> <span class="sc">&amp;</span> force_level <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">35</span>, <span class="dv">55</span>, <span class="dv">70</span>)))</span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create plot showing estimated means and confidence intervals</span></span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(processed_emm_data, <span class="fu">aes</span>(<span class="at">x =</span> force_level, <span class="at">color =</span> testing_group)) <span class="sc">+</span></span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add fine lines connecting means within each group</span></span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Mean, <span class="at">group =</span> testing_group, <span class="at">linetype =</span> testing_group), </span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a>              <span class="at">linewidth =</span> <span class="fl">0.2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb38-49"><a href="#cb38-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add points with error bars showing confidence intervals</span></span>
<span id="cb38-50"><a href="#cb38-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">y =</span> Mean, <span class="at">ymin =</span> Lower_CI, <span class="at">ymax =</span> Upper_CI, </span>
<span id="cb38-51"><a href="#cb38-51" aria-hidden="true" tabindex="-1"></a>                        <span class="at">shape =</span> testing_group, <span class="at">fill =</span> testing_group), </span>
<span id="cb38-52"><a href="#cb38-52" aria-hidden="true" tabindex="-1"></a>                    <span class="at">linewidth =</span> <span class="fl">1.5</span>, <span class="at">size =</span> <span class="fl">0.7</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb38-53"><a href="#cb38-53" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add labels and titles</span></span>
<span id="cb38-54"><a href="#cb38-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb38-55"><a href="#cb38-55" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Percentage of MVC"</span>,</span>
<span id="cb38-56"><a href="#cb38-56" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"EMM Firing Rate"</span>,</span>
<span id="cb38-57"><a href="#cb38-57" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"Testing Group"</span>,</span>
<span id="cb38-58"><a href="#cb38-58" aria-hidden="true" tabindex="-1"></a>      <span class="at">shape =</span> <span class="st">"Testing Group"</span>,</span>
<span id="cb38-59"><a href="#cb38-59" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> <span class="st">"Testing Group"</span>,</span>
<span id="cb38-60"><a href="#cb38-60" aria-hidden="true" tabindex="-1"></a>      <span class="at">linetype =</span> <span class="st">"Testing Group"</span></span>
<span id="cb38-61"><a href="#cb38-61" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb38-62"><a href="#cb38-62" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Apply black and white theme and customize appearance</span></span>
<span id="cb38-63"><a href="#cb38-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb38-64"><a href="#cb38-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb38-65"><a href="#cb38-65" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb38-66"><a href="#cb38-66" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb38-67"><a href="#cb38-67" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"grey70"</span>),</span>
<span id="cb38-68"><a href="#cb38-68" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb38-69"><a href="#cb38-69" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb38-70"><a href="#cb38-70" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">15</span>)),</span>
<span id="cb38-71"><a href="#cb38-71" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb38-72"><a href="#cb38-72" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.3</span>, <span class="at">colour =</span> <span class="st">"grey80"</span>),</span>
<span id="cb38-73"><a href="#cb38-73" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.y.left =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">r =</span> <span class="dv">10</span>)),</span>
<span id="cb38-74"><a href="#cb38-74" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb38-75"><a href="#cb38-75" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb38-76"><a href="#cb38-76" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"grey90"</span>, <span class="at">color =</span> <span class="cn">NA</span>) ,</span>
<span id="cb38-77"><a href="#cb38-77" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb38-78"><a href="#cb38-78" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>)</span>
<span id="cb38-79"><a href="#cb38-79" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb38-80"><a href="#cb38-80" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Configure x-axis scale and labels</span></span>
<span id="cb38-81"><a href="#cb38-81" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(</span>
<span id="cb38-82"><a href="#cb38-82" aria-hidden="true" tabindex="-1"></a>      <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">75</span>),</span>
<span id="cb38-83"><a href="#cb38-83" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(<span class="at">scale =</span> <span class="dv">1</span>),</span>
<span id="cb38-84"><a href="#cb38-84" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">35</span>, <span class="dv">55</span>, <span class="dv">70</span>)</span>
<span id="cb38-85"><a href="#cb38-85" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb38-86"><a href="#cb38-86" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set custom shapes, colors, fills and line types for groups</span></span>
<span id="cb38-87"><a href="#cb38-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Strength-Trained"</span> <span class="ot">=</span> <span class="dv">21</span>, <span class="st">"Dexterity-Trained"</span> <span class="ot">=</span> <span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb38-88"><a href="#cb38-88" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Strength-Trained"</span> <span class="ot">=</span> <span class="st">"#fe9d5d"</span>, <span class="st">"Dexterity-Trained"</span> <span class="ot">=</span> <span class="st">"#456990"</span>)) <span class="sc">+</span></span>
<span id="cb38-89"><a href="#cb38-89" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Strength-Trained"</span> <span class="ot">=</span> <span class="st">"#fe9d5d"</span>, <span class="st">"Dexterity-Trained"</span> <span class="ot">=</span> <span class="st">"#456990"</span>)) <span class="sc">+</span></span>
<span id="cb38-90"><a href="#cb38-90" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Strength-Trained"</span> <span class="ot">=</span> <span class="dv">5</span>, <span class="st">"Dexterity-Trained"</span> <span class="ot">=</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb38-91"><a href="#cb38-91" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create separate panels for each muscle</span></span>
<span id="cb38-92"><a href="#cb38-92" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> muscle)</span>
<span id="cb38-93"><a href="#cb38-93" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>mu_avg_firing_rate_plot <span class="ot">&lt;-</span> <span class="fu">create_emmeans_plot</span>(emm)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>mu_avg_firing_rate_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="statistical_analysis_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="652"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="coherence-plotting" class="level2">
<h2 class="anchored" data-anchor-id="coherence-plotting">Coherence plotting</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load pooled coherence data</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>pooled_coherence_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"pooled_coherence_data.csv"</span>, </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">col_types =</span> <span class="fu">cols</span>(</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">.default =</span> <span class="fu">col_double</span>(),</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>                                    <span class="co"># Specify all chi2_sig columns as logical</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">strength_chi2_sig_15 =</span> <span class="fu">col_logical</span>(),</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">strength_chi2_sig_35 =</span> <span class="fu">col_logical</span>(),</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">strength_chi2_sig_55 =</span> <span class="fu">col_logical</span>(),</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">strength_chi2_sig_70 =</span> <span class="fu">col_logical</span>(),</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">dexterity_chi2_sig_15 =</span> <span class="fu">col_logical</span>(),</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">dexterity_chi2_sig_35 =</span> <span class="fu">col_logical</span>(),</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">dexterity_chi2_sig_55 =</span> <span class="fu">col_logical</span>(),</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">dexterity_chi2_sig_70 =</span> <span class="fu">col_logical</span>()</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>                                  ),</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Load coherence histogram data</span></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>coherence_histogram_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"histogram_coherence_data.csv"</span>, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Load comparison of coherence data</span></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>comparison_of_coherence_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"comparison_of_coherence_data.csv"</span>, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="pooled-coherence-plots" class="level4">
<h4 class="anchored" data-anchor-id="pooled-coherence-plots">Pooled coherence plots</h4>
<div class="cell">
<details class="code-fold">
<summary>Show function for plotting pooled coherence plots</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FUNCTION: create_faceted_coherence_plots</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Creates NeuroSpec-style pooled coherence plots in a faceted layout</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Inputs:</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="co"># - data: pooled coherence data</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Outputs:</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="co"># - 2x4 faceted plot with strength/dexterity on rows and force levels on columns</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>create_faceted_coherence_plots <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Prepare data in long format for faceting</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>  force_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"15"</span>, <span class="st">"35"</span>, <span class="st">"55"</span>, <span class="st">"70"</span>)</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>  testing_groups <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"strength"</span>, <span class="st">"dexterity"</span>)</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create empty list to store reshaped data</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>  plot_data_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Reshape data for each combination</span></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (group <span class="cf">in</span> testing_groups) {</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (force <span class="cf">in</span> force_levels) {</span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Construct column names dynamically</span></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>      coh_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(group, <span class="st">"_coh_"</span>, force)</span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>      ci_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(group, <span class="st">"_ci_"</span>, force)</span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>      chi2_sig_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(group, <span class="st">"_chi2_sig_"</span>, force)</span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Create subset with necessary columns</span></span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>      temp_data <span class="ot">&lt;-</span> data[, <span class="fu">c</span>(<span class="st">"freq"</span>, coh_col, ci_col, chi2_sig_col)]</span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">names</span>(temp_data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"freq"</span>, <span class="st">"coherence"</span>, <span class="st">"ci"</span>, <span class="st">"chi2_sig"</span>)</span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a>      temp_data<span class="sc">$</span>testing_group <span class="ot">&lt;-</span> group</span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a>      temp_data<span class="sc">$</span>force_level <span class="ot">&lt;-</span> force</span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a>      plot_data_list <span class="ot">&lt;-</span> <span class="fu">append</span>(plot_data_list, <span class="fu">list</span>(temp_data))</span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine all data</span></span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a>  long_data <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, plot_data_list)</span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert to factors for proper ordering</span></span>
<span id="cb41-41"><a href="#cb41-41" aria-hidden="true" tabindex="-1"></a>  long_data<span class="sc">$</span>testing_group <span class="ot">&lt;-</span> <span class="fu">factor</span>(long_data<span class="sc">$</span>testing_group, </span>
<span id="cb41-42"><a href="#cb41-42" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"strength"</span>, <span class="st">"dexterity"</span>))</span>
<span id="cb41-43"><a href="#cb41-43" aria-hidden="true" tabindex="-1"></a>  long_data<span class="sc">$</span>force_level <span class="ot">&lt;-</span> <span class="fu">factor</span>(long_data<span class="sc">$</span>force_level, </span>
<span id="cb41-44"><a href="#cb41-44" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"15"</span>, <span class="st">"35"</span>, <span class="st">"55"</span>, <span class="st">"70"</span>))</span>
<span id="cb41-45"><a href="#cb41-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-46"><a href="#cb41-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create significant points subset</span></span>
<span id="cb41-47"><a href="#cb41-47" aria-hidden="true" tabindex="-1"></a>  sig_data <span class="ot">&lt;-</span> long_data[long_data<span class="sc">$</span>chi2_sig <span class="sc">==</span> <span class="cn">TRUE</span>, ]</span>
<span id="cb41-48"><a href="#cb41-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-49"><a href="#cb41-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the faceted plot</span></span>
<span id="cb41-50"><a href="#cb41-50" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(long_data, <span class="fu">aes</span>(<span class="at">x =</span> freq)) <span class="sc">+</span></span>
<span id="cb41-51"><a href="#cb41-51" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add shaded frequency bands</span></span>
<span id="cb41-52"><a href="#cb41-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="dv">8</span>, <span class="at">xmax =</span> <span class="dv">16</span>, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> <span class="fl">0.04</span>,</span>
<span id="cb41-53"><a href="#cb41-53" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> <span class="st">"grey90"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb41-54"><a href="#cb41-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="dv">16</span>, <span class="at">xmax =</span> <span class="dv">30</span>, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> <span class="fl">0.04</span>,</span>
<span id="cb41-55"><a href="#cb41-55" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> <span class="st">"grey75"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb41-56"><a href="#cb41-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="dv">30</span>, <span class="at">xmax =</span> <span class="dv">60</span>, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> <span class="fl">0.04</span>,</span>
<span id="cb41-57"><a href="#cb41-57" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> <span class="st">"grey60"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb41-58"><a href="#cb41-58" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add symbols (will appear in each facet)</span></span>
<span id="cb41-59"><a href="#cb41-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">12</span>, <span class="at">y =</span> <span class="fl">0.035</span>, <span class="at">label =</span> <span class="st">"\u03B1"</span>, <span class="at">size =</span> <span class="dv">10</span><span class="sc">/</span>.pt) <span class="sc">+</span></span>
<span id="cb41-60"><a href="#cb41-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">22</span>, <span class="at">y =</span> <span class="fl">0.035</span>, <span class="at">label =</span> <span class="st">"\u03B2"</span>, <span class="at">size =</span> <span class="dv">10</span><span class="sc">/</span>.pt) <span class="sc">+</span></span>
<span id="cb41-61"><a href="#cb41-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">45</span>, <span class="at">y =</span> <span class="fl">0.035</span>, <span class="at">label =</span> <span class="st">"\u03B3"</span>, <span class="at">size =</span> <span class="dv">10</span><span class="sc">/</span>.pt) <span class="sc">+</span></span>
<span id="cb41-62"><a href="#cb41-62" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add coherence line with color</span></span>
<span id="cb41-63"><a href="#cb41-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> coherence, <span class="at">color =</span> testing_group), <span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb41-64"><a href="#cb41-64" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add confidence interval as dashed line</span></span>
<span id="cb41-65"><a href="#cb41-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> ci), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb41-66"><a href="#cb41-66" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add red X marks for significant chi2 points</span></span>
<span id="cb41-67"><a href="#cb41-67" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> sig_data, </span>
<span id="cb41-68"><a href="#cb41-68" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">y =</span> coherence), </span>
<span id="cb41-69"><a href="#cb41-69" aria-hidden="true" tabindex="-1"></a>               <span class="at">shape =</span> <span class="dv">4</span>, <span class="co"># X shape</span></span>
<span id="cb41-70"><a href="#cb41-70" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"red"</span>, </span>
<span id="cb41-71"><a href="#cb41-71" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb41-72"><a href="#cb41-72" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set axis limits and breaks</span></span>
<span id="cb41-73"><a href="#cb41-73" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(</span>
<span id="cb41-74"><a href="#cb41-74" aria-hidden="true" tabindex="-1"></a>      <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">65</span>),</span>
<span id="cb41-75"><a href="#cb41-75" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>, <span class="dv">60</span>),</span>
<span id="cb41-76"><a href="#cb41-76" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Frequency (Hz)"</span>,</span>
<span id="cb41-77"><a href="#cb41-77" aria-hidden="true" tabindex="-1"></a>      <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>))</span>
<span id="cb41-78"><a href="#cb41-78" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb41-79"><a href="#cb41-79" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(</span>
<span id="cb41-80"><a href="#cb41-80" aria-hidden="true" tabindex="-1"></a>      <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.04</span>), </span>
<span id="cb41-81"><a href="#cb41-81" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.01</span>, <span class="fl">0.02</span>, <span class="fl">0.03</span>, <span class="fl">0.04</span>),</span>
<span id="cb41-82"><a href="#cb41-82" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Coherence Estimate"</span>,</span>
<span id="cb41-83"><a href="#cb41-83" aria-hidden="true" tabindex="-1"></a>      <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>))</span>
<span id="cb41-84"><a href="#cb41-84" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb41-85"><a href="#cb41-85" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add color scale</span></span>
<span id="cb41-86"><a href="#cb41-86" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(</span>
<span id="cb41-87"><a href="#cb41-87" aria-hidden="true" tabindex="-1"></a>      <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"strength"</span> <span class="ot">=</span> <span class="st">"#fe9d5d"</span>, <span class="st">"dexterity"</span> <span class="ot">=</span> <span class="st">"#456990"</span>),</span>
<span id="cb41-88"><a href="#cb41-88" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"strength"</span> <span class="ot">=</span> <span class="st">"Strength-Trained"</span>, <span class="st">"dexterity"</span> <span class="ot">=</span> <span class="st">"Dexterity-Trained"</span>)</span>
<span id="cb41-89"><a href="#cb41-89" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb41-90"><a href="#cb41-90" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create facets: rows = testing groups, columns = force levels</span></span>
<span id="cb41-91"><a href="#cb41-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(testing_group <span class="sc">~</span> force_level,</span>
<span id="cb41-92"><a href="#cb41-92" aria-hidden="true" tabindex="-1"></a>               <span class="at">labeller =</span> <span class="fu">labeller</span>(</span>
<span id="cb41-93"><a href="#cb41-93" aria-hidden="true" tabindex="-1"></a>                 <span class="at">testing_group =</span> <span class="fu">c</span>(<span class="st">"strength"</span> <span class="ot">=</span> <span class="st">"Strength-Trained"</span>,</span>
<span id="cb41-94"><a href="#cb41-94" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"dexterity"</span> <span class="ot">=</span> <span class="st">"Dexterity-Trained"</span>),</span>
<span id="cb41-95"><a href="#cb41-95" aria-hidden="true" tabindex="-1"></a>                 <span class="at">force_level =</span> <span class="cf">function</span>(x) <span class="fu">paste0</span>(x, <span class="st">"% MVC"</span>)</span>
<span id="cb41-96"><a href="#cb41-96" aria-hidden="true" tabindex="-1"></a>               ),</span>
<span id="cb41-97"><a href="#cb41-97" aria-hidden="true" tabindex="-1"></a>               <span class="at">switch =</span> <span class="st">"y"</span>) <span class="sc">+</span>  <span class="co"># Move row strip labels to the left</span></span>
<span id="cb41-98"><a href="#cb41-98" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Theme modifications</span></span>
<span id="cb41-99"><a href="#cb41-99" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb41-100"><a href="#cb41-100" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb41-101"><a href="#cb41-101" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb41-102"><a href="#cb41-102" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb41-103"><a href="#cb41-103" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb41-104"><a href="#cb41-104" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb41-105"><a href="#cb41-105" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb41-106"><a href="#cb41-106" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb41-107"><a href="#cb41-107" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.placement =</span> <span class="st">"none"</span>,</span>
<span id="cb41-108"><a href="#cb41-108" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.spacing.y =</span> <span class="fu">unit</span>(<span class="fl">0.8</span>, <span class="st">"lines"</span>),</span>
<span id="cb41-109"><a href="#cb41-109" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"grey50"</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>),</span>
<span id="cb41-110"><a href="#cb41-110" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey30"</span>, <span class="at">linewidth =</span> <span class="fl">0.3</span>),</span>
<span id="cb41-111"><a href="#cb41-111" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb41-112"><a href="#cb41-112" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Change axis fonts</span></span>
<span id="cb41-113"><a href="#cb41-113" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">11</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">l =</span> <span class="dv">0</span>),</span>
<span id="cb41-114"><a href="#cb41-114" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb41-115"><a href="#cb41-115" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb41-116"><a href="#cb41-116" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb41-117"><a href="#cb41-117" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb41-118"><a href="#cb41-118" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb41-119"><a href="#cb41-119" aria-hidden="true" tabindex="-1"></a>      <span class="co"># No legend since groups are faceted</span></span>
<span id="cb41-120"><a href="#cb41-120" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb41-121"><a href="#cb41-121" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb41-122"><a href="#cb41-122" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-123"><a href="#cb41-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb41-124"><a href="#cb41-124" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the faceted coherence plot</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>faceted_coherence_plot <span class="ot">&lt;-</span> <span class="fu">create_faceted_coherence_plots</span>(pooled_coherence_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pooled-histogram-plots" class="level4">
<h4 class="anchored" data-anchor-id="pooled-histogram-plots">Pooled histogram plots</h4>
<div class="cell">
<details class="code-fold">
<summary>Show function for plotting pooled coherence histogram plots</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FUNCTION: create_faceted_histogram_plots</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Creates histogram plots of percentage of trials with significant coherence</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Inputs:</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="co"># - data: coherence histogram data</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Outputs:</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="co"># - 2x4 faceted plot with strength/dexterity on rows and force levels on columns</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>create_faceted_histogram_plots <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Prepare data in long format for faceting</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>  force_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"15"</span>, <span class="st">"35"</span>, <span class="st">"55"</span>, <span class="st">"70"</span>)</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>  testing_groups <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"strength"</span>, <span class="st">"dexterity"</span>)</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create empty list to store reshaped data</span></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>  plot_data_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Reshape data for each combination</span></span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (group <span class="cf">in</span> testing_groups) {</span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (force <span class="cf">in</span> force_levels) {</span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Construct column name dynamically</span></span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>      hist_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(group, <span class="st">"_MVC"</span>, force)</span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Create subset with necessary columns</span></span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>      temp_data <span class="ot">&lt;-</span> data[, <span class="fu">c</span>(<span class="st">"freq"</span>, hist_col)]</span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a>      <span class="fu">names</span>(temp_data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"freq"</span>, <span class="st">"value"</span>)</span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a>      temp_data<span class="sc">$</span>value <span class="ot">&lt;-</span> temp_data<span class="sc">$</span>value <span class="sc">*</span> <span class="dv">100</span>  <span class="co"># Convert to percentage</span></span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a>      temp_data<span class="sc">$</span>testing_group <span class="ot">&lt;-</span> group</span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a>      temp_data<span class="sc">$</span>force_level <span class="ot">&lt;-</span> force</span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a>      plot_data_list <span class="ot">&lt;-</span> <span class="fu">append</span>(plot_data_list, <span class="fu">list</span>(temp_data))</span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine all data</span></span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a>  long_data <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, plot_data_list)</span>
<span id="cb43-39"><a href="#cb43-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-40"><a href="#cb43-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert to factors for proper ordering</span></span>
<span id="cb43-41"><a href="#cb43-41" aria-hidden="true" tabindex="-1"></a>  long_data<span class="sc">$</span>testing_group <span class="ot">&lt;-</span> <span class="fu">factor</span>(long_data<span class="sc">$</span>testing_group, </span>
<span id="cb43-42"><a href="#cb43-42" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"strength"</span>, <span class="st">"dexterity"</span>))</span>
<span id="cb43-43"><a href="#cb43-43" aria-hidden="true" tabindex="-1"></a>  long_data<span class="sc">$</span>force_level <span class="ot">&lt;-</span> <span class="fu">factor</span>(long_data<span class="sc">$</span>force_level, </span>
<span id="cb43-44"><a href="#cb43-44" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"15"</span>, <span class="st">"35"</span>, <span class="st">"55"</span>, <span class="st">"70"</span>))</span>
<span id="cb43-45"><a href="#cb43-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-46"><a href="#cb43-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the faceted plot</span></span>
<span id="cb43-47"><a href="#cb43-47" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(long_data, <span class="fu">aes</span>(<span class="at">x =</span> freq)) <span class="sc">+</span></span>
<span id="cb43-48"><a href="#cb43-48" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add shaded frequency bands</span></span>
<span id="cb43-49"><a href="#cb43-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="dv">8</span>, <span class="at">xmax =</span> <span class="dv">16</span>, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> <span class="dv">25</span>,</span>
<span id="cb43-50"><a href="#cb43-50" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> <span class="st">"grey90"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb43-51"><a href="#cb43-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="dv">16</span>, <span class="at">xmax =</span> <span class="dv">30</span>, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> <span class="dv">25</span>,</span>
<span id="cb43-52"><a href="#cb43-52" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> <span class="st">"grey75"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb43-53"><a href="#cb43-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="dv">30</span>, <span class="at">xmax =</span> <span class="dv">60</span>, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> <span class="dv">25</span>,</span>
<span id="cb43-54"><a href="#cb43-54" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> <span class="st">"grey60"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb43-55"><a href="#cb43-55" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add symbols (will appear in each facet)</span></span>
<span id="cb43-56"><a href="#cb43-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">12</span>, <span class="at">y =</span> <span class="dv">22</span>, <span class="at">label =</span> <span class="st">"\u03B1"</span>, <span class="at">size =</span> <span class="dv">10</span><span class="sc">/</span>.pt) <span class="sc">+</span></span>
<span id="cb43-57"><a href="#cb43-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">23.5</span>, <span class="at">y =</span> <span class="dv">22</span>, <span class="at">label =</span> <span class="st">"\u03B2"</span>, <span class="at">size =</span> <span class="dv">10</span><span class="sc">/</span>.pt) <span class="sc">+</span></span>
<span id="cb43-58"><a href="#cb43-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">45</span>, <span class="at">y =</span> <span class="dv">22</span>, <span class="at">label =</span> <span class="st">"\u03B3"</span>, <span class="at">size =</span> <span class="dv">10</span><span class="sc">/</span>.pt) <span class="sc">+</span></span>
<span id="cb43-59"><a href="#cb43-59" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add histogram bars</span></span>
<span id="cb43-60"><a href="#cb43-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">y =</span> value, <span class="at">fill =</span> testing_group), <span class="at">width =</span> <span class="fl">1.3</span>) <span class="sc">+</span></span>
<span id="cb43-61"><a href="#cb43-61" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set axis limits and breaks</span></span>
<span id="cb43-62"><a href="#cb43-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(</span>
<span id="cb43-63"><a href="#cb43-63" aria-hidden="true" tabindex="-1"></a>      <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">65</span>),</span>
<span id="cb43-64"><a href="#cb43-64" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">60</span>, <span class="at">by =</span> <span class="dv">10</span>),</span>
<span id="cb43-65"><a href="#cb43-65" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Frequency (Hz)"</span>,</span>
<span id="cb43-66"><a href="#cb43-66" aria-hidden="true" tabindex="-1"></a>      <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>))</span>
<span id="cb43-67"><a href="#cb43-67" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb43-68"><a href="#cb43-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(</span>
<span id="cb43-69"><a href="#cb43-69" aria-hidden="true" tabindex="-1"></a>      <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">25</span>), </span>
<span id="cb43-70"><a href="#cb43-70" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">25</span>),</span>
<span id="cb43-71"><a href="#cb43-71" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">paste0</span>(x, <span class="st">"%"</span>),</span>
<span id="cb43-72"><a href="#cb43-72" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"% of Trials"</span>,</span>
<span id="cb43-73"><a href="#cb43-73" aria-hidden="true" tabindex="-1"></a>      <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>))</span>
<span id="cb43-74"><a href="#cb43-74" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb43-75"><a href="#cb43-75" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add fill scale</span></span>
<span id="cb43-76"><a href="#cb43-76" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(</span>
<span id="cb43-77"><a href="#cb43-77" aria-hidden="true" tabindex="-1"></a>      <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"strength"</span> <span class="ot">=</span> <span class="st">"#fe9d5d"</span>, <span class="st">"dexterity"</span> <span class="ot">=</span> <span class="st">"#456990"</span>),</span>
<span id="cb43-78"><a href="#cb43-78" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"strength"</span> <span class="ot">=</span> <span class="st">"Strength-Trained"</span>, <span class="st">"dexterity"</span> <span class="ot">=</span> <span class="st">"Dexterity-Trained"</span>)</span>
<span id="cb43-79"><a href="#cb43-79" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb43-80"><a href="#cb43-80" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create facets: rows = testing groups, columns = force levels</span></span>
<span id="cb43-81"><a href="#cb43-81" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(testing_group <span class="sc">~</span> force_level,</span>
<span id="cb43-82"><a href="#cb43-82" aria-hidden="true" tabindex="-1"></a>               <span class="at">labeller =</span> <span class="fu">labeller</span>(</span>
<span id="cb43-83"><a href="#cb43-83" aria-hidden="true" tabindex="-1"></a>                 <span class="at">testing_group =</span> <span class="fu">c</span>(<span class="st">"strength"</span> <span class="ot">=</span> <span class="st">"Strength-Trained"</span>,</span>
<span id="cb43-84"><a href="#cb43-84" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"dexterity"</span> <span class="ot">=</span> <span class="st">"Dexterity-Trained"</span>),</span>
<span id="cb43-85"><a href="#cb43-85" aria-hidden="true" tabindex="-1"></a>                 <span class="at">force_level =</span> <span class="cf">function</span>(x) <span class="fu">paste0</span>(x, <span class="st">"% MVC"</span>)</span>
<span id="cb43-86"><a href="#cb43-86" aria-hidden="true" tabindex="-1"></a>               ),</span>
<span id="cb43-87"><a href="#cb43-87" aria-hidden="true" tabindex="-1"></a>               <span class="at">switch =</span> <span class="st">"y"</span>) <span class="sc">+</span>  <span class="co"># Move row strip labels to the left</span></span>
<span id="cb43-88"><a href="#cb43-88" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Theme modifications</span></span>
<span id="cb43-89"><a href="#cb43-89" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb43-90"><a href="#cb43-90" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb43-91"><a href="#cb43-91" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb43-92"><a href="#cb43-92" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb43-93"><a href="#cb43-93" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb43-94"><a href="#cb43-94" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb43-95"><a href="#cb43-95" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb43-96"><a href="#cb43-96" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb43-97"><a href="#cb43-97" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.placement =</span> <span class="st">"none"</span>,</span>
<span id="cb43-98"><a href="#cb43-98" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.spacing.y =</span> <span class="fu">unit</span>(<span class="fl">0.8</span>, <span class="st">"lines"</span>),</span>
<span id="cb43-99"><a href="#cb43-99" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"grey50"</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>),</span>
<span id="cb43-100"><a href="#cb43-100" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey30"</span>, <span class="at">linewidth =</span> <span class="fl">0.3</span>),</span>
<span id="cb43-101"><a href="#cb43-101" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb43-102"><a href="#cb43-102" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Change axis fonts</span></span>
<span id="cb43-103"><a href="#cb43-103" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">11</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">l =</span> <span class="dv">0</span>),</span>
<span id="cb43-104"><a href="#cb43-104" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb43-105"><a href="#cb43-105" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">9</span>),</span>
<span id="cb43-106"><a href="#cb43-106" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb43-107"><a href="#cb43-107" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">9</span>),</span>
<span id="cb43-108"><a href="#cb43-108" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb43-109"><a href="#cb43-109" aria-hidden="true" tabindex="-1"></a>      <span class="co"># No legend since groups are faceted</span></span>
<span id="cb43-110"><a href="#cb43-110" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"none"</span></span>
<span id="cb43-111"><a href="#cb43-111" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb43-112"><a href="#cb43-112" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-113"><a href="#cb43-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb43-114"><a href="#cb43-114" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the faceted histogram plot</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>faceted_histogram_plot <span class="ot">&lt;-</span> <span class="fu">create_faceted_histogram_plots</span>(coherence_histogram_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine plots</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>combined_plots <span class="ot">&lt;-</span> faceted_coherence_plot <span class="sc">/</span> <span class="fu">plot_spacer</span>() <span class="sc">/</span> faceted_histogram_plot <span class="sc">+</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">guides =</span> <span class="st">"collect"</span>,</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis_titles =</span> <span class="st">"collect"</span>,</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.03</span>,<span class="dv">1</span>)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">tag_levels =</span> <span class="st">"A"</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">&amp;</span> </span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">10</span>, <span class="at">l =</span> <span class="dv">0</span>),</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="sc">-</span><span class="dv">7</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">l =</span> <span class="dv">0</span>),</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.tag.position =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="dv">1</span>),</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>, <span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>combined_plots</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="statistical_analysis_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="652"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="comparison-of-coherence-plots" class="level4">
<h4 class="anchored" data-anchor-id="comparison-of-coherence-plots">Comparison of coherence plots</h4>
<div class="cell">
<details class="code-fold">
<summary>Show function for plotting comparison of coherence plots</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FUNCTION: create_faceted_comparison_of_coherence_plots</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Creates NeuroSpec-style plots for comparison of coherence in a faceted layout</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Inputs:</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="co"># - data: "comparison_of_coherence_data.csv"</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Outputs:</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="co"># - 2x2 faceted plot with force levels</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>create_faceted_comparison_of_coherence_plots <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Force levels to use</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>  force_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"15"</span>, <span class="st">"35"</span>, <span class="st">"55"</span>, <span class="st">"70"</span>)</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create empty list to store reshaped data</span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>  plot_data_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Reshape data for each force level</span></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (force <span class="cf">in</span> force_levels) {</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Construct column names dynamically</span></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>    coh_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"compcoh_"</span>, force)</span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>    ci_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"ci_"</span>, force)</span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create subset with necessary columns</span></span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>    temp_data <span class="ot">&lt;-</span> data[, <span class="fu">c</span>(<span class="st">"freq"</span>, coh_col, ci_col)]</span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(temp_data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"freq"</span>, <span class="st">"coherence"</span>, <span class="st">"ci"</span>)</span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>    temp_data<span class="sc">$</span>force_level <span class="ot">&lt;-</span> force</span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a>    plot_data_list <span class="ot">&lt;-</span> <span class="fu">append</span>(plot_data_list, <span class="fu">list</span>(temp_data))</span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine all data</span></span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a>  long_data <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, plot_data_list)</span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert to factor for proper ordering</span></span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a>  long_data<span class="sc">$</span>force_level <span class="ot">&lt;-</span> <span class="fu">factor</span>(long_data<span class="sc">$</span>force_level, </span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"15"</span>, <span class="st">"35"</span>, <span class="st">"55"</span>, <span class="st">"70"</span>))</span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the faceted plot</span></span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(long_data, <span class="fu">aes</span>(<span class="at">x =</span> freq)) <span class="sc">+</span></span>
<span id="cb46-41"><a href="#cb46-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add shaded frequency bands</span></span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="dv">8</span>, <span class="at">xmax =</span> <span class="dv">16</span>, <span class="at">ymin =</span> <span class="sc">-</span><span class="fl">0.21</span>, <span class="at">ymax =</span> <span class="fl">0.21</span>,</span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> <span class="st">"grey90"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb46-44"><a href="#cb46-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="dv">16</span>, <span class="at">xmax =</span> <span class="dv">30</span>, <span class="at">ymin =</span> <span class="sc">-</span><span class="fl">0.21</span>, <span class="at">ymax =</span> <span class="fl">0.21</span>,</span>
<span id="cb46-45"><a href="#cb46-45" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> <span class="st">"grey75"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb46-46"><a href="#cb46-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="dv">30</span>, <span class="at">xmax =</span> <span class="dv">60</span>, <span class="at">ymin =</span> <span class="sc">-</span><span class="fl">0.21</span>, <span class="at">ymax =</span> <span class="fl">0.21</span>,</span>
<span id="cb46-47"><a href="#cb46-47" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> <span class="st">"grey60"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb46-48"><a href="#cb46-48" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add symbols for frequency bands</span></span>
<span id="cb46-49"><a href="#cb46-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">12</span>, <span class="at">y =</span> <span class="fl">0.18</span>, <span class="at">label =</span> <span class="st">"\u03B1"</span>, <span class="at">size =</span> <span class="dv">12</span><span class="sc">/</span>.pt) <span class="sc">+</span></span>
<span id="cb46-50"><a href="#cb46-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">23</span>, <span class="at">y =</span> <span class="fl">0.18</span>, <span class="at">label =</span> <span class="st">"\u03B2"</span>, <span class="at">size =</span> <span class="dv">12</span><span class="sc">/</span>.pt) <span class="sc">+</span></span>
<span id="cb46-51"><a href="#cb46-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">45</span>, <span class="at">y =</span> <span class="fl">0.18</span>, <span class="at">label =</span> <span class="st">"\u03B3"</span>, <span class="at">size =</span> <span class="dv">12</span><span class="sc">/</span>.pt) <span class="sc">+</span></span>
<span id="cb46-52"><a href="#cb46-52" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add confidence intervals as horizontal lines</span></span>
<span id="cb46-53"><a href="#cb46-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> ci), <span class="at">color =</span> <span class="st">"#fe9d5d"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb46-54"><a href="#cb46-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="sc">-</span>ci), <span class="at">color =</span> <span class="st">"#456990"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb46-55"><a href="#cb46-55" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add zero line</span></span>
<span id="cb46-56"><a href="#cb46-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb46-57"><a href="#cb46-57" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add coherence line</span></span>
<span id="cb46-58"><a href="#cb46-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> coherence), <span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb46-59"><a href="#cb46-59" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set axis limits and breaks</span></span>
<span id="cb46-60"><a href="#cb46-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(</span>
<span id="cb46-61"><a href="#cb46-61" aria-hidden="true" tabindex="-1"></a>      <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">65</span>),</span>
<span id="cb46-62"><a href="#cb46-62" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">60</span>, <span class="at">by =</span> <span class="dv">10</span>),</span>
<span id="cb46-63"><a href="#cb46-63" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Frequency (Hz)"</span>,</span>
<span id="cb46-64"><a href="#cb46-64" aria-hidden="true" tabindex="-1"></a>      <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>))</span>
<span id="cb46-65"><a href="#cb46-65" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb46-66"><a href="#cb46-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(</span>
<span id="cb46-67"><a href="#cb46-67" aria-hidden="true" tabindex="-1"></a>      <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.21</span>, <span class="fl">0.21</span>),</span>
<span id="cb46-68"><a href="#cb46-68" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Difference of Coherence"</span>,</span>
<span id="cb46-69"><a href="#cb46-69" aria-hidden="true" tabindex="-1"></a>      <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>))</span>
<span id="cb46-70"><a href="#cb46-70" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb46-71"><a href="#cb46-71" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create 2x2 facets using facet_wrap</span></span>
<span id="cb46-72"><a href="#cb46-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> force_level,</span>
<span id="cb46-73"><a href="#cb46-73" aria-hidden="true" tabindex="-1"></a>               <span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb46-74"><a href="#cb46-74" aria-hidden="true" tabindex="-1"></a>               <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb46-75"><a href="#cb46-75" aria-hidden="true" tabindex="-1"></a>               <span class="at">labeller =</span> <span class="fu">labeller</span>(</span>
<span id="cb46-76"><a href="#cb46-76" aria-hidden="true" tabindex="-1"></a>                 <span class="at">force_level =</span> <span class="cf">function</span>(x) <span class="fu">paste0</span>(x, <span class="st">"% MVC"</span>)</span>
<span id="cb46-77"><a href="#cb46-77" aria-hidden="true" tabindex="-1"></a>               )) <span class="sc">+</span></span>
<span id="cb46-78"><a href="#cb46-78" aria-hidden="true" tabindex="-1"></a>   <span class="co"># Theme modifications</span></span>
<span id="cb46-79"><a href="#cb46-79" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb46-80"><a href="#cb46-80" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb46-81"><a href="#cb46-81" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb46-82"><a href="#cb46-82" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb46-83"><a href="#cb46-83" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb46-84"><a href="#cb46-84" aria-hidden="true" tabindex="-1"></a>      <span class="co">#strip.background = element_rect(color = NA),</span></span>
<span id="cb46-85"><a href="#cb46-85" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb46-86"><a href="#cb46-86" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb46-87"><a href="#cb46-87" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb46-88"><a href="#cb46-88" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="fl">0.8</span>, <span class="st">"lines"</span>),</span>
<span id="cb46-89"><a href="#cb46-89" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"grey70"</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>),</span>
<span id="cb46-90"><a href="#cb46-90" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey30"</span>, <span class="at">linewidth =</span> <span class="fl">0.3</span>),</span>
<span id="cb46-91"><a href="#cb46-91" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="cn">NA</span>, <span class="at">fill =</span> <span class="st">"grey90"</span>),</span>
<span id="cb46-92"><a href="#cb46-92" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb46-93"><a href="#cb46-93" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Change Axis Fonts</span></span>
<span id="cb46-94"><a href="#cb46-94" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb46-95"><a href="#cb46-95" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">9</span>),<span class="co">#face = "bold"),</span></span>
<span id="cb46-96"><a href="#cb46-96" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb46-97"><a href="#cb46-97" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">9</span>),<span class="co">#face = "bold"),</span></span>
<span id="cb46-98"><a href="#cb46-98" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb46-99"><a href="#cb46-99" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Position legend closer to the x-axis</span></span>
<span id="cb46-100"><a href="#cb46-100" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb46-101"><a href="#cb46-101" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">10</span>, <span class="at">l =</span> <span class="dv">0</span>),</span>
<span id="cb46-102"><a href="#cb46-102" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.box.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="sc">-</span><span class="dv">7</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">l =</span> <span class="dv">0</span>)</span>
<span id="cb46-103"><a href="#cb46-103" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb46-104"><a href="#cb46-104" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-105"><a href="#cb46-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb46-106"><a href="#cb46-106" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the faceted plot</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>faceted_comparison_coh_plot <span class="ot">&lt;-</span> <span class="fu">create_faceted_comparison_of_coherence_plots</span>(comparison_of_coherence_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show function for plotting average coherence across entire band</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FUNCTION: average_band_coherence</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Collapses pooled coherence across participants in each group at each force level for each band (alpha, beta and gamma)</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Inputs:</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="co"># - data: "pooled_coherence_data.csv"</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Outputs:</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="co"># - 3x1 faceted plot with coherence bands and force levels</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>average_band_coherence <span class="ot">&lt;-</span> <span class="cf">function</span>(pooled_coherence_data) {</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get column names containing coherence data</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>  coh_cols <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"coh_"</span>, <span class="fu">names</span>(pooled_coherence_data), <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialize an empty dataframe for the results</span></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>  result_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="fu">length</span>(coh_cols), <span class="at">nrow =</span> <span class="dv">3</span>))</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(result_df) <span class="ot">&lt;-</span> coh_cols</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames</span>(result_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"alpha"</span>, <span class="st">"beta"</span>, <span class="st">"gamma"</span>)</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define row ranges for each frequency band</span></span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>  alpha_rows <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">7</span></span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>  beta_rows <span class="ot">&lt;-</span> <span class="dv">8</span><span class="sc">:</span><span class="dv">13</span></span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>  gamma_rows <span class="ot">&lt;-</span> <span class="dv">14</span><span class="sc">:</span><span class="dv">28</span></span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate averages for each column and frequency band</span></span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (col <span class="cf">in</span> coh_cols) {</span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>    col_data <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(pooled_coherence_data[[col]]))</span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate average for alpha band (rows 4-7)</span></span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a>    result_df[<span class="dv">1</span>, col] <span class="ot">&lt;-</span> <span class="fu">mean</span>(col_data[alpha_rows], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate average for beta band (rows 8-28)</span></span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a>    result_df[<span class="dv">2</span>, col] <span class="ot">&lt;-</span> <span class="fu">mean</span>(col_data[beta_rows], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate average for gamma band (rows 14-28)</span></span>
<span id="cb48-38"><a href="#cb48-38" aria-hidden="true" tabindex="-1"></a>    result_df[<span class="dv">3</span>, col] <span class="ot">&lt;-</span> <span class="fu">mean</span>(col_data[gamma_rows], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb48-39"><a href="#cb48-39" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb48-40"><a href="#cb48-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-41"><a href="#cb48-41" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert result_df to a long format for easier plotting</span></span>
<span id="cb48-42"><a href="#cb48-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># First, add a row identifier for the frequency bands</span></span>
<span id="cb48-43"><a href="#cb48-43" aria-hidden="true" tabindex="-1"></a>  long_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(result_df)</span>
<span id="cb48-44"><a href="#cb48-44" aria-hidden="true" tabindex="-1"></a>  long_df<span class="sc">$</span>band <span class="ot">&lt;-</span> <span class="fu">rownames</span>(long_df)</span>
<span id="cb48-45"><a href="#cb48-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-46"><a href="#cb48-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Reshape the data to long format</span></span>
<span id="cb48-47"><a href="#cb48-47" aria-hidden="true" tabindex="-1"></a>  long_df <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(</span>
<span id="cb48-48"><a href="#cb48-48" aria-hidden="true" tabindex="-1"></a>    long_df,</span>
<span id="cb48-49"><a href="#cb48-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="sc">-</span>band,</span>
<span id="cb48-50"><a href="#cb48-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"condition"</span>,</span>
<span id="cb48-51"><a href="#cb48-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"coherence"</span></span>
<span id="cb48-52"><a href="#cb48-52" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-53"><a href="#cb48-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-54"><a href="#cb48-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the group and force level from the condition column</span></span>
<span id="cb48-55"><a href="#cb48-55" aria-hidden="true" tabindex="-1"></a>  long_df <span class="ot">&lt;-</span> long_df <span class="sc">%&gt;%</span></span>
<span id="cb48-56"><a href="#cb48-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb48-57"><a href="#cb48-57" aria-hidden="true" tabindex="-1"></a>      <span class="at">group =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"strength"</span>, condition), <span class="st">"Strength"</span>, <span class="st">"Dexterity"</span>),</span>
<span id="cb48-58"><a href="#cb48-58" aria-hidden="true" tabindex="-1"></a>      <span class="at">force =</span> <span class="fu">as.numeric</span>(<span class="fu">sub</span>(<span class="st">".*_coh_(</span><span class="sc">\\</span><span class="st">d+)$"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">1"</span>, condition))</span>
<span id="cb48-59"><a href="#cb48-59" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb48-60"><a href="#cb48-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-61"><a href="#cb48-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert band directly to a factor with capitalized labels</span></span>
<span id="cb48-62"><a href="#cb48-62" aria-hidden="true" tabindex="-1"></a>  long_df<span class="sc">$</span>band <span class="ot">&lt;-</span> <span class="fu">factor</span>(long_df<span class="sc">$</span>band, </span>
<span id="cb48-63"><a href="#cb48-63" aria-hidden="true" tabindex="-1"></a>                        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"alpha"</span>, <span class="st">"beta"</span>, <span class="st">"gamma"</span>),</span>
<span id="cb48-64"><a href="#cb48-64" aria-hidden="true" tabindex="-1"></a>                        <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Alpha"</span>, <span class="st">"Beta"</span>, <span class="st">"Gamma"</span>))</span>
<span id="cb48-65"><a href="#cb48-65" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-66"><a href="#cb48-66" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert group to a factor for color mapping</span></span>
<span id="cb48-67"><a href="#cb48-67" aria-hidden="true" tabindex="-1"></a>  long_df<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">factor</span>(long_df<span class="sc">$</span>group, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Strength"</span>, <span class="st">"Dexterity"</span>))</span>
<span id="cb48-68"><a href="#cb48-68" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-69"><a href="#cb48-69" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create your plot with adjusted spacing</span></span>
<span id="cb48-70"><a href="#cb48-70" aria-hidden="true" tabindex="-1"></a>  facet_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(long_df, <span class="fu">aes</span>(<span class="at">x =</span> force, <span class="at">y =</span> coherence, <span class="at">color =</span> group, <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb48-71"><a href="#cb48-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb48-72"><a href="#cb48-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb48-73"><a href="#cb48-73" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(</span>
<span id="cb48-74"><a href="#cb48-74" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">35</span>, <span class="dv">55</span>, <span class="dv">70</span>), </span>
<span id="cb48-75"><a href="#cb48-75" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"15%"</span>, <span class="st">"35%"</span>, <span class="st">"55%"</span>, <span class="st">"70%"</span>),</span>
<span id="cb48-76"><a href="#cb48-76" aria-hidden="true" tabindex="-1"></a>      <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">75</span>)</span>
<span id="cb48-77"><a href="#cb48-77" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb48-78"><a href="#cb48-78" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.015</span>)) <span class="sc">+</span></span>
<span id="cb48-79"><a href="#cb48-79" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Strength"</span> <span class="ot">=</span> <span class="st">"#fe9d5d"</span>, <span class="st">"Dexterity"</span> <span class="ot">=</span> <span class="st">"#456990"</span>), </span>
<span id="cb48-80"><a href="#cb48-80" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name =</span> <span class="st">"Testing Group"</span>) <span class="sc">+</span></span>
<span id="cb48-81"><a href="#cb48-81" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> band, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb48-82"><a href="#cb48-82" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Percentage of MVC"</span>,</span>
<span id="cb48-83"><a href="#cb48-83" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Average Coherence"</span>) <span class="sc">+</span></span>
<span id="cb48-84"><a href="#cb48-84" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb48-85"><a href="#cb48-85" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb48-86"><a href="#cb48-86" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb48-87"><a href="#cb48-87" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb48-88"><a href="#cb48-88" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb48-89"><a href="#cb48-89" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb48-90"><a href="#cb48-90" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb48-91"><a href="#cb48-91" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">"lines"</span>),</span>
<span id="cb48-92"><a href="#cb48-92" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"grey70"</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>),</span>
<span id="cb48-93"><a href="#cb48-93" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey30"</span>, <span class="at">linewidth =</span> <span class="fl">0.3</span>),</span>
<span id="cb48-94"><a href="#cb48-94" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="cn">NA</span>, <span class="at">fill =</span> <span class="st">"grey90"</span>),</span>
<span id="cb48-95"><a href="#cb48-95" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb48-96"><a href="#cb48-96" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Change axis fonts</span></span>
<span id="cb48-97"><a href="#cb48-97" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">11</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">l =</span> <span class="dv">0</span>), <span class="co">#change spacing</span></span>
<span id="cb48-98"><a href="#cb48-98" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb48-99"><a href="#cb48-99" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb48-100"><a href="#cb48-100" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb48-101"><a href="#cb48-101" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb48-102"><a href="#cb48-102" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb48-103"><a href="#cb48-103" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Position legend closer to the x-axis</span></span>
<span id="cb48-104"><a href="#cb48-104" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb48-105"><a href="#cb48-105" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">10</span>, <span class="at">l =</span> <span class="dv">0</span>),</span>
<span id="cb48-106"><a href="#cb48-106" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.box.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="sc">-</span><span class="dv">7</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">l =</span> <span class="dv">0</span>)</span>
<span id="cb48-107"><a href="#cb48-107" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb48-108"><a href="#cb48-108" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-109"><a href="#cb48-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(facet_plot)</span>
<span id="cb48-110"><a href="#cb48-110" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>facet_plot <span class="ot">&lt;-</span> <span class="fu">average_band_coherence</span>(pooled_coherence_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>faceted_comparison_coh_plot <span class="ot">&lt;-</span> faceted_comparison_coh_plot <span class="sc">+</span>  <span class="fu">theme</span>(</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">10</span>, <span class="at">l =</span> <span class="dv">0</span>),</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="sc">-</span><span class="dv">7</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">l =</span> <span class="dv">0</span>),</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.tag.position =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="dv">1</span>),</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a> combined_comparison <span class="ot">&lt;-</span> faceted_comparison_coh_plot<span class="sc">/</span> <span class="fu">plot_spacer</span>() <span class="sc">/</span> facet_plot <span class="sc">+</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">0.05</span>, <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"A"</span>) <span class="sc">+</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">10</span>, <span class="at">l =</span> <span class="dv">0</span>),</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="sc">-</span><span class="dv">7</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">l =</span> <span class="dv">0</span>),</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.tag.position =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="dv">1</span>),</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>, <span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a> <span class="fu">print</span>(combined_comparison)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="statistical_analysis_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="652"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="clustering-analysis" class="level2">
<h2 class="anchored" data-anchor-id="clustering-analysis">Clustering analysis</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>rms_data_for_R <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"rms_data_for_R.csv"</span>, </span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="at">group =</span> <span class="fu">col_factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"strength"</span>, </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"dexterity"</span>)), <span class="at">participant =</span> <span class="fu">col_factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"1"</span>, </span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"2"</span>, <span class="st">"3"</span>, <span class="st">"4"</span>, <span class="st">"5"</span>, <span class="st">"6"</span>, <span class="st">"7"</span>, <span class="st">"8"</span>, </span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">"9"</span>, <span class="st">"10"</span>, <span class="st">"11"</span>, <span class="st">"12"</span>, <span class="st">"13"</span>, <span class="st">"14"</span>, </span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"16"</span>, <span class="st">"17"</span>, <span class="st">"18"</span>, <span class="st">"19"</span>, <span class="st">"20"</span>, <span class="st">"21"</span>)), </span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">trial =</span> <span class="fu">col_factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"1"</span>, </span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>            <span class="st">"2"</span>, <span class="st">"3"</span>)), <span class="at">forcelevel =</span> <span class="fu">col_factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"15"</span>, </span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">"35"</span>, <span class="st">"55"</span>, <span class="st">"70"</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="determine-whether-clustering-is-appropriate" class="level4">
<h4 class="anchored" data-anchor-id="determine-whether-clustering-is-appropriate">Determine whether clustering is appropriate</h4>
<div class="cell">
<details class="code-fold">
<summary>Show function for calculating optimal clusters</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FUNCTION: determine_optimal_clusters</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Analyzes time series data to determine the optimal number of clusters for muscle activation patterns</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="co"># using both the Elbow method (WCSS) and Silhouette analysis.</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Inputs:</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="co"># - data: Dataframe containing muscle activation data (must include columns: participant,</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="co">#         group, forcelevel, time, force, and the specified muscle_name)</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="co"># - muscle_name: Name of the muscle column to analyze ("fds", "apb")</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="co"># - group_filter: Vector of group names to include (c("strength", "dexterity"))</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a><span class="co"># - force_level: The force level to analyze ("15", "35", "55", "70") </span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="co"># - max_k: Maximum number of clusters to consider (default = 6)</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Outputs: List containing:</span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a><span class="co"># - elbow_data: Dataframe with WCSS values for each k</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a><span class="co"># - silhouette_data: Dataframe with silhouette scores for each k</span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a><span class="co"># - optimal_k_elbow: Optimal number of clusters according to Elbow method</span></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a><span class="co"># - optimal_k_silhouette: Optimal number of clusters according to Silhouette method</span></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a><span class="co"># - plots: List containing the elbow plot</span></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a><span class="co"># - muscle_series_list: Preprocessed time series for clustering</span></span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a><span class="co"># - averaged_data: Processed data with trials averaged by participant</span></span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a><span class="co"># - participant_groups: Group assignments for each participant</span></span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>determine_optimal_clusters <span class="ot">&lt;-</span> <span class="cf">function</span>(data, muscle_name, group_filter, force_level, <span class="at">max_k =</span> <span class="dv">6</span>) {</span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter data for the specified group and force level</span></span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a>  single_subset <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(group <span class="sc">%in%</span> group_filter, forcelevel <span class="sc">==</span> force_level)</span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Average trials for each participant to reduce noise and variability</span></span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a>  averaged_data <span class="ot">&lt;-</span> single_subset <span class="sc">%&gt;%</span></span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(participant, time) <span class="sc">%&gt;%</span></span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb53-34"><a href="#cb53-34" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Calculate mean for muscle activation and force across trials</span></span>
<span id="cb53-35"><a href="#cb53-35" aria-hidden="true" tabindex="-1"></a>      <span class="fu">across</span>(<span class="fu">all_of</span>(<span class="fu">c</span>(muscle_name, <span class="st">"force"</span>)), <span class="sc">~</span><span class="fu">mean</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.names =</span> <span class="st">"avg_{.col}"</span>),</span>
<span id="cb53-36"><a href="#cb53-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb53-37"><a href="#cb53-37" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb53-38"><a href="#cb53-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-39"><a href="#cb53-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract group information for each participant (for later analysis)</span></span>
<span id="cb53-40"><a href="#cb53-40" aria-hidden="true" tabindex="-1"></a>  participant_groups <span class="ot">&lt;-</span> single_subset <span class="sc">%&gt;%</span></span>
<span id="cb53-41"><a href="#cb53-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(participant) <span class="sc">%&gt;%</span></span>
<span id="cb53-42"><a href="#cb53-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">group =</span> <span class="fu">first</span>(group), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-43"><a href="#cb53-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">distinct</span>()</span>
<span id="cb53-44"><a href="#cb53-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-45"><a href="#cb53-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Join group information to the averaged data for complete dataset</span></span>
<span id="cb53-46"><a href="#cb53-46" aria-hidden="true" tabindex="-1"></a>  averaged_data <span class="ot">&lt;-</span> averaged_data <span class="sc">%&gt;%</span></span>
<span id="cb53-47"><a href="#cb53-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(participant_groups, <span class="at">by =</span> <span class="st">"participant"</span>)</span>
<span id="cb53-48"><a href="#cb53-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-49"><a href="#cb53-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract time series for each participant (these will be clustered)</span></span>
<span id="cb53-50"><a href="#cb53-50" aria-hidden="true" tabindex="-1"></a>  muscle_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"avg_"</span>, muscle_name)</span>
<span id="cb53-51"><a href="#cb53-51" aria-hidden="true" tabindex="-1"></a>  muscle_series_list <span class="ot">&lt;-</span> averaged_data <span class="sc">%&gt;%</span></span>
<span id="cb53-52"><a href="#cb53-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(participant) <span class="sc">%&gt;%</span></span>
<span id="cb53-53"><a href="#cb53-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(time) <span class="sc">%&gt;%</span>  <span class="co"># Ensure time order is preserved</span></span>
<span id="cb53-54"><a href="#cb53-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">series =</span> <span class="fu">list</span>(<span class="sc">!!</span><span class="fu">sym</span>(muscle_col)), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-55"><a href="#cb53-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(series)</span>
<span id="cb53-56"><a href="#cb53-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-57"><a href="#cb53-57" aria-hidden="true" tabindex="-1"></a>  <span class="co"># WCSS METHOD</span></span>
<span id="cb53-58"><a href="#cb53-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Special case: Calculate WCSS for k=1 (not handled by clustering algorithm)</span></span>
<span id="cb53-59"><a href="#cb53-59" aria-hidden="true" tabindex="-1"></a>  all_values <span class="ot">&lt;-</span> <span class="fu">do.call</span>(cbind, muscle_series_list)</span>
<span id="cb53-60"><a href="#cb53-60" aria-hidden="true" tabindex="-1"></a>  mean_series <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(all_values, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb53-61"><a href="#cb53-61" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-62"><a href="#cb53-62" aria-hidden="true" tabindex="-1"></a>  <span class="co"># For k=1, WCSS is sum of squared distances from each point to the overall mean</span></span>
<span id="cb53-63"><a href="#cb53-63" aria-hidden="true" tabindex="-1"></a>  wcss_k1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">apply</span>(all_values, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">sum</span>((x <span class="sc">-</span> mean_series)<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb53-64"><a href="#cb53-64" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-65"><a href="#cb53-65" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define range of k values to evaluate (starting from k=2)</span></span>
<span id="cb53-66"><a href="#cb53-66" aria-hidden="true" tabindex="-1"></a>  k_range <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span>max_k</span>
<span id="cb53-67"><a href="#cb53-67" aria-hidden="true" tabindex="-1"></a>  wcss_values <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(k_range))</span>
<span id="cb53-68"><a href="#cb53-68" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-69"><a href="#cb53-69" aria-hidden="true" tabindex="-1"></a>  <span class="co"># SILHOUTTE SCORES</span></span>
<span id="cb53-70"><a href="#cb53-70" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialize storage for silhouette scores (+1 to include k=1)</span></span>
<span id="cb53-71"><a href="#cb53-71" aria-hidden="true" tabindex="-1"></a>  sil_values <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(k_range) <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb53-72"><a href="#cb53-72" aria-hidden="true" tabindex="-1"></a>  sil_values[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span>  <span class="co"># Set k=1 silhouette to 0 (not defined for single cluster)</span></span>
<span id="cb53-73"><a href="#cb53-73" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-74"><a href="#cb53-74" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create distance matrix for silhouette calculation using DTW</span></span>
<span id="cb53-75"><a href="#cb53-75" aria-hidden="true" tabindex="-1"></a>  dist_matrix <span class="ot">&lt;-</span> proxy<span class="sc">::</span><span class="fu">dist</span>(muscle_series_list, <span class="at">method =</span> <span class="st">"dtw"</span>)</span>
<span id="cb53-76"><a href="#cb53-76" aria-hidden="true" tabindex="-1"></a>  dist_matrix <span class="ot">&lt;-</span> <span class="fu">as.dist</span>(<span class="fu">as.matrix</span>(dist_matrix))</span>
<span id="cb53-77"><a href="#cb53-77" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-78"><a href="#cb53-78" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Loop for 1:k range clusters</span></span>
<span id="cb53-79"><a href="#cb53-79" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(k_range)) {</span>
<span id="cb53-80"><a href="#cb53-80" aria-hidden="true" tabindex="-1"></a>    k_val <span class="ot">&lt;-</span> k_range[i]</span>
<span id="cb53-81"><a href="#cb53-81" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># Set seed for reproducibility</span></span>
<span id="cb53-82"><a href="#cb53-82" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb53-83"><a href="#cb53-83" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Perform k-shape clustering (shape-based distance, appropriate for time series)</span></span>
<span id="cb53-84"><a href="#cb53-84" aria-hidden="true" tabindex="-1"></a>    temp_clust <span class="ot">&lt;-</span> <span class="fu">tsclust</span>(muscle_series_list, </span>
<span id="cb53-85"><a href="#cb53-85" aria-hidden="true" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">"partitional"</span>,</span>
<span id="cb53-86"><a href="#cb53-86" aria-hidden="true" tabindex="-1"></a>                         <span class="at">k =</span> k_val, </span>
<span id="cb53-87"><a href="#cb53-87" aria-hidden="true" tabindex="-1"></a>                         <span class="at">distance =</span> <span class="st">"sbd"</span>,  <span class="co"># Shape-based distance</span></span>
<span id="cb53-88"><a href="#cb53-88" aria-hidden="true" tabindex="-1"></a>                         <span class="at">centroid =</span> <span class="st">"shape"</span>,</span>
<span id="cb53-89"><a href="#cb53-89" aria-hidden="true" tabindex="-1"></a>                         <span class="at">control =</span> <span class="fu">partitional_control</span>(<span class="at">nrep =</span> <span class="dv">1</span>))</span>
<span id="cb53-90"><a href="#cb53-90" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb53-91"><a href="#cb53-91" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate WCSS</span></span>
<span id="cb53-92"><a href="#cb53-92" aria-hidden="true" tabindex="-1"></a>    centroids <span class="ot">&lt;-</span> temp_clust<span class="sc">@</span>centroids</span>
<span id="cb53-93"><a href="#cb53-93" aria-hidden="true" tabindex="-1"></a>    clusters <span class="ot">&lt;-</span> temp_clust<span class="sc">@</span>cluster</span>
<span id="cb53-94"><a href="#cb53-94" aria-hidden="true" tabindex="-1"></a>    wcss <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb53-95"><a href="#cb53-95" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb53-96"><a href="#cb53-96" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate sum of squared distances from each point to its assigned centroid</span></span>
<span id="cb53-97"><a href="#cb53-97" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(muscle_series_list)) {</span>
<span id="cb53-98"><a href="#cb53-98" aria-hidden="true" tabindex="-1"></a>      cluster_id <span class="ot">&lt;-</span> clusters[j]</span>
<span id="cb53-99"><a href="#cb53-99" aria-hidden="true" tabindex="-1"></a>      centroid <span class="ot">&lt;-</span> centroids[[cluster_id]]</span>
<span id="cb53-100"><a href="#cb53-100" aria-hidden="true" tabindex="-1"></a>      ts <span class="ot">&lt;-</span> muscle_series_list[[j]]</span>
<span id="cb53-101"><a href="#cb53-101" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb53-102"><a href="#cb53-102" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Use DTW distance (appropriate for time series) and square it</span></span>
<span id="cb53-103"><a href="#cb53-103" aria-hidden="true" tabindex="-1"></a>      dist_sq <span class="ot">&lt;-</span> proxy<span class="sc">::</span><span class="fu">dist</span>(<span class="fu">matrix</span>(ts, <span class="at">ncol=</span><span class="dv">1</span>), <span class="fu">matrix</span>(centroid, <span class="at">ncol=</span><span class="dv">1</span>), <span class="at">method=</span><span class="st">"dtw"</span>)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb53-104"><a href="#cb53-104" aria-hidden="true" tabindex="-1"></a>      wcss <span class="ot">&lt;-</span> wcss <span class="sc">+</span> dist_sq</span>
<span id="cb53-105"><a href="#cb53-105" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb53-106"><a href="#cb53-106" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb53-107"><a href="#cb53-107" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Store WCSS for this k value</span></span>
<span id="cb53-108"><a href="#cb53-108" aria-hidden="true" tabindex="-1"></a>    wcss_values[i] <span class="ot">&lt;-</span> wcss</span>
<span id="cb53-109"><a href="#cb53-109" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb53-110"><a href="#cb53-110" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate silhoutte scores</span></span>
<span id="cb53-111"><a href="#cb53-111" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Only applicable for k &gt; 1 (silhouette not defined for single cluster)</span></span>
<span id="cb53-112"><a href="#cb53-112" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (k_val <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb53-113"><a href="#cb53-113" aria-hidden="true" tabindex="-1"></a>      sil <span class="ot">&lt;-</span> <span class="fu">silhouette</span>(temp_clust<span class="sc">@</span>cluster, dist_matrix)</span>
<span id="cb53-114"><a href="#cb53-114" aria-hidden="true" tabindex="-1"></a>      sil_values[i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(sil[, <span class="st">"sil_width"</span>])</span>
<span id="cb53-115"><a href="#cb53-115" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb53-116"><a href="#cb53-116" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb53-117"><a href="#cb53-117" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-118"><a href="#cb53-118" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Prepare results</span></span>
<span id="cb53-119"><a href="#cb53-119" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine k=1 with other k values for WCSS plotting</span></span>
<span id="cb53-120"><a href="#cb53-120" aria-hidden="true" tabindex="-1"></a>  elbow_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">k =</span> <span class="fu">c</span>(<span class="dv">1</span>, k_range), <span class="at">wcss =</span> <span class="fu">c</span>(wcss_k1, wcss_values))</span>
<span id="cb53-121"><a href="#cb53-121" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-122"><a href="#cb53-122" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate percentage improvement from k to k+1 for WCSS</span></span>
<span id="cb53-123"><a href="#cb53-123" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This helps identify the "elbow point" where adding more clusters gives diminishing returns</span></span>
<span id="cb53-124"><a href="#cb53-124" aria-hidden="true" tabindex="-1"></a>  elbow_df<span class="sc">$</span>improvement <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="fu">diff</span>(<span class="sc">-</span>elbow_df<span class="sc">$</span>wcss) <span class="sc">/</span> elbow_df<span class="sc">$</span>wcss[<span class="sc">-</span><span class="fu">length</span>(elbow_df<span class="sc">$</span>wcss)])</span>
<span id="cb53-125"><a href="#cb53-125" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-126"><a href="#cb53-126" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create silhouette dataframe (k=1 to k=max_k, with k=1 having silhouette of 0)</span></span>
<span id="cb53-127"><a href="#cb53-127" aria-hidden="true" tabindex="-1"></a>  silhouette_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb53-128"><a href="#cb53-128" aria-hidden="true" tabindex="-1"></a>    <span class="at">k =</span> <span class="dv">1</span><span class="sc">:</span>max_k,</span>
<span id="cb53-129"><a href="#cb53-129" aria-hidden="true" tabindex="-1"></a>    <span class="at">silhouette =</span> sil_values</span>
<span id="cb53-130"><a href="#cb53-130" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb53-131"><a href="#cb53-131" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-132"><a href="#cb53-132" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot elbow plots</span></span>
<span id="cb53-133"><a href="#cb53-133" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(elbow_df, <span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> wcss)) <span class="sc">+</span></span>
<span id="cb53-134"><a href="#cb53-134" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb53-135"><a href="#cb53-135" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb53-136"><a href="#cb53-136" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">"Elbow Method for Optimal Cluster Count: "</span>, <span class="fu">toupper</span>(muscle_name), <span class="st">" "</span>, force_level, <span class="st">"% MVC"</span>),</span>
<span id="cb53-137"><a href="#cb53-137" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Number of Clusters (k)"</span>,</span>
<span id="cb53-138"><a href="#cb53-138" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Within-Cluster Sum of Squares (WCSS)"</span>) <span class="sc">+</span></span>
<span id="cb53-139"><a href="#cb53-139" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb53-140"><a href="#cb53-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(p1)</span>
<span id="cb53-141"><a href="#cb53-141" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-142"><a href="#cb53-142" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ----- PRINT RESULTS -----</span></span>
<span id="cb53-143"><a href="#cb53-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Silhouette Method Results:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb53-144"><a href="#cb53-144" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>max_k) {</span>
<span id="cb53-145"><a href="#cb53-145" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"k=%d, Silhouette = %.4f</span><span class="sc">\n</span><span class="st">"</span>, i, silhouette_df<span class="sc">$</span>silhouette[i]))</span>
<span id="cb53-146"><a href="#cb53-146" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb53-147"><a href="#cb53-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-148"><a href="#cb53-148" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-149"><a href="#cb53-149" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ----- RETURN RESULTS -----</span></span>
<span id="cb53-150"><a href="#cb53-150" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return comprehensive results including plots and preprocessed data</span></span>
<span id="cb53-151"><a href="#cb53-151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb53-152"><a href="#cb53-152" aria-hidden="true" tabindex="-1"></a>    <span class="at">elbow_data =</span> elbow_df,                     <span class="co"># WCSS values for each k</span></span>
<span id="cb53-153"><a href="#cb53-153" aria-hidden="true" tabindex="-1"></a>    <span class="at">silhouette_data =</span> silhouette_df,           <span class="co"># Silhouette scores for each k</span></span>
<span id="cb53-154"><a href="#cb53-154" aria-hidden="true" tabindex="-1"></a>    <span class="at">plots =</span> <span class="fu">list</span>(<span class="at">elbow_plot =</span> p1),             <span class="co"># Elbow plot for visualization</span></span>
<span id="cb53-155"><a href="#cb53-155" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb53-156"><a href="#cb53-156" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Include preprocessed data to avoid recalculation in subsequent analysis</span></span>
<span id="cb53-157"><a href="#cb53-157" aria-hidden="true" tabindex="-1"></a>    <span class="at">muscle_series_list =</span> muscle_series_list,   <span class="co"># Time series for clustering</span></span>
<span id="cb53-158"><a href="#cb53-158" aria-hidden="true" tabindex="-1"></a>    <span class="at">averaged_data =</span> averaged_data,             <span class="co"># Processed data with trial averaging</span></span>
<span id="cb53-159"><a href="#cb53-159" aria-hidden="true" tabindex="-1"></a>    <span class="at">participant_groups =</span> participant_groups    <span class="co"># Group assignments</span></span>
<span id="cb53-160"><a href="#cb53-160" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb53-161"><a href="#cb53-161" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run for all force levels</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>force_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"15"</span>, <span class="st">"35"</span>, <span class="st">"55"</span>, <span class="st">"70"</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>optimizations <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Run all optimizations for FDS</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (level <span class="cf">in</span> force_levels) {</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st">FDS at"</span>, level, <span class="st">"%:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  optimizations[[level]] <span class="ot">&lt;-</span> <span class="fu">determine_optimal_clusters</span>(</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> rms_data_for_R,</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">muscle_name =</span> <span class="st">"fds"</span>,</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">group_filter =</span> <span class="fu">c</span>(<span class="st">"strength"</span>, <span class="st">"dexterity"</span>),</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">force_level =</span> level</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>

FDS at 15 %:</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="statistical_analysis_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Silhouette Method Results:
k=2, Silhouette = 0.3124
k=3, Silhouette = 0.2021
k=4, Silhouette = -0.0553
k=5, Silhouette = -0.1472
k=6, Silhouette = -0.3096


FDS at 35 %:</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="statistical_analysis_files/figure-html/unnamed-chunk-47-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Silhouette Method Results:
k=2, Silhouette = 0.4424
k=3, Silhouette = 0.2997
k=4, Silhouette = 0.0957
k=5, Silhouette = -0.0756
k=6, Silhouette = -0.0517


FDS at 55 %:</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="statistical_analysis_files/figure-html/unnamed-chunk-47-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Silhouette Method Results:
k=2, Silhouette = 0.1006
k=3, Silhouette = -0.1699
k=4, Silhouette = 0.0637
k=5, Silhouette = -0.0971
k=6, Silhouette = -0.1586


FDS at 70 %:</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="statistical_analysis_files/figure-html/unnamed-chunk-47-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Silhouette Method Results:
k=2, Silhouette = 0.2064
k=3, Silhouette = 0.2229
k=4, Silhouette = 0.0968
k=5, Silhouette = -0.0698
k=6, Silhouette = -0.0534</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Run all optimizations for APB</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (level <span class="cf">in</span> force_levels) {</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st">Running optimization for APB muscle at force level"</span>, level, <span class="st">"%</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  optimizations[[level]] <span class="ot">&lt;-</span> <span class="fu">determine_optimal_clusters</span>(</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> rms_data_for_R,</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">muscle_name =</span> <span class="st">"apb"</span>,</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">group_filter =</span> <span class="fu">c</span>(<span class="st">"strength"</span>, <span class="st">"dexterity"</span>),</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">force_level =</span> level</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>

Running optimization for APB muscle at force level 15 %</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="statistical_analysis_files/figure-html/unnamed-chunk-47-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Silhouette Method Results:
k=2, Silhouette = 0.2017
k=3, Silhouette = 0.1935
k=4, Silhouette = 0.0783
k=5, Silhouette = 0.0583
k=6, Silhouette = 0.0439


Running optimization for APB muscle at force level 35 %</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="statistical_analysis_files/figure-html/unnamed-chunk-47-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Silhouette Method Results:
k=2, Silhouette = 0.4821
k=3, Silhouette = -0.0563
k=4, Silhouette = -0.0354
k=5, Silhouette = -0.0686
k=6, Silhouette = -0.1184


Running optimization for APB muscle at force level 55 %</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="statistical_analysis_files/figure-html/unnamed-chunk-47-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Silhouette Method Results:
k=2, Silhouette = 0.2268
k=3, Silhouette = -0.0006
k=4, Silhouette = 0.0146
k=5, Silhouette = -0.0689
k=6, Silhouette = -0.1540


Running optimization for APB muscle at force level 70 %</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="statistical_analysis_files/figure-html/unnamed-chunk-47-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Silhouette Method Results:
k=2, Silhouette = 0.0589
k=3, Silhouette = 0.0210
k=4, Silhouette = -0.0058
k=5, Silhouette = -0.0370
k=6, Silhouette = -0.0764</code></pre>
</div>
</div>
</section>
<section id="run-clustering-analysis-for-the-fds-at-15-and-35-mvc" class="level4">
<h4 class="anchored" data-anchor-id="run-clustering-analysis-for-the-fds-at-15-and-35-mvc">Run clustering analysis for the FDS at 15% and 35% MVC</h4>
<div class="cell">
<details class="code-fold">
<summary>Show function for running clustering analysis</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FUNCTION: analyze_muscle_clusters</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Performs k-shape clustering analysis on muscle activation data</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Inputs:</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="co"># - data: Dataframe containing muscle activation data (must include columns: participant,</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="co">#         group, forcelevel, time, force, and the specified muscle_name)</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="co"># - muscle_name: Name of the muscle column to analyze ("fds", "apb")</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a><span class="co"># - group_filter: Vector of group names to include (c("strength", "dexterity"))</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a><span class="co"># - force_levels: Vector of force levels to analyze (e.g., c("15", "35"))</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a><span class="co"># - k_values: Number of clusters for k-shape clustering (can be single value or named vector)</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Outputs: List containing clustering results for each force level</span></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>analyze_muscle_clusters <span class="ot">&lt;-</span> <span class="cf">function</span>(data, muscle_name, group_filter, force_levels, k_values) {</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Handle k_values input - if single value, apply to all force levels</span></span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(k_values) <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>    k_vals <span class="ot">&lt;-</span> <span class="fu">rep</span>(k_values, <span class="fu">length</span>(force_levels))</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(k_vals) <span class="ot">&lt;-</span> force_levels</span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span>(<span class="fu">is.null</span>(<span class="fu">names</span>(k_values))) {</span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(k_values) <span class="ot">&lt;-</span> force_levels</span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>    k_vals <span class="ot">&lt;-</span> k_values</span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>    k_vals <span class="ot">&lt;-</span> k_values</span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Container for results</span></span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a>  results_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-30"><a href="#cb66-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Process each force level</span></span>
<span id="cb66-31"><a href="#cb66-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(level <span class="cf">in</span> force_levels) {</span>
<span id="cb66-32"><a href="#cb66-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Analyzing"</span>, muscle_name, <span class="st">"at force level"</span>, level, <span class="st">"% with k ="</span>, k_vals[level], <span class="st">"===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb66-33"><a href="#cb66-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb66-34"><a href="#cb66-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 1: Filter data for the specified group and force level</span></span>
<span id="cb66-35"><a href="#cb66-35" aria-hidden="true" tabindex="-1"></a>    single_subset <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb66-36"><a href="#cb66-36" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(group <span class="sc">%in%</span> group_filter, forcelevel <span class="sc">==</span> level)</span>
<span id="cb66-37"><a href="#cb66-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb66-38"><a href="#cb66-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 2: Average trials for each participant</span></span>
<span id="cb66-39"><a href="#cb66-39" aria-hidden="true" tabindex="-1"></a>    averaged_data <span class="ot">&lt;-</span> single_subset <span class="sc">%&gt;%</span></span>
<span id="cb66-40"><a href="#cb66-40" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(participant, time) <span class="sc">%&gt;%</span></span>
<span id="cb66-41"><a href="#cb66-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarise</span>(</span>
<span id="cb66-42"><a href="#cb66-42" aria-hidden="true" tabindex="-1"></a>        <span class="fu">across</span>(<span class="fu">all_of</span>(<span class="fu">c</span>(muscle_name, <span class="st">"force"</span>)), <span class="sc">~</span><span class="fu">mean</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.names =</span> <span class="st">"avg_{.col}"</span>),</span>
<span id="cb66-43"><a href="#cb66-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb66-44"><a href="#cb66-44" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb66-45"><a href="#cb66-45" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb66-46"><a href="#cb66-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 3: Get group information for each participant</span></span>
<span id="cb66-47"><a href="#cb66-47" aria-hidden="true" tabindex="-1"></a>    participant_groups <span class="ot">&lt;-</span> single_subset <span class="sc">%&gt;%</span></span>
<span id="cb66-48"><a href="#cb66-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(participant) <span class="sc">%&gt;%</span></span>
<span id="cb66-49"><a href="#cb66-49" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarise</span>(<span class="at">group =</span> <span class="fu">first</span>(group), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb66-50"><a href="#cb66-50" aria-hidden="true" tabindex="-1"></a>      <span class="fu">distinct</span>()</span>
<span id="cb66-51"><a href="#cb66-51" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb66-52"><a href="#cb66-52" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Join the group information to the averaged data</span></span>
<span id="cb66-53"><a href="#cb66-53" aria-hidden="true" tabindex="-1"></a>    averaged_data <span class="ot">&lt;-</span> averaged_data <span class="sc">%&gt;%</span></span>
<span id="cb66-54"><a href="#cb66-54" aria-hidden="true" tabindex="-1"></a>      <span class="fu">left_join</span>(participant_groups, <span class="at">by =</span> <span class="st">"participant"</span>)</span>
<span id="cb66-55"><a href="#cb66-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb66-56"><a href="#cb66-56" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 4: Extract the muscle time series for clustering</span></span>
<span id="cb66-57"><a href="#cb66-57" aria-hidden="true" tabindex="-1"></a>    muscle_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"avg_"</span>, muscle_name)</span>
<span id="cb66-58"><a href="#cb66-58" aria-hidden="true" tabindex="-1"></a>    muscle_series_list <span class="ot">&lt;-</span> averaged_data <span class="sc">%&gt;%</span></span>
<span id="cb66-59"><a href="#cb66-59" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(participant) <span class="sc">%&gt;%</span></span>
<span id="cb66-60"><a href="#cb66-60" aria-hidden="true" tabindex="-1"></a>      <span class="fu">arrange</span>(time) <span class="sc">%&gt;%</span></span>
<span id="cb66-61"><a href="#cb66-61" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarise</span>(<span class="at">series =</span> <span class="fu">list</span>(<span class="sc">!!</span><span class="fu">sym</span>(muscle_col)), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb66-62"><a href="#cb66-62" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pull</span>(series)</span>
<span id="cb66-63"><a href="#cb66-63" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb66-64"><a href="#cb66-64" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 5: Perform k-shape clustering</span></span>
<span id="cb66-65"><a href="#cb66-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># For reproducibility</span></span>
<span id="cb66-66"><a href="#cb66-66" aria-hidden="true" tabindex="-1"></a>    kshape_result <span class="ot">&lt;-</span> <span class="fu">tsclust</span>(muscle_series_list, </span>
<span id="cb66-67"><a href="#cb66-67" aria-hidden="true" tabindex="-1"></a>                           <span class="at">type =</span> <span class="st">"partitional"</span>,</span>
<span id="cb66-68"><a href="#cb66-68" aria-hidden="true" tabindex="-1"></a>                           <span class="at">k =</span> k_vals[level], </span>
<span id="cb66-69"><a href="#cb66-69" aria-hidden="true" tabindex="-1"></a>                           <span class="at">distance =</span> <span class="st">"sbd"</span>,  <span class="co"># Shape-based distance</span></span>
<span id="cb66-70"><a href="#cb66-70" aria-hidden="true" tabindex="-1"></a>                           <span class="at">centroid =</span> <span class="st">"shape"</span>,</span>
<span id="cb66-71"><a href="#cb66-71" aria-hidden="true" tabindex="-1"></a>                           <span class="at">control =</span> <span class="fu">partitional_control</span>(<span class="at">nrep =</span> <span class="dv">1</span>))</span>
<span id="cb66-72"><a href="#cb66-72" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb66-73"><a href="#cb66-73" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 6: Get cluster assignments and create mapping</span></span>
<span id="cb66-74"><a href="#cb66-74" aria-hidden="true" tabindex="-1"></a>    cluster_assignments <span class="ot">&lt;-</span> kshape_result<span class="sc">@</span>cluster</span>
<span id="cb66-75"><a href="#cb66-75" aria-hidden="true" tabindex="-1"></a>    participant_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb66-76"><a href="#cb66-76" aria-hidden="true" tabindex="-1"></a>      <span class="at">participant =</span> <span class="fu">unique</span>(averaged_data<span class="sc">$</span>participant)[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(cluster_assignments)],</span>
<span id="cb66-77"><a href="#cb66-77" aria-hidden="true" tabindex="-1"></a>      <span class="at">cluster =</span> cluster_assignments</span>
<span id="cb66-78"><a href="#cb66-78" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb66-79"><a href="#cb66-79" aria-hidden="true" tabindex="-1"></a>      <span class="fu">left_join</span>(participant_groups, <span class="at">by =</span> <span class="st">"participant"</span>)</span>
<span id="cb66-80"><a href="#cb66-80" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb66-81"><a href="#cb66-81" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 7: Join cluster information back to averaged data</span></span>
<span id="cb66-82"><a href="#cb66-82" aria-hidden="true" tabindex="-1"></a>    clustered_data <span class="ot">&lt;-</span> averaged_data <span class="sc">%&gt;%</span></span>
<span id="cb66-83"><a href="#cb66-83" aria-hidden="true" tabindex="-1"></a>      <span class="fu">left_join</span>(participant_df, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"participant"</span>, <span class="st">"group"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb66-84"><a href="#cb66-84" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">forcelevel =</span> level)</span>
<span id="cb66-85"><a href="#cb66-85" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb66-86"><a href="#cb66-86" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 8: Create centroids dataframe</span></span>
<span id="cb66-87"><a href="#cb66-87" aria-hidden="true" tabindex="-1"></a>    centroids <span class="ot">&lt;-</span> kshape_result<span class="sc">@</span>centroids</span>
<span id="cb66-88"><a href="#cb66-88" aria-hidden="true" tabindex="-1"></a>    time_points <span class="ot">&lt;-</span> clustered_data <span class="sc">%&gt;%</span></span>
<span id="cb66-89"><a href="#cb66-89" aria-hidden="true" tabindex="-1"></a>      <span class="fu">arrange</span>(time) <span class="sc">%&gt;%</span></span>
<span id="cb66-90"><a href="#cb66-90" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pull</span>(time) <span class="sc">%&gt;%</span></span>
<span id="cb66-91"><a href="#cb66-91" aria-hidden="true" tabindex="-1"></a>      <span class="fu">unique</span>()</span>
<span id="cb66-92"><a href="#cb66-92" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb66-93"><a href="#cb66-93" aria-hidden="true" tabindex="-1"></a>    centroids_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb66-94"><a href="#cb66-94" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_vals[level]) {</span>
<span id="cb66-95"><a href="#cb66-95" aria-hidden="true" tabindex="-1"></a>      centroid <span class="ot">&lt;-</span> centroids[[i]]</span>
<span id="cb66-96"><a href="#cb66-96" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb66-97"><a href="#cb66-97" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Handle length mismatch with interpolation if needed</span></span>
<span id="cb66-98"><a href="#cb66-98" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">length</span>(centroid) <span class="sc">!=</span> <span class="fu">length</span>(time_points)) {</span>
<span id="cb66-99"><a href="#cb66-99" aria-hidden="true" tabindex="-1"></a>        approx_fn <span class="ot">&lt;-</span> <span class="fu">approx</span>(<span class="at">x =</span> <span class="fu">seq_along</span>(centroid), </span>
<span id="cb66-100"><a href="#cb66-100" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y =</span> centroid, </span>
<span id="cb66-101"><a href="#cb66-101" aria-hidden="true" tabindex="-1"></a>                          <span class="at">xout =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">length</span>(centroid), <span class="at">length.out =</span> <span class="fu">length</span>(time_points)))</span>
<span id="cb66-102"><a href="#cb66-102" aria-hidden="true" tabindex="-1"></a>        centroid_values <span class="ot">&lt;-</span> approx_fn<span class="sc">$</span>y</span>
<span id="cb66-103"><a href="#cb66-103" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb66-104"><a href="#cb66-104" aria-hidden="true" tabindex="-1"></a>        centroid_values <span class="ot">&lt;-</span> centroid</span>
<span id="cb66-105"><a href="#cb66-105" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb66-106"><a href="#cb66-106" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb66-107"><a href="#cb66-107" aria-hidden="true" tabindex="-1"></a>      temp_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb66-108"><a href="#cb66-108" aria-hidden="true" tabindex="-1"></a>        <span class="at">time =</span> time_points,</span>
<span id="cb66-109"><a href="#cb66-109" aria-hidden="true" tabindex="-1"></a>        <span class="at">value =</span> centroid_values,</span>
<span id="cb66-110"><a href="#cb66-110" aria-hidden="true" tabindex="-1"></a>        <span class="at">cluster =</span> i,</span>
<span id="cb66-111"><a href="#cb66-111" aria-hidden="true" tabindex="-1"></a>        <span class="at">forcelevel =</span> level</span>
<span id="cb66-112"><a href="#cb66-112" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb66-113"><a href="#cb66-113" aria-hidden="true" tabindex="-1"></a>      centroids_df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(centroids_df, temp_df)</span>
<span id="cb66-114"><a href="#cb66-114" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb66-115"><a href="#cb66-115" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb66-116"><a href="#cb66-116" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 9: Calculate scaled centroids</span></span>
<span id="cb66-117"><a href="#cb66-117" aria-hidden="true" tabindex="-1"></a>    cluster_stats <span class="ot">&lt;-</span> clustered_data <span class="sc">%&gt;%</span></span>
<span id="cb66-118"><a href="#cb66-118" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(cluster) <span class="sc">%&gt;%</span></span>
<span id="cb66-119"><a href="#cb66-119" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarise</span>(</span>
<span id="cb66-120"><a href="#cb66-120" aria-hidden="true" tabindex="-1"></a>        <span class="at">mean_val =</span> <span class="fu">mean</span>(<span class="sc">!!</span><span class="fu">sym</span>(muscle_col), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb66-121"><a href="#cb66-121" aria-hidden="true" tabindex="-1"></a>        <span class="at">sd_val =</span> <span class="fu">sd</span>(<span class="sc">!!</span><span class="fu">sym</span>(muscle_col), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb66-122"><a href="#cb66-122" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb66-123"><a href="#cb66-123" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb66-124"><a href="#cb66-124" aria-hidden="true" tabindex="-1"></a>    centroids_scaled <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb66-125"><a href="#cb66-125" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_vals[level]) {</span>
<span id="cb66-126"><a href="#cb66-126" aria-hidden="true" tabindex="-1"></a>      cluster_centroid <span class="ot">&lt;-</span> centroids_df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(cluster <span class="sc">==</span> i)</span>
<span id="cb66-127"><a href="#cb66-127" aria-hidden="true" tabindex="-1"></a>      cluster_stat <span class="ot">&lt;-</span> cluster_stats <span class="sc">%&gt;%</span> <span class="fu">filter</span>(cluster <span class="sc">==</span> i)</span>
<span id="cb66-128"><a href="#cb66-128" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb66-129"><a href="#cb66-129" aria-hidden="true" tabindex="-1"></a>      centroid_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(cluster_centroid<span class="sc">$</span>value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb66-130"><a href="#cb66-130" aria-hidden="true" tabindex="-1"></a>      centroid_sd <span class="ot">&lt;-</span> <span class="fu">sd</span>(cluster_centroid<span class="sc">$</span>value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb66-131"><a href="#cb66-131" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb66-132"><a href="#cb66-132" aria-hidden="true" tabindex="-1"></a>      scaled_values <span class="ot">&lt;-</span> cluster_centroid<span class="sc">$</span>value</span>
<span id="cb66-133"><a href="#cb66-133" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (centroid_sd <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb66-134"><a href="#cb66-134" aria-hidden="true" tabindex="-1"></a>        scaled_values <span class="ot">&lt;-</span> ((scaled_values <span class="sc">-</span> centroid_mean) <span class="sc">/</span> centroid_sd) <span class="sc">*</span> </span>
<span id="cb66-135"><a href="#cb66-135" aria-hidden="true" tabindex="-1"></a>                        cluster_stat<span class="sc">$</span>sd_val <span class="sc">+</span> cluster_stat<span class="sc">$</span>mean_val</span>
<span id="cb66-136"><a href="#cb66-136" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb66-137"><a href="#cb66-137" aria-hidden="true" tabindex="-1"></a>        scaled_values <span class="ot">&lt;-</span> <span class="fu">rep</span>(cluster_stat<span class="sc">$</span>mean_val, <span class="fu">length</span>(scaled_values))</span>
<span id="cb66-138"><a href="#cb66-138" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb66-139"><a href="#cb66-139" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb66-140"><a href="#cb66-140" aria-hidden="true" tabindex="-1"></a>      temp_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb66-141"><a href="#cb66-141" aria-hidden="true" tabindex="-1"></a>        <span class="at">time =</span> cluster_centroid<span class="sc">$</span>time,</span>
<span id="cb66-142"><a href="#cb66-142" aria-hidden="true" tabindex="-1"></a>        <span class="at">value =</span> scaled_values,</span>
<span id="cb66-143"><a href="#cb66-143" aria-hidden="true" tabindex="-1"></a>        <span class="at">cluster =</span> i,</span>
<span id="cb66-144"><a href="#cb66-144" aria-hidden="true" tabindex="-1"></a>        <span class="at">forcelevel =</span> level</span>
<span id="cb66-145"><a href="#cb66-145" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb66-146"><a href="#cb66-146" aria-hidden="true" tabindex="-1"></a>      centroids_scaled <span class="ot">&lt;-</span> <span class="fu">rbind</span>(centroids_scaled, temp_df)</span>
<span id="cb66-147"><a href="#cb66-147" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb66-148"><a href="#cb66-148" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb66-149"><a href="#cb66-149" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 10: Summarize results</span></span>
<span id="cb66-150"><a href="#cb66-150" aria-hidden="true" tabindex="-1"></a>    participant_clusters <span class="ot">&lt;-</span> participant_df <span class="sc">%&gt;%</span></span>
<span id="cb66-151"><a href="#cb66-151" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(cluster) <span class="sc">%&gt;%</span></span>
<span id="cb66-152"><a href="#cb66-152" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarise</span>(</span>
<span id="cb66-153"><a href="#cb66-153" aria-hidden="true" tabindex="-1"></a>        <span class="at">participants =</span> <span class="fu">paste</span>(participant, <span class="at">collapse =</span> <span class="st">", "</span>),</span>
<span id="cb66-154"><a href="#cb66-154" aria-hidden="true" tabindex="-1"></a>        <span class="at">count =</span> <span class="fu">n</span>()</span>
<span id="cb66-155"><a href="#cb66-155" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb66-156"><a href="#cb66-156" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb66-157"><a href="#cb66-157" aria-hidden="true" tabindex="-1"></a>    group_by_cluster <span class="ot">&lt;-</span> participant_df <span class="sc">%&gt;%</span></span>
<span id="cb66-158"><a href="#cb66-158" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(cluster, group) <span class="sc">%&gt;%</span></span>
<span id="cb66-159"><a href="#cb66-159" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb66-160"><a href="#cb66-160" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> group, <span class="at">values_from =</span> count, <span class="at">values_fill =</span> <span class="dv">0</span>)</span>
<span id="cb66-161"><a href="#cb66-161" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb66-162"><a href="#cb66-162" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Print results for this force level</span></span>
<span id="cb66-163"><a href="#cb66-163" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Cluster assignments:"</span>, cluster_assignments, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb66-164"><a href="#cb66-164" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(participant_clusters)</span>
<span id="cb66-165"><a href="#cb66-165" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(group_by_cluster)</span>
<span id="cb66-166"><a href="#cb66-166" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb66-167"><a href="#cb66-167" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Store results</span></span>
<span id="cb66-168"><a href="#cb66-168" aria-hidden="true" tabindex="-1"></a>    results_list[[level]] <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb66-169"><a href="#cb66-169" aria-hidden="true" tabindex="-1"></a>      <span class="at">kshape_result =</span> kshape_result,</span>
<span id="cb66-170"><a href="#cb66-170" aria-hidden="true" tabindex="-1"></a>      <span class="at">clustered_data =</span> clustered_data,</span>
<span id="cb66-171"><a href="#cb66-171" aria-hidden="true" tabindex="-1"></a>      <span class="at">centroids_original =</span> centroids_df,</span>
<span id="cb66-172"><a href="#cb66-172" aria-hidden="true" tabindex="-1"></a>      <span class="at">centroids_scaled =</span> centroids_scaled,</span>
<span id="cb66-173"><a href="#cb66-173" aria-hidden="true" tabindex="-1"></a>      <span class="at">participant_clusters =</span> participant_clusters,</span>
<span id="cb66-174"><a href="#cb66-174" aria-hidden="true" tabindex="-1"></a>      <span class="at">group_by_cluster =</span> group_by_cluster,</span>
<span id="cb66-175"><a href="#cb66-175" aria-hidden="true" tabindex="-1"></a>      <span class="at">k_value =</span> k_vals[level]</span>
<span id="cb66-176"><a href="#cb66-176" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb66-177"><a href="#cb66-177" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb66-178"><a href="#cb66-178" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-179"><a href="#cb66-179" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(results_list)</span>
<span id="cb66-180"><a href="#cb66-180" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the clustering analysis</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>clustering_results <span class="ot">&lt;-</span> <span class="fu">analyze_muscle_clusters</span>(</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> rms_data_for_R,</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">muscle_name =</span> <span class="st">"fds"</span>,</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">group_filter =</span> <span class="fu">c</span>(<span class="st">"strength"</span>, <span class="st">"dexterity"</span>),</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">force_levels =</span> <span class="fu">c</span>(<span class="st">"15"</span>, <span class="st">"35"</span>),</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">k_values =</span> <span class="dv">2</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Analyzing fds at force level 15 % with k = 2 ===
Cluster assignments: 2 2 1 1 2 1 2 1 1 2 2 2 2 2 1 2 2 1 2 1 
# A tibble: 2 × 3
  cluster participants                               count
    &lt;int&gt; &lt;chr&gt;                                      &lt;int&gt;
1       1 3, 4, 6, 8, 9, 16, 19, 21                      8
2       2 1, 2, 5, 7, 10, 11, 12, 13, 14, 17, 18, 20    12
# A tibble: 2 × 3
  cluster strength dexterity
    &lt;int&gt;    &lt;int&gt;     &lt;int&gt;
1       1        6         2
2       2        4         8

=== Analyzing fds at force level 35 % with k = 2 ===
Cluster assignments: 1 1 1 1 2 1 2 1 1 2 2 2 1 2 1 2 1 1 1 1 
# A tibble: 2 × 3
  cluster participants                                count
    &lt;int&gt; &lt;chr&gt;                                       &lt;int&gt;
1       1 1, 2, 3, 4, 6, 8, 9, 13, 16, 18, 19, 20, 21    13
2       2 5, 7, 10, 11, 12, 14, 17                        7
# A tibble: 2 × 3
  cluster strength dexterity
    &lt;int&gt;    &lt;int&gt;     &lt;int&gt;
1       1        7         6
2       2        3         4</code></pre>
</div>
</div>
</section>
<section id="plotting-2" class="level4">
<h4 class="anchored" data-anchor-id="plotting-2">Plotting</h4>
<div class="cell">
<details class="code-fold">
<summary>Show function for plotting clustering analysis for the FDS at 15% and 35% MVC</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FUNCTION: plot_muscle_clusters</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Creates publication-ready plot for FDS muscle clusters at 35% force level</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Inputs:</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="co"># - analysis_results: Output from analyze_muscle_clusters()</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="co"># - muscle_name: Name of the muscle analyzed (should be "fds")</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="co"># - force_level: Force level to plot (should be "35")</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Outputs: ggplot object showing 2 clusters faceted by cluster (as rows)</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>plot_muscle_clusters <span class="ot">&lt;-</span> <span class="cf">function</span>(analysis_results, <span class="at">muscle_name =</span> <span class="st">"fds"</span>, <span class="at">force_level =</span> <span class="st">"35"</span>) {</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define color palette for experimental groups</span></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>  group_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"strength"</span> <span class="ot">=</span> <span class="st">"#fe9d5d"</span>, <span class="st">"dexterity"</span> <span class="ot">=</span> <span class="st">"#456990"</span>)</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Validate force level exists in analysis results</span></span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span>force_level <span class="sc">%in%</span> <span class="fu">names</span>(analysis_results)) {</span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="fu">paste</span>(<span class="st">"Force level"</span>, force_level, <span class="st">"not found in analysis results"</span>))</span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract results for specified force level</span></span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> analysis_results[[force_level]]</span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter to first 10 seconds</span></span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a>  result<span class="sc">$</span>clustered_data <span class="ot">&lt;-</span> result<span class="sc">$</span>clustered_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(time <span class="sc">&lt;=</span> <span class="dv">10</span>)</span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true" tabindex="-1"></a>  result<span class="sc">$</span>centroids_scaled <span class="ot">&lt;-</span> result<span class="sc">$</span>centroids_scaled <span class="sc">%&gt;%</span> <span class="fu">filter</span>(time <span class="sc">&lt;=</span> <span class="dv">10</span>)</span>
<span id="cb69-28"><a href="#cb69-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb69-29"><a href="#cb69-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Format cluster labels for display</span></span>
<span id="cb69-30"><a href="#cb69-30" aria-hidden="true" tabindex="-1"></a>  result<span class="sc">$</span>clustered_data<span class="sc">$</span>cluster <span class="ot">&lt;-</span> <span class="fu">factor</span>(result<span class="sc">$</span>clustered_data<span class="sc">$</span>cluster, </span>
<span id="cb69-31"><a href="#cb69-31" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">labels =</span> <span class="fu">paste</span>(<span class="st">"Cluster"</span>, <span class="dv">1</span><span class="sc">:</span>result<span class="sc">$</span>k_value))</span>
<span id="cb69-32"><a href="#cb69-32" aria-hidden="true" tabindex="-1"></a>  result<span class="sc">$</span>centroids_scaled<span class="sc">$</span>cluster <span class="ot">&lt;-</span> <span class="fu">factor</span>(result<span class="sc">$</span>centroids_scaled<span class="sc">$</span>cluster, </span>
<span id="cb69-33"><a href="#cb69-33" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">labels =</span> <span class="fu">paste</span>(<span class="st">"Cluster"</span>, <span class="dv">1</span><span class="sc">:</span>result<span class="sc">$</span>k_value))</span>
<span id="cb69-34"><a href="#cb69-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb69-35"><a href="#cb69-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create custom strip title combining muscle name and force levels</span></span>
<span id="cb69-36"><a href="#cb69-36" aria-hidden="true" tabindex="-1"></a>  strip_title <span class="ot">&lt;-</span> <span class="st">"FDS: 15% and 35% MVC"</span></span>
<span id="cb69-37"><a href="#cb69-37" aria-hidden="true" tabindex="-1"></a>  result<span class="sc">$</span>clustered_data<span class="sc">$</span>forcelevel <span class="ot">&lt;-</span> <span class="fu">factor</span>(result<span class="sc">$</span>clustered_data<span class="sc">$</span>forcelevel, </span>
<span id="cb69-38"><a href="#cb69-38" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">labels =</span> strip_title)</span>
<span id="cb69-39"><a href="#cb69-39" aria-hidden="true" tabindex="-1"></a>  result<span class="sc">$</span>centroids_scaled<span class="sc">$</span>forcelevel <span class="ot">&lt;-</span> <span class="fu">factor</span>(result<span class="sc">$</span>centroids_scaled<span class="sc">$</span>forcelevel, </span>
<span id="cb69-40"><a href="#cb69-40" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">labels =</span> strip_title)</span>
<span id="cb69-41"><a href="#cb69-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb69-42"><a href="#cb69-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate cluster-wise average force traces</span></span>
<span id="cb69-43"><a href="#cb69-43" aria-hidden="true" tabindex="-1"></a>  avg_force_data <span class="ot">&lt;-</span> result<span class="sc">$</span>clustered_data <span class="sc">%&gt;%</span></span>
<span id="cb69-44"><a href="#cb69-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(cluster, time) <span class="sc">%&gt;%</span></span>
<span id="cb69-45"><a href="#cb69-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">avg_force =</span> <span class="fu">mean</span>(avg_force, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb69-46"><a href="#cb69-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb69-47"><a href="#cb69-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply consistent force level labeling</span></span>
<span id="cb69-48"><a href="#cb69-48" aria-hidden="true" tabindex="-1"></a>  avg_force_data<span class="sc">$</span>forcelevel <span class="ot">&lt;-</span> <span class="fu">factor</span>(force_level, <span class="at">labels =</span> strip_title)</span>
<span id="cb69-49"><a href="#cb69-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb69-50"><a href="#cb69-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate muscle-specific column name</span></span>
<span id="cb69-51"><a href="#cb69-51" aria-hidden="true" tabindex="-1"></a>  muscle_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"avg_"</span>, muscle_name)</span>
<span id="cb69-52"><a href="#cb69-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb69-53"><a href="#cb69-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Determine EMG scaling parameters</span></span>
<span id="cb69-54"><a href="#cb69-54" aria-hidden="true" tabindex="-1"></a>  muscle_range <span class="ot">&lt;-</span> <span class="fu">range</span>(result<span class="sc">$</span>clustered_data[[muscle_col]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb69-55"><a href="#cb69-55" aria-hidden="true" tabindex="-1"></a>  muscle_min <span class="ot">&lt;-</span> muscle_range[<span class="dv">1</span>]</span>
<span id="cb69-56"><a href="#cb69-56" aria-hidden="true" tabindex="-1"></a>  muscle_max <span class="ot">&lt;-</span> muscle_range[<span class="dv">2</span>]</span>
<span id="cb69-57"><a href="#cb69-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb69-58"><a href="#cb69-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Normalize force data within each cluster (0-1 range)</span></span>
<span id="cb69-59"><a href="#cb69-59" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(cluster_level <span class="cf">in</span> <span class="fu">unique</span>(avg_force_data<span class="sc">$</span>cluster)) {</span>
<span id="cb69-60"><a href="#cb69-60" aria-hidden="true" tabindex="-1"></a>    subset_rows <span class="ot">&lt;-</span> avg_force_data<span class="sc">$</span>cluster <span class="sc">==</span> cluster_level</span>
<span id="cb69-61"><a href="#cb69-61" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb69-62"><a href="#cb69-62" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate cluster-specific force range</span></span>
<span id="cb69-63"><a href="#cb69-63" aria-hidden="true" tabindex="-1"></a>    current_force_range <span class="ot">&lt;-</span> <span class="fu">range</span>(avg_force_data<span class="sc">$</span>avg_force[subset_rows], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb69-64"><a href="#cb69-64" aria-hidden="true" tabindex="-1"></a>    current_force_min <span class="ot">&lt;-</span> current_force_range[<span class="dv">1</span>]</span>
<span id="cb69-65"><a href="#cb69-65" aria-hidden="true" tabindex="-1"></a>    current_force_max <span class="ot">&lt;-</span> current_force_range[<span class="dv">2</span>]</span>
<span id="cb69-66"><a href="#cb69-66" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb69-67"><a href="#cb69-67" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Apply normalization if range exists</span></span>
<span id="cb69-68"><a href="#cb69-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(current_force_max <span class="sc">&gt;</span> current_force_min) {</span>
<span id="cb69-69"><a href="#cb69-69" aria-hidden="true" tabindex="-1"></a>      avg_force_data<span class="sc">$</span>avg_force[subset_rows] <span class="ot">&lt;-</span> </span>
<span id="cb69-70"><a href="#cb69-70" aria-hidden="true" tabindex="-1"></a>        (avg_force_data<span class="sc">$</span>avg_force[subset_rows] <span class="sc">-</span> current_force_min) <span class="sc">/</span> </span>
<span id="cb69-71"><a href="#cb69-71" aria-hidden="true" tabindex="-1"></a>        (current_force_max <span class="sc">-</span> current_force_min)</span>
<span id="cb69-72"><a href="#cb69-72" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb69-73"><a href="#cb69-73" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb69-74"><a href="#cb69-74" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Constrain normalized values to [0,1] range</span></span>
<span id="cb69-75"><a href="#cb69-75" aria-hidden="true" tabindex="-1"></a>    avg_force_data<span class="sc">$</span>avg_force[subset_rows] <span class="ot">&lt;-</span> <span class="fu">pmin</span>(<span class="fu">pmax</span>(avg_force_data<span class="sc">$</span>avg_force[subset_rows], <span class="dv">0</span>), <span class="dv">1</span>)</span>
<span id="cb69-76"><a href="#cb69-76" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb69-77"><a href="#cb69-77" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb69-78"><a href="#cb69-78" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Scale force traces to match EMG amplitude range (75% of EMG range)</span></span>
<span id="cb69-79"><a href="#cb69-79" aria-hidden="true" tabindex="-1"></a>  scale_force <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb69-80"><a href="#cb69-80" aria-hidden="true" tabindex="-1"></a>    reduced_max <span class="ot">&lt;-</span> <span class="fl">0.75</span>  <span class="co"># Scale factor to prevent force trace overlap with EMG data</span></span>
<span id="cb69-81"><a href="#cb69-81" aria-hidden="true" tabindex="-1"></a>    x_reduced <span class="ot">&lt;-</span> x <span class="sc">*</span> reduced_max</span>
<span id="cb69-82"><a href="#cb69-82" aria-hidden="true" tabindex="-1"></a>    scaled <span class="ot">&lt;-</span> ((x_reduced <span class="sc">-</span> <span class="dv">0</span>) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="dv">0</span>)) <span class="sc">*</span> (muscle_max <span class="sc">-</span> muscle_min) <span class="sc">+</span> muscle_min</span>
<span id="cb69-83"><a href="#cb69-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(scaled)</span>
<span id="cb69-84"><a href="#cb69-84" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb69-85"><a href="#cb69-85" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb69-86"><a href="#cb69-86" aria-hidden="true" tabindex="-1"></a>  avg_force_data<span class="sc">$</span>scaled_force <span class="ot">&lt;-</span> <span class="fu">scale_force</span>(avg_force_data<span class="sc">$</span>avg_force)</span>
<span id="cb69-87"><a href="#cb69-87" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb69-88"><a href="#cb69-88" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate publication-ready plot</span></span>
<span id="cb69-89"><a href="#cb69-89" aria-hidden="true" tabindex="-1"></a>  pub_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb69-90"><a href="#cb69-90" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Individual participant EMG time series (colored by experimental group)</span></span>
<span id="cb69-91"><a href="#cb69-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> result<span class="sc">$</span>clustered_data, </span>
<span id="cb69-92"><a href="#cb69-92" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> <span class="sc">!!</span><span class="fu">sym</span>(muscle_col), </span>
<span id="cb69-93"><a href="#cb69-93" aria-hidden="true" tabindex="-1"></a>                <span class="at">group =</span> participant, <span class="at">color =</span> group), <span class="at">size =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb69-94"><a href="#cb69-94" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Cluster centroids (bold black lines)</span></span>
<span id="cb69-95"><a href="#cb69-95" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> result<span class="sc">$</span>centroids_scaled,</span>
<span id="cb69-96"><a href="#cb69-96" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> value, <span class="at">group =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="st">"Centroid"</span>),</span>
<span id="cb69-97"><a href="#cb69-97" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb69-98"><a href="#cb69-98" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Average force traces (dashed grey lines)</span></span>
<span id="cb69-99"><a href="#cb69-99" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> avg_force_data,</span>
<span id="cb69-100"><a href="#cb69-100" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> scaled_force, <span class="at">linetype =</span> <span class="st">"Force"</span>),</span>
<span id="cb69-101"><a href="#cb69-101" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"grey40"</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb69-102"><a href="#cb69-102" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Configure y-axis</span></span>
<span id="cb69-103"><a href="#cb69-103" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"Normalized EMG RMS"</span>) <span class="sc">+</span></span>
<span id="cb69-104"><a href="#cb69-104" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set x axis ticks</span></span>
<span id="cb69-105"><a href="#cb69-105" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb69-106"><a href="#cb69-106" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create cluster-based faceting</span></span>
<span id="cb69-107"><a href="#cb69-107" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(cluster <span class="sc">~</span> forcelevel, <span class="at">switch =</span> <span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb69-108"><a href="#cb69-108" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Apply group color scheme</span></span>
<span id="cb69-109"><a href="#cb69-109" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> group_colors, </span>
<span id="cb69-110"><a href="#cb69-110" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"strength"</span> <span class="ot">=</span> <span class="st">"Strength"</span>, <span class="st">"dexterity"</span> <span class="ot">=</span> <span class="st">"Dexterity"</span>)) <span class="sc">+</span></span>
<span id="cb69-111"><a href="#cb69-111" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set axis labels</span></span>
<span id="cb69-112"><a href="#cb69-112" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time (s)"</span>, <span class="at">color =</span> <span class="st">"Testing Group"</span>) <span class="sc">+</span></span>
<span id="cb69-113"><a href="#cb69-113" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Apply publication theme</span></span>
<span id="cb69-114"><a href="#cb69-114" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb69-115"><a href="#cb69-115" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb69-116"><a href="#cb69-116" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"none"</span>,                    <span class="co"># Remove legend for cleaner appearance</span></span>
<span id="cb69-117"><a href="#cb69-117" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),                <span class="co"># Remove grid lines</span></span>
<span id="cb69-118"><a href="#cb69-118" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),    <span class="co"># Bold strip text</span></span>
<span id="cb69-119"><a href="#cb69-119" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="cn">NA</span>), <span class="co"># Transparent strip background</span></span>
<span id="cb69-120"><a href="#cb69-120" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">11</span>),  <span class="co"># Y-axis strip formatting</span></span>
<span id="cb69-121"><a href="#cb69-121" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),  <span class="co"># X-axis strip formatting</span></span>
<span id="cb69-122"><a href="#cb69-122" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.placement =</span> <span class="st">"outside"</span>,                 <span class="co"># Place strips outside plot area</span></span>
<span id="cb69-123"><a href="#cb69-123" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>), <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb69-124"><a href="#cb69-124" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">r =</span> <span class="dv">10</span>), <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb69-125"><a href="#cb69-125" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.y.right =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">l =</span> <span class="dv">10</span>))</span>
<span id="cb69-126"><a href="#cb69-126" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb69-127"><a href="#cb69-127" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Configure line type and size aesthetics</span></span>
<span id="cb69-128"><a href="#cb69-128" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_linetype_manual</span>(<span class="at">name =</span> <span class="st">"Force"</span>, <span class="at">values =</span> <span class="st">"dashed"</span>, <span class="at">labels =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb69-129"><a href="#cb69-129" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_size_manual</span>(<span class="at">name =</span> <span class="st">"Cluster Centroid"</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="fl">0.6</span>), </span>
<span id="cb69-130"><a href="#cb69-130" aria-hidden="true" tabindex="-1"></a>                     <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb69-131"><a href="#cb69-131" aria-hidden="true" tabindex="-1"></a>                                                              <span class="at">linetype =</span> <span class="st">"solid"</span>)),</span>
<span id="cb69-132"><a href="#cb69-132" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="cn">NULL</span>)</span>
<span id="cb69-133"><a href="#cb69-133" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb69-134"><a href="#cb69-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(pub_plot)</span>
<span id="cb69-135"><a href="#cb69-135" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>fds_clusters_15_35_plot <span class="ot">&lt;-</span> <span class="fu">plot_muscle_clusters</span>(</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">analysis_results =</span> clustering_results,</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">muscle_name =</span> <span class="st">"fds"</span>,</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">force_level =</span> <span class="st">"35"</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show function for plotting representative trials for APB and FDS that did not need clustering</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FUNCTION: plot_muscle_no_clusters</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Creates publication-ready plot for FDS muscle data without clustering at 35% force level</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Inputs:</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="co"># - data: Dataset containing participant EMG data with columns:</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a><span class="co">#         time, avg_fds, avg_apb, group, participant, forcelevel, avg_force</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="co"># - muscle_name: "apb" or "fds"</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a><span class="co"># - force_level: Force level to filter (should be "35")</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Outputs: ggplot object showing all data in single "No Clusters" facet</span></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>plot_muscle_no_clusters <span class="ot">&lt;-</span> <span class="cf">function</span>(data, <span class="at">muscle_name =</span> <span class="st">"fds"</span>, <span class="at">force_level =</span> <span class="st">"35"</span>, <span class="at">strip_title =</span> <span class="cn">NULL</span>) {</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define color palette for experimental groups</span></span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>  group_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"strength"</span> <span class="ot">=</span> <span class="st">"#fe9d5d"</span>, <span class="st">"dexterity"</span> <span class="ot">=</span> <span class="st">"#456990"</span>)</span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter data to specified force level and first 10 seconds</span></span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a>  filtered_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(forcelevel <span class="sc">==</span> force_level, time <span class="sc">&lt;=</span> <span class="dv">10</span>)</span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check if data exists for specified force level</span></span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">nrow</span>(filtered_data) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb71-23"><a href="#cb71-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="fu">paste</span>(<span class="st">"No data found for force level"</span>, force_level))</span>
<span id="cb71-24"><a href="#cb71-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb71-25"><a href="#cb71-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb71-26"><a href="#cb71-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate muscle-specific column name</span></span>
<span id="cb71-27"><a href="#cb71-27" aria-hidden="true" tabindex="-1"></a>  muscle_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"avg_"</span>, muscle_name)</span>
<span id="cb71-28"><a href="#cb71-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb71-29"><a href="#cb71-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check if muscle column exists</span></span>
<span id="cb71-30"><a href="#cb71-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span>muscle_col <span class="sc">%in%</span> <span class="fu">names</span>(filtered_data)) {</span>
<span id="cb71-31"><a href="#cb71-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="fu">paste</span>(<span class="st">"Column"</span>, muscle_col, <span class="st">"not found in data"</span>))</span>
<span id="cb71-32"><a href="#cb71-32" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb71-33"><a href="#cb71-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb71-34"><a href="#cb71-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate centroids as average of all participants</span></span>
<span id="cb71-35"><a href="#cb71-35" aria-hidden="true" tabindex="-1"></a>  centroids <span class="ot">&lt;-</span> filtered_data <span class="sc">%&gt;%</span></span>
<span id="cb71-36"><a href="#cb71-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(time) <span class="sc">%&gt;%</span></span>
<span id="cb71-37"><a href="#cb71-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">value =</span> <span class="fu">mean</span>(<span class="sc">!!</span><span class="fu">sym</span>(muscle_col), <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb71-38"><a href="#cb71-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb71-39"><a href="#cb71-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add cluster label for faceting</span></span>
<span id="cb71-40"><a href="#cb71-40" aria-hidden="true" tabindex="-1"></a>  filtered_data<span class="sc">$</span>cluster <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="st">"No Clusters"</span>)</span>
<span id="cb71-41"><a href="#cb71-41" aria-hidden="true" tabindex="-1"></a>  centroids<span class="sc">$</span>cluster <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="st">"No Clusters"</span>)</span>
<span id="cb71-42"><a href="#cb71-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb71-43"><a href="#cb71-43" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create custom strip title - use provided title or default</span></span>
<span id="cb71-44"><a href="#cb71-44" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(strip_title)) {</span>
<span id="cb71-45"><a href="#cb71-45" aria-hidden="true" tabindex="-1"></a>    strip_title <span class="ot">&lt;-</span> <span class="st">"FDS: 15% and 35% MVC"</span></span>
<span id="cb71-46"><a href="#cb71-46" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb71-47"><a href="#cb71-47" aria-hidden="true" tabindex="-1"></a>  filtered_data<span class="sc">$</span>forcelevel <span class="ot">&lt;-</span> <span class="fu">factor</span>(filtered_data<span class="sc">$</span>forcelevel, </span>
<span id="cb71-48"><a href="#cb71-48" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">labels =</span> strip_title)</span>
<span id="cb71-49"><a href="#cb71-49" aria-hidden="true" tabindex="-1"></a>  centroids<span class="sc">$</span>forcelevel <span class="ot">&lt;-</span> <span class="fu">factor</span>(force_level, <span class="at">labels =</span> strip_title)</span>
<span id="cb71-50"><a href="#cb71-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb71-51"><a href="#cb71-51" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate average force traces</span></span>
<span id="cb71-52"><a href="#cb71-52" aria-hidden="true" tabindex="-1"></a>  avg_force_data <span class="ot">&lt;-</span> filtered_data <span class="sc">%&gt;%</span></span>
<span id="cb71-53"><a href="#cb71-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(time) <span class="sc">%&gt;%</span></span>
<span id="cb71-54"><a href="#cb71-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">avg_force =</span> <span class="fu">mean</span>(avg_force, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb71-55"><a href="#cb71-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb71-56"><a href="#cb71-56" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add cluster and force level labels</span></span>
<span id="cb71-57"><a href="#cb71-57" aria-hidden="true" tabindex="-1"></a>  avg_force_data<span class="sc">$</span>cluster <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="st">"No Clusters"</span>)</span>
<span id="cb71-58"><a href="#cb71-58" aria-hidden="true" tabindex="-1"></a>  avg_force_data<span class="sc">$</span>forcelevel <span class="ot">&lt;-</span> <span class="fu">factor</span>(force_level, <span class="at">labels =</span> strip_title)</span>
<span id="cb71-59"><a href="#cb71-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb71-60"><a href="#cb71-60" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Determine EMG scaling parameters</span></span>
<span id="cb71-61"><a href="#cb71-61" aria-hidden="true" tabindex="-1"></a>  muscle_range <span class="ot">&lt;-</span> <span class="fu">range</span>(filtered_data[[muscle_col]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb71-62"><a href="#cb71-62" aria-hidden="true" tabindex="-1"></a>  muscle_min <span class="ot">&lt;-</span> muscle_range[<span class="dv">1</span>]</span>
<span id="cb71-63"><a href="#cb71-63" aria-hidden="true" tabindex="-1"></a>  muscle_max <span class="ot">&lt;-</span> muscle_range[<span class="dv">2</span>]</span>
<span id="cb71-64"><a href="#cb71-64" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb71-65"><a href="#cb71-65" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Normalize force data (0-1 range)</span></span>
<span id="cb71-66"><a href="#cb71-66" aria-hidden="true" tabindex="-1"></a>  force_range <span class="ot">&lt;-</span> <span class="fu">range</span>(avg_force_data<span class="sc">$</span>avg_force, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb71-67"><a href="#cb71-67" aria-hidden="true" tabindex="-1"></a>  force_min <span class="ot">&lt;-</span> force_range[<span class="dv">1</span>]</span>
<span id="cb71-68"><a href="#cb71-68" aria-hidden="true" tabindex="-1"></a>  force_max <span class="ot">&lt;-</span> force_range[<span class="dv">2</span>]</span>
<span id="cb71-69"><a href="#cb71-69" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb71-70"><a href="#cb71-70" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply normalization if range exists</span></span>
<span id="cb71-71"><a href="#cb71-71" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(force_max <span class="sc">&gt;</span> force_min) {</span>
<span id="cb71-72"><a href="#cb71-72" aria-hidden="true" tabindex="-1"></a>    avg_force_data<span class="sc">$</span>avg_force <span class="ot">&lt;-</span> </span>
<span id="cb71-73"><a href="#cb71-73" aria-hidden="true" tabindex="-1"></a>      (avg_force_data<span class="sc">$</span>avg_force <span class="sc">-</span> force_min) <span class="sc">/</span> (force_max <span class="sc">-</span> force_min)</span>
<span id="cb71-74"><a href="#cb71-74" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb71-75"><a href="#cb71-75" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb71-76"><a href="#cb71-76" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Constrain normalized values to [0,1] range</span></span>
<span id="cb71-77"><a href="#cb71-77" aria-hidden="true" tabindex="-1"></a>  avg_force_data<span class="sc">$</span>avg_force <span class="ot">&lt;-</span> <span class="fu">pmin</span>(<span class="fu">pmax</span>(avg_force_data<span class="sc">$</span>avg_force, <span class="dv">0</span>), <span class="dv">1</span>)</span>
<span id="cb71-78"><a href="#cb71-78" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb71-79"><a href="#cb71-79" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Scale force traces to match EMG amplitude range (75% of EMG range)</span></span>
<span id="cb71-80"><a href="#cb71-80" aria-hidden="true" tabindex="-1"></a>  scale_force <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb71-81"><a href="#cb71-81" aria-hidden="true" tabindex="-1"></a>    reduced_max <span class="ot">&lt;-</span> <span class="fl">0.75</span>  <span class="co"># Scale factor to prevent force trace overlap with EMG data</span></span>
<span id="cb71-82"><a href="#cb71-82" aria-hidden="true" tabindex="-1"></a>    x_reduced <span class="ot">&lt;-</span> x <span class="sc">*</span> reduced_max</span>
<span id="cb71-83"><a href="#cb71-83" aria-hidden="true" tabindex="-1"></a>    scaled <span class="ot">&lt;-</span> ((x_reduced <span class="sc">-</span> <span class="dv">0</span>) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="dv">0</span>)) <span class="sc">*</span> (muscle_max <span class="sc">-</span> muscle_min) <span class="sc">+</span> muscle_min</span>
<span id="cb71-84"><a href="#cb71-84" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(scaled)</span>
<span id="cb71-85"><a href="#cb71-85" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb71-86"><a href="#cb71-86" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb71-87"><a href="#cb71-87" aria-hidden="true" tabindex="-1"></a>  avg_force_data<span class="sc">$</span>scaled_force <span class="ot">&lt;-</span> <span class="fu">scale_force</span>(avg_force_data<span class="sc">$</span>avg_force)</span>
<span id="cb71-88"><a href="#cb71-88" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb71-89"><a href="#cb71-89" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate publication-ready plot</span></span>
<span id="cb71-90"><a href="#cb71-90" aria-hidden="true" tabindex="-1"></a>  pub_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb71-91"><a href="#cb71-91" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Individual participant EMG time series (colored by experimental group)</span></span>
<span id="cb71-92"><a href="#cb71-92" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> filtered_data, </span>
<span id="cb71-93"><a href="#cb71-93" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> <span class="sc">!!</span><span class="fu">sym</span>(muscle_col), </span>
<span id="cb71-94"><a href="#cb71-94" aria-hidden="true" tabindex="-1"></a>                <span class="at">group =</span> participant, <span class="at">color =</span> group), <span class="at">size =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb71-95"><a href="#cb71-95" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Centroids (bold black lines)</span></span>
<span id="cb71-96"><a href="#cb71-96" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> centroids,</span>
<span id="cb71-97"><a href="#cb71-97" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> value, <span class="at">group =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="st">"Centroid"</span>),</span>
<span id="cb71-98"><a href="#cb71-98" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb71-99"><a href="#cb71-99" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Average force traces (dashed grey lines)</span></span>
<span id="cb71-100"><a href="#cb71-100" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> avg_force_data,</span>
<span id="cb71-101"><a href="#cb71-101" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> scaled_force, <span class="at">linetype =</span> <span class="st">"Force"</span>),</span>
<span id="cb71-102"><a href="#cb71-102" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"grey40"</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb71-103"><a href="#cb71-103" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Configure y-axis</span></span>
<span id="cb71-104"><a href="#cb71-104" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"Normalized EMG RMS"</span>) <span class="sc">+</span></span>
<span id="cb71-105"><a href="#cb71-105" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set x axis ticks</span></span>
<span id="cb71-106"><a href="#cb71-106" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb71-107"><a href="#cb71-107" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create cluster-based faceting</span></span>
<span id="cb71-108"><a href="#cb71-108" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(cluster <span class="sc">~</span> forcelevel, <span class="at">switch =</span> <span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb71-109"><a href="#cb71-109" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Apply group color scheme</span></span>
<span id="cb71-110"><a href="#cb71-110" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> group_colors, </span>
<span id="cb71-111"><a href="#cb71-111" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"strength"</span> <span class="ot">=</span> <span class="st">"Strength"</span>, <span class="st">"dexterity"</span> <span class="ot">=</span> <span class="st">"Dexterity"</span>)) <span class="sc">+</span></span>
<span id="cb71-112"><a href="#cb71-112" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set axis labels</span></span>
<span id="cb71-113"><a href="#cb71-113" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time (s)"</span>, <span class="at">color =</span> <span class="st">"Testing Group"</span>) <span class="sc">+</span></span>
<span id="cb71-114"><a href="#cb71-114" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Apply publication theme</span></span>
<span id="cb71-115"><a href="#cb71-115" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb71-116"><a href="#cb71-116" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb71-117"><a href="#cb71-117" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"none"</span>,                    <span class="co"># Remove legend for cleaner appearance</span></span>
<span id="cb71-118"><a href="#cb71-118" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),                <span class="co"># Remove grid lines</span></span>
<span id="cb71-119"><a href="#cb71-119" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),    <span class="co"># Bold strip text</span></span>
<span id="cb71-120"><a href="#cb71-120" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="cn">NA</span>), <span class="co"># Transparent strip background</span></span>
<span id="cb71-121"><a href="#cb71-121" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">11</span>),  <span class="co"># Y-axis strip formatting</span></span>
<span id="cb71-122"><a href="#cb71-122" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),  <span class="co"># X-axis strip formatting</span></span>
<span id="cb71-123"><a href="#cb71-123" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.placement =</span> <span class="st">"outside"</span>,                 <span class="co"># Place strips outside plot area</span></span>
<span id="cb71-124"><a href="#cb71-124" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>), <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb71-125"><a href="#cb71-125" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">r =</span> <span class="dv">10</span>), <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb71-126"><a href="#cb71-126" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.y.right =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">l =</span> <span class="dv">10</span>))</span>
<span id="cb71-127"><a href="#cb71-127" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb71-128"><a href="#cb71-128" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Configure line type and size aesthetics</span></span>
<span id="cb71-129"><a href="#cb71-129" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_linetype_manual</span>(<span class="at">name =</span> <span class="st">"Force"</span>, <span class="at">values =</span> <span class="st">"dashed"</span>, <span class="at">labels =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb71-130"><a href="#cb71-130" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_size_manual</span>(<span class="at">name =</span> <span class="st">"Cluster Centroid"</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="fl">0.6</span>), </span>
<span id="cb71-131"><a href="#cb71-131" aria-hidden="true" tabindex="-1"></a>                     <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb71-132"><a href="#cb71-132" aria-hidden="true" tabindex="-1"></a>                                                              <span class="at">linetype =</span> <span class="st">"solid"</span>)),</span>
<span id="cb71-133"><a href="#cb71-133" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="cn">NULL</span>)</span>
<span id="cb71-134"><a href="#cb71-134" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb71-135"><a href="#cb71-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(pub_plot)</span>
<span id="cb71-136"><a href="#cb71-136" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for the groups and force levels you want</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> rms_data_for_R <span class="sc">%&gt;%</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"strength"</span>, <span class="st">"dexterity"</span>), </span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>         forcelevel <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"15"</span>, <span class="st">"35"</span>, <span class="st">"55"</span>, <span class="st">"70"</span>))</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Average trials for each participant at each force level and time point</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>averaged_data <span class="ot">&lt;-</span> filtered_data <span class="sc">%&gt;%</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(participant, forcelevel, time) <span class="sc">%&gt;%</span></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_fds =</span> <span class="fu">mean</span>(fds, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_apb =</span> <span class="fu">mean</span>(apb, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_force =</span> <span class="fu">mean</span>(force, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Add group information back</span></span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>participant_groups <span class="ot">&lt;-</span> filtered_data <span class="sc">%&gt;%</span></span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(participant) <span class="sc">%&gt;%</span></span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">group =</span> <span class="fu">first</span>(group), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Join group info to averaged data</span></span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a>averaged_data <span class="ot">&lt;-</span> averaged_data <span class="sc">%&gt;%</span></span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(participant_groups, <span class="at">by =</span> <span class="st">"participant"</span>)</span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-26"><a href="#cb72-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-27"><a href="#cb72-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-28"><a href="#cb72-28" aria-hidden="true" tabindex="-1"></a>apb_clusters_plot <span class="ot">&lt;-</span> <span class="fu">plot_muscle_no_clusters</span>(averaged_data, <span class="at">muscle_name =</span> <span class="st">"apb"</span>, </span>
<span id="cb72-29"><a href="#cb72-29" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">force_level =</span> <span class="st">"70"</span>, </span>
<span id="cb72-30"><a href="#cb72-30" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">strip_title =</span> <span class="st">"APB: All Force Levels"</span>)</span>
<span id="cb72-31"><a href="#cb72-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-32"><a href="#cb72-32" aria-hidden="true" tabindex="-1"></a>fds_clusters_55_70_plot <span class="ot">&lt;-</span> <span class="fu">plot_muscle_no_clusters</span>(averaged_data, <span class="at">muscle_name =</span> <span class="st">"fds"</span>, </span>
<span id="cb72-33"><a href="#cb72-33" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">force_level =</span> <span class="st">"70"</span>,</span>
<span id="cb72-34"><a href="#cb72-34" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">strip_title =</span> <span class="st">"FDS: 55% and 70% MVC"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>fds_clusters_combined_plot <span class="ot">&lt;-</span> fds_clusters_15_35_plot <span class="sc">+</span> fds_clusters_55_70_plot <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>), <span class="at">axis_titles =</span> <span class="st">"collect_x"</span>)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>combined_cluster_plot <span class="ot">&lt;-</span> apb_clusters_plot <span class="sc">+</span> <span class="fu">plot_spacer</span>() <span class="sc">+</span> fds_clusters_combined_plot <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">heights =</span> <span class="fu">c</span>(<span class="fl">0.8</span>,<span class="fl">0.05</span>,<span class="dv">3</span>))</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(combined_cluster_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="statistical_analysis_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" width="614"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="online-resource-1" class="level2">
<h2 class="anchored" data-anchor-id="online-resource-1">Online Resource 1</h2>
<p>Table of significant pooled coherence frequencies</p>
<div class="cell">
<details class="code-fold">
<summary>Show function to get all coherence frequencies which cross the CL</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FUNCTION: compare_with_ci</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Creates tables of significant frequencies based on the coherence confidence limits from the Neurospec Toolbox.</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Inputs:</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="co"># - data: "pooled_coherence_data"</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="co"># - lower_freq_limit: Lower limit for frequencies of interest.</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a><span class="co"># - upper_freq_limit: Upper limit for frequencies of interest.</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Outputs:</span></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a><span class="co"># - Table of significant frequencies.</span></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>compare_with_ci <span class="ot">&lt;-</span> <span class="cf">function</span>(df, <span class="at">lower_freq_limit =</span> <span class="dv">8</span>, <span class="at">upper_freq_limit =</span> <span class="dv">60</span>) {</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get the CI reference value from row 1 of strength_ci_15 column</span></span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>  ci_reference <span class="ot">&lt;-</span> df<span class="sc">$</span>strength_ci_15[<span class="dv">1</span>]</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Find all coherence columns</span></span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>  coh_cols <span class="ot">&lt;-</span> <span class="fu">names</span>(df)[<span class="fu">grepl</span>(<span class="st">"_(coh|cohxy)_"</span>, <span class="fu">names</span>(df))]</span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialize empty lists for results</span></span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a>  all_mvcs <span class="ot">&lt;-</span> <span class="fu">character</span>()</span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a>  all_groups <span class="ot">&lt;-</span> <span class="fu">character</span>()</span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a>  all_frequencies <span class="ot">&lt;-</span> <span class="fu">numeric</span>()</span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Process each coherence column</span></span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(col_name <span class="cf">in</span> coh_cols) {</span>
<span id="cb74-25"><a href="#cb74-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract testing group and force level from column name</span></span>
<span id="cb74-26"><a href="#cb74-26" aria-hidden="true" tabindex="-1"></a>    parts <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(col_name, <span class="st">"_"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb74-27"><a href="#cb74-27" aria-hidden="true" tabindex="-1"></a>    testing_group <span class="ot">&lt;-</span> parts[<span class="dv">1</span>]  <span class="co"># "strength" or "dexterity"</span></span>
<span id="cb74-28"><a href="#cb74-28" aria-hidden="true" tabindex="-1"></a>    force_level <span class="ot">&lt;-</span> parts[<span class="dv">3</span>]    <span class="co"># "15", "35", "55", or "70"</span></span>
<span id="cb74-29"><a href="#cb74-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-30"><a href="#cb74-30" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Compare direct values against CL</span></span>
<span id="cb74-31"><a href="#cb74-31" aria-hidden="true" tabindex="-1"></a>      comparison_df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb74-32"><a href="#cb74-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(freq <span class="sc">&gt;=</span> lower_freq_limit, freq <span class="sc">&lt;=</span> upper_freq_limit, </span>
<span id="cb74-33"><a href="#cb74-33" aria-hidden="true" tabindex="-1"></a>               .data[[col_name]] <span class="sc">&gt;</span> ci_reference)</span>
<span id="cb74-34"><a href="#cb74-34" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb74-35"><a href="#cb74-35" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Determine group from column name</span></span>
<span id="cb74-36"><a href="#cb74-36" aria-hidden="true" tabindex="-1"></a>      group <span class="ot">&lt;-</span> <span class="cf">if</span>(<span class="fu">grepl</span>(<span class="st">"strength"</span>, testing_group, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>)) </span>
<span id="cb74-37"><a href="#cb74-37" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Strength"</span> <span class="cf">else</span> <span class="st">"Dexterity"</span></span>
<span id="cb74-38"><a href="#cb74-38" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb74-39"><a href="#cb74-39" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Add results to vectors</span></span>
<span id="cb74-40"><a href="#cb74-40" aria-hidden="true" tabindex="-1"></a>      all_mvcs <span class="ot">&lt;-</span> <span class="fu">c</span>(all_mvcs, <span class="fu">rep</span>(force_level, <span class="fu">nrow</span>(comparison_df)))</span>
<span id="cb74-41"><a href="#cb74-41" aria-hidden="true" tabindex="-1"></a>      all_groups <span class="ot">&lt;-</span> <span class="fu">c</span>(all_groups, <span class="fu">rep</span>(group, <span class="fu">nrow</span>(comparison_df)))</span>
<span id="cb74-42"><a href="#cb74-42" aria-hidden="true" tabindex="-1"></a>      all_frequencies <span class="ot">&lt;-</span> <span class="fu">c</span>(all_frequencies, comparison_df<span class="sc">$</span>freq)</span>
<span id="cb74-43"><a href="#cb74-43" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb74-44"><a href="#cb74-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb74-45"><a href="#cb74-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create final long format dataframe</span></span>
<span id="cb74-46"><a href="#cb74-46" aria-hidden="true" tabindex="-1"></a>  results_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb74-47"><a href="#cb74-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">MVC =</span> all_mvcs,</span>
<span id="cb74-48"><a href="#cb74-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">Group =</span> all_groups,</span>
<span id="cb74-49"><a href="#cb74-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">Frequencies =</span> <span class="fu">round</span>(all_frequencies,<span class="dv">2</span>)</span>
<span id="cb74-50"><a href="#cb74-50" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb74-51"><a href="#cb74-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb74-52"><a href="#cb74-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert MVC to numeric and sort</span></span>
<span id="cb74-53"><a href="#cb74-53" aria-hidden="true" tabindex="-1"></a>  results_df<span class="sc">$</span>MVC <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(results_df<span class="sc">$</span>MVC)</span>
<span id="cb74-54"><a href="#cb74-54" aria-hidden="true" tabindex="-1"></a>  results_df <span class="ot">&lt;-</span> results_df <span class="sc">%&gt;%</span></span>
<span id="cb74-55"><a href="#cb74-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(MVC, Group)</span>
<span id="cb74-56"><a href="#cb74-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb74-57"><a href="#cb74-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(results_df)</span>
<span id="cb74-58"><a href="#cb74-58" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify the significant results</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>significant_coherence_results <span class="ot">&lt;-</span> <span class="fu">compare_with_ci</span>(pooled_coherence_data) <span class="sc">%&gt;%</span> </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Significant Frequencies"</span> <span class="ot">=</span> Frequencies)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create table</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(significant_coherence_results,</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">align =</span> <span class="fu">c</span>(<span class="st">'c'</span>, <span class="st">'c'</span>, <span class="st">'c'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>),</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">width =</span> <span class="st">"100px"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collapse_rows</span>(<span class="at">columns =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">valign =</span> <span class="st">"middle"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">MVC</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Group</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Significant Frequencies</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="7" style="text-align: center; width: 100px; vertical-align: middle !important;">15</td>
<td rowspan="5" style="text-align: center; width: 100px; vertical-align: middle !important;">Dexterity</td>
<td style="text-align: center; width: 100px;">19.53</td>
</tr>
<tr class="even">
<td style="text-align: center; width: 100px;">21.70</td>
</tr>
<tr class="odd">
<td style="text-align: center; width: 100px;">32.55</td>
</tr>
<tr class="even">
<td style="text-align: center; width: 100px;">34.72</td>
</tr>
<tr class="odd">
<td style="text-align: center; width: 100px;">36.89</td>
</tr>
<tr class="even">
<td rowspan="2" style="text-align: center; width: 100px; vertical-align: middle !important;">Strength</td>
<td style="text-align: center; width: 100px;">13.02</td>
</tr>
<tr class="odd">
<td style="text-align: center; width: 100px;">41.23</td>
</tr>
<tr class="even">
<td rowspan="6" style="text-align: center; width: 100px; vertical-align: middle !important;">35</td>
<td rowspan="4" style="text-align: center; width: 100px; vertical-align: middle !important;">Dexterity</td>
<td style="text-align: center; width: 100px;">10.85</td>
</tr>
<tr class="odd">
<td style="text-align: center; width: 100px;">13.02</td>
</tr>
<tr class="even">
<td style="text-align: center; width: 100px;">32.55</td>
</tr>
<tr class="odd">
<td style="text-align: center; width: 100px;">47.74</td>
</tr>
<tr class="even">
<td rowspan="2" style="text-align: center; width: 100px; vertical-align: middle !important;">Strength</td>
<td style="text-align: center; width: 100px;">36.89</td>
</tr>
<tr class="odd">
<td style="text-align: center; width: 100px;">45.57</td>
</tr>
<tr class="even">
<td rowspan="10" style="text-align: center; width: 100px; vertical-align: middle !important;">55</td>
<td rowspan="6" style="text-align: center; width: 100px; vertical-align: middle !important;">Dexterity</td>
<td style="text-align: center; width: 100px;">13.02</td>
</tr>
<tr class="odd">
<td style="text-align: center; width: 100px;">17.36</td>
</tr>
<tr class="even">
<td style="text-align: center; width: 100px;">32.55</td>
</tr>
<tr class="odd">
<td style="text-align: center; width: 100px;">36.89</td>
</tr>
<tr class="even">
<td style="text-align: center; width: 100px;">43.40</td>
</tr>
<tr class="odd">
<td style="text-align: center; width: 100px;">49.91</td>
</tr>
<tr class="even">
<td rowspan="4" style="text-align: center; width: 100px; vertical-align: middle !important;">Strength</td>
<td style="text-align: center; width: 100px;">10.85</td>
</tr>
<tr class="odd">
<td style="text-align: center; width: 100px;">15.19</td>
</tr>
<tr class="even">
<td style="text-align: center; width: 100px;">23.87</td>
</tr>
<tr class="odd">
<td style="text-align: center; width: 100px;">56.42</td>
</tr>
<tr class="even">
<td rowspan="7" style="text-align: center; width: 100px; vertical-align: middle !important;">70</td>
<td rowspan="3" style="text-align: center; width: 100px; vertical-align: middle !important;">Dexterity</td>
<td style="text-align: center; width: 100px;">10.85</td>
</tr>
<tr class="odd">
<td style="text-align: center; width: 100px;">36.89</td>
</tr>
<tr class="even">
<td style="text-align: center; width: 100px;">43.40</td>
</tr>
<tr class="odd">
<td rowspan="4" style="text-align: center; width: 100px; vertical-align: middle !important;">Strength</td>
<td style="text-align: center; width: 100px;">17.36</td>
</tr>
<tr class="even">
<td style="text-align: center; width: 100px;">19.53</td>
</tr>
<tr class="odd">
<td style="text-align: center; width: 100px;">45.57</td>
</tr>
<tr class="even">
<td style="text-align: center; width: 100px;">49.91</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="online-resource-2" class="level2">
<h2 class="anchored" data-anchor-id="online-resource-2">Online Resource 2</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>cluster_coherence <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"cluster_coherence.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show function to plot coherence analysis for participant subclusters</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FUNCTION: create_cluster_vs_pooled_ci_scaled</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Function for subcluster coherence analysis, compared with full dataset (scaled based on CI).</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Inputs:</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="co"># - cluster_data: "cluster_coherence"</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="co"># - pooled_data: "pooled_coherence_data"</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a><span class="co"># - mvc_level: 15, 35</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a><span class="co"># - test_type: str or dext</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a><span class="co"># - ci_position: scales the confidence interval (diff no. of participants)</span></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Outputs:</span></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a><span class="co"># - Plots comparing coherence of expected cluster subgroup vs entire dataset</span></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>create_cluster_vs_pooled_ci_scaled <span class="ot">&lt;-</span> <span class="cf">function</span>(cluster_data, pooled_data, mvc_level, test_type, <span class="at">ci_position =</span> <span class="fl">0.75</span>) {</span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define data types</span></span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>  data_types <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"cluster1"</span>, <span class="st">"pooled"</span>)</span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create empty list to store reshaped data</span></span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a>  plot_data_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a>  ci_values <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(data_types))</span>
<span id="cb77-21"><a href="#cb77-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb77-22"><a href="#cb77-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Reshape data</span></span>
<span id="cb77-23"><a href="#cb77-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(data_types)) {</span>
<span id="cb77-24"><a href="#cb77-24" aria-hidden="true" tabindex="-1"></a>    data_type <span class="ot">&lt;-</span> data_types[i]</span>
<span id="cb77-25"><a href="#cb77-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb77-26"><a href="#cb77-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (data_type <span class="sc">==</span> <span class="st">"cluster1"</span>) {</span>
<span id="cb77-27"><a href="#cb77-27" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Construct column names for cluster data</span></span>
<span id="cb77-28"><a href="#cb77-28" aria-hidden="true" tabindex="-1"></a>      coh_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"clust1_"</span>, mvc_level, <span class="st">"_"</span>, test_type)</span>
<span id="cb77-29"><a href="#cb77-29" aria-hidden="true" tabindex="-1"></a>      ci_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"ci_clust1_"</span>, mvc_level, <span class="st">"_"</span>, test_type)</span>
<span id="cb77-30"><a href="#cb77-30" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb77-31"><a href="#cb77-31" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Create subset with necessary columns</span></span>
<span id="cb77-32"><a href="#cb77-32" aria-hidden="true" tabindex="-1"></a>      temp_data <span class="ot">&lt;-</span> cluster_data[, <span class="fu">c</span>(<span class="st">"f"</span>, coh_col, ci_col)]</span>
<span id="cb77-33"><a href="#cb77-33" aria-hidden="true" tabindex="-1"></a>      <span class="fu">names</span>(temp_data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"freq"</span>, <span class="st">"coherence"</span>, <span class="st">"ci"</span>)</span>
<span id="cb77-34"><a href="#cb77-34" aria-hidden="true" tabindex="-1"></a>      temp_data<span class="sc">$</span>data_type <span class="ot">&lt;-</span> data_type</span>
<span id="cb77-35"><a href="#cb77-35" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb77-36"><a href="#cb77-36" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (data_type <span class="sc">==</span> <span class="st">"pooled"</span>) {</span>
<span id="cb77-37"><a href="#cb77-37" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Construct column names for pooled data</span></span>
<span id="cb77-38"><a href="#cb77-38" aria-hidden="true" tabindex="-1"></a>      group_name <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(test_type <span class="sc">==</span> <span class="st">"str"</span>, <span class="st">"strength"</span>, <span class="st">"dexterity"</span>)</span>
<span id="cb77-39"><a href="#cb77-39" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Extract just the number from mvc_level (e.g., "15mvc" -&gt; "15")</span></span>
<span id="cb77-40"><a href="#cb77-40" aria-hidden="true" tabindex="-1"></a>      mvc_number <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"mvc"</span>, <span class="st">""</span>, mvc_level)</span>
<span id="cb77-41"><a href="#cb77-41" aria-hidden="true" tabindex="-1"></a>      coh_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(group_name, <span class="st">"_coh_"</span>, mvc_number)</span>
<span id="cb77-42"><a href="#cb77-42" aria-hidden="true" tabindex="-1"></a>      ci_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(group_name, <span class="st">"_ci_"</span>, mvc_number)</span>
<span id="cb77-43"><a href="#cb77-43" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb77-44"><a href="#cb77-44" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Create subset with necessary columns</span></span>
<span id="cb77-45"><a href="#cb77-45" aria-hidden="true" tabindex="-1"></a>      temp_data <span class="ot">&lt;-</span> pooled_data[, <span class="fu">c</span>(<span class="st">"freq"</span>, coh_col, ci_col)]</span>
<span id="cb77-46"><a href="#cb77-46" aria-hidden="true" tabindex="-1"></a>      <span class="fu">names</span>(temp_data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"freq"</span>, <span class="st">"coherence"</span>, <span class="st">"ci"</span>)</span>
<span id="cb77-47"><a href="#cb77-47" aria-hidden="true" tabindex="-1"></a>      temp_data<span class="sc">$</span>data_type <span class="ot">&lt;-</span> data_type</span>
<span id="cb77-48"><a href="#cb77-48" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb77-49"><a href="#cb77-49" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb77-50"><a href="#cb77-50" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Store CI value for scaling</span></span>
<span id="cb77-51"><a href="#cb77-51" aria-hidden="true" tabindex="-1"></a>    ci_values[i] <span class="ot">&lt;-</span> <span class="fu">unique</span>(temp_data<span class="sc">$</span>ci)[<span class="dv">1</span>]  <span class="co"># Assuming CI is constant within each dataset</span></span>
<span id="cb77-52"><a href="#cb77-52" aria-hidden="true" tabindex="-1"></a>    plot_data_list <span class="ot">&lt;-</span> <span class="fu">append</span>(plot_data_list, <span class="fu">list</span>(temp_data))</span>
<span id="cb77-53"><a href="#cb77-53" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb77-54"><a href="#cb77-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb77-55"><a href="#cb77-55" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine all data</span></span>
<span id="cb77-56"><a href="#cb77-56" aria-hidden="true" tabindex="-1"></a>  long_data <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, plot_data_list)</span>
<span id="cb77-57"><a href="#cb77-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb77-58"><a href="#cb77-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert to factors for proper ordering</span></span>
<span id="cb77-59"><a href="#cb77-59" aria-hidden="true" tabindex="-1"></a>  long_data<span class="sc">$</span>data_type <span class="ot">&lt;-</span> <span class="fu">factor</span>(long_data<span class="sc">$</span>data_type, </span>
<span id="cb77-60"><a href="#cb77-60" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"cluster1"</span>, <span class="st">"pooled"</span>))</span>
<span id="cb77-61"><a href="#cb77-61" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb77-62"><a href="#cb77-62" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate y-axis limits based on CI position</span></span>
<span id="cb77-63"><a href="#cb77-63" aria-hidden="true" tabindex="-1"></a>  <span class="co"># CI should appear at ci_position (e.g., 0.2 = 20% up the y-axis)</span></span>
<span id="cb77-64"><a href="#cb77-64" aria-hidden="true" tabindex="-1"></a>  y_max_cluster <span class="ot">&lt;-</span> ci_values[<span class="dv">1</span>] <span class="sc">/</span> ci_position</span>
<span id="cb77-65"><a href="#cb77-65" aria-hidden="true" tabindex="-1"></a>  y_max_pooled <span class="ot">&lt;-</span> ci_values[<span class="dv">2</span>] <span class="sc">/</span> ci_position</span>
<span id="cb77-66"><a href="#cb77-66" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb77-67"><a href="#cb77-67" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define colors based on test type</span></span>
<span id="cb77-68"><a href="#cb77-68" aria-hidden="true" tabindex="-1"></a>  line_color <span class="ot">&lt;-</span> <span class="cf">switch</span>(test_type,</span>
<span id="cb77-69"><a href="#cb77-69" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"str"</span> <span class="ot">=</span> <span class="st">"#fe9d5d"</span>,</span>
<span id="cb77-70"><a href="#cb77-70" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"dext"</span> <span class="ot">=</span> <span class="st">"#456990"</span>,</span>
<span id="cb77-71"><a href="#cb77-71" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"#000000"</span>)  <span class="co"># default black if neither</span></span>
<span id="cb77-72"><a href="#cb77-72" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb77-73"><a href="#cb77-73" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the faceted plot</span></span>
<span id="cb77-74"><a href="#cb77-74" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(long_data, <span class="fu">aes</span>(<span class="at">x =</span> freq)) <span class="sc">+</span></span>
<span id="cb77-75"><a href="#cb77-75" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add frequency band annotations scaled to each subplot (behind lines)</span></span>
<span id="cb77-76"><a href="#cb77-76" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="dv">8</span>, <span class="at">xmax =</span> <span class="dv">16</span>, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> y_max_cluster,</span>
<span id="cb77-77"><a href="#cb77-77" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> <span class="st">"grey90"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb77-78"><a href="#cb77-78" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="dv">16</span>, <span class="at">xmax =</span> <span class="dv">30</span>, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> y_max_cluster,</span>
<span id="cb77-79"><a href="#cb77-79" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> <span class="st">"grey75"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb77-80"><a href="#cb77-80" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="dv">30</span>, <span class="at">xmax =</span> <span class="dv">60</span>, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> y_max_cluster,</span>
<span id="cb77-81"><a href="#cb77-81" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> <span class="st">"grey60"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb77-82"><a href="#cb77-82" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add symbols for Cluster 1 (positioned relative to its scale)</span></span>
<span id="cb77-83"><a href="#cb77-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">12</span>, <span class="at">y =</span> y_max_cluster <span class="sc">*</span> <span class="fl">0.85</span>, <span class="at">label =</span> <span class="st">"\u03B1"</span>, <span class="at">size =</span> <span class="dv">12</span><span class="sc">/</span>.pt) <span class="sc">+</span></span>
<span id="cb77-84"><a href="#cb77-84" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">22</span>, <span class="at">y =</span> y_max_cluster <span class="sc">*</span> <span class="fl">0.85</span>, <span class="at">label =</span> <span class="st">"\u03B2"</span>, <span class="at">size =</span> <span class="dv">12</span><span class="sc">/</span>.pt) <span class="sc">+</span></span>
<span id="cb77-85"><a href="#cb77-85" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">45</span>, <span class="at">y =</span> y_max_cluster <span class="sc">*</span> <span class="fl">0.85</span>, <span class="at">label =</span> <span class="st">"\u03B3"</span>, <span class="at">size =</span> <span class="dv">12</span><span class="sc">/</span>.pt) <span class="sc">+</span></span>
<span id="cb77-86"><a href="#cb77-86" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add coherence line</span></span>
<span id="cb77-87"><a href="#cb77-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> coherence), <span class="at">color =</span> line_color, <span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb77-88"><a href="#cb77-88" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add confidence interval as dashed line</span></span>
<span id="cb77-89"><a href="#cb77-89" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> ci), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb77-90"><a href="#cb77-90" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set axis limits and breaks</span></span>
<span id="cb77-91"><a href="#cb77-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(</span>
<span id="cb77-92"><a href="#cb77-92" aria-hidden="true" tabindex="-1"></a>      <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">65</span>),</span>
<span id="cb77-93"><a href="#cb77-93" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">60</span>, <span class="at">by =</span> <span class="dv">10</span>),</span>
<span id="cb77-94"><a href="#cb77-94" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Frequency (Hz)"</span>,</span>
<span id="cb77-95"><a href="#cb77-95" aria-hidden="true" tabindex="-1"></a>      <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>))</span>
<span id="cb77-96"><a href="#cb77-96" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb77-97"><a href="#cb77-97" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create facets with free y scales</span></span>
<span id="cb77-98"><a href="#cb77-98" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(data_type <span class="sc">~</span> .,</span>
<span id="cb77-99"><a href="#cb77-99" aria-hidden="true" tabindex="-1"></a>               <span class="at">scales =</span> <span class="st">"free_y"</span>,</span>
<span id="cb77-100"><a href="#cb77-100" aria-hidden="true" tabindex="-1"></a>               <span class="at">switch =</span> <span class="st">"y"</span>, </span>
<span id="cb77-101"><a href="#cb77-101" aria-hidden="true" tabindex="-1"></a>               <span class="at">labeller =</span> <span class="fu">labeller</span>(</span>
<span id="cb77-102"><a href="#cb77-102" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data_type =</span> <span class="fu">c</span>(<span class="st">"cluster1"</span> <span class="ot">=</span> <span class="st">"Cluster 1 only"</span>, <span class="st">"pooled"</span> <span class="ot">=</span> <span class="st">"All data"</span>)</span>
<span id="cb77-103"><a href="#cb77-103" aria-hidden="true" tabindex="-1"></a>               )) <span class="sc">+</span></span>
<span id="cb77-104"><a href="#cb77-104" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Theme modifications</span></span>
<span id="cb77-105"><a href="#cb77-105" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb77-106"><a href="#cb77-106" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb77-107"><a href="#cb77-107" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb77-108"><a href="#cb77-108" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb77-109"><a href="#cb77-109" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb77-110"><a href="#cb77-110" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb77-111"><a href="#cb77-111" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb77-112"><a href="#cb77-112" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb77-113"><a href="#cb77-113" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Change Axis Fonts</span></span>
<span id="cb77-114"><a href="#cb77-114" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb77-115"><a href="#cb77-115" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb77-116"><a href="#cb77-116" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb77-117"><a href="#cb77-117" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb77-118"><a href="#cb77-118" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"grey70"</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>),</span>
<span id="cb77-119"><a href="#cb77-119" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey30"</span>, <span class="at">linewidth =</span> <span class="fl">0.3</span>),</span>
<span id="cb77-120"><a href="#cb77-120" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="cn">NA</span>, <span class="at">fill =</span> <span class="st">"grey90"</span>)</span>
<span id="cb77-121"><a href="#cb77-121" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb77-122"><a href="#cb77-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-123"><a href="#cb77-123" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb77-124"><a href="#cb77-124" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define custom y scales for each data type</span></span>
<span id="cb77-125"><a href="#cb77-125" aria-hidden="true" tabindex="-1"></a>  y_scales <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb77-126"><a href="#cb77-126" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Cluster 1 - scaled based on its CI</span></span>
<span id="cb77-127"><a href="#cb77-127" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(</span>
<span id="cb77-128"><a href="#cb77-128" aria-hidden="true" tabindex="-1"></a>      <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, y_max_cluster), </span>
<span id="cb77-129"><a href="#cb77-129" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> <span class="fu">round</span>(<span class="fu">seq</span>(<span class="dv">0</span>, y_max_cluster, <span class="at">length.out =</span> <span class="dv">3</span>), <span class="dv">2</span>),</span>
<span id="cb77-130"><a href="#cb77-130" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Coherence Estimate"</span>, </span>
<span id="cb77-131"><a href="#cb77-131" aria-hidden="true" tabindex="-1"></a>     <span class="co"># expand = expansion(mult = c(0, 0.02))</span></span>
<span id="cb77-132"><a href="#cb77-132" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb77-133"><a href="#cb77-133" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Pooled - scaled based on its CI</span></span>
<span id="cb77-134"><a href="#cb77-134" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(</span>
<span id="cb77-135"><a href="#cb77-135" aria-hidden="true" tabindex="-1"></a>      <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, y_max_pooled), </span>
<span id="cb77-136"><a href="#cb77-136" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> <span class="fu">round</span>(<span class="fu">seq</span>(<span class="dv">0</span>, y_max_pooled, <span class="at">length.out =</span> <span class="dv">3</span>), <span class="dv">2</span>),</span>
<span id="cb77-137"><a href="#cb77-137" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Coherence Estimate"</span>, </span>
<span id="cb77-138"><a href="#cb77-138" aria-hidden="true" tabindex="-1"></a>     <span class="co"># expand = expansion(mult = c(0, 0.02))</span></span>
<span id="cb77-139"><a href="#cb77-139" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb77-140"><a href="#cb77-140" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb77-141"><a href="#cb77-141" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb77-142"><a href="#cb77-142" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply custom scales</span></span>
<span id="cb77-143"><a href="#cb77-143" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">facetted_pos_scales</span>(<span class="at">y =</span> y_scales)</span>
<span id="cb77-144"><a href="#cb77-144" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb77-145"><a href="#cb77-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb77-146"><a href="#cb77-146" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plots</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>plot_15mvc_dext_ci <span class="ot">&lt;-</span> <span class="fu">create_cluster_vs_pooled_ci_scaled</span>(cluster_coherence, pooled_coherence_data, <span class="st">"15mvc"</span>, <span class="st">"dext"</span>, <span class="at">ci_position =</span> <span class="fl">0.25</span>)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>plot_15mvc_str_ci <span class="ot">&lt;-</span> <span class="fu">create_cluster_vs_pooled_ci_scaled</span>(cluster_coherence, pooled_coherence_data, <span class="st">"15mvc"</span>, <span class="st">"str"</span>, <span class="at">ci_position =</span> <span class="fl">0.25</span>)</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>plot_35mvc_str_ci <span class="ot">&lt;-</span> <span class="fu">create_cluster_vs_pooled_ci_scaled</span>(cluster_coherence, pooled_coherence_data, <span class="st">"35mvc"</span>, <span class="st">"str"</span>, <span class="at">ci_position =</span> <span class="fl">0.25</span>)</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>plot_35mvc_dext_ci <span class="ot">&lt;-</span> <span class="fu">create_cluster_vs_pooled_ci_scaled</span>(cluster_coherence, pooled_coherence_data, <span class="st">"35mvc"</span>, <span class="st">"dext"</span>, <span class="at">ci_position =</span> <span class="fl">0.25</span>)</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine plots with patchwork</span></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 15% MVC</span></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>combined_15_cluster_vs_pooled_ci <span class="ot">&lt;-</span> plot_15mvc_str_ci <span class="sc">+</span> <span class="fu">plot_spacer</span>() <span class="sc">+</span> plot_15mvc_dext_ci <span class="sc">+</span> </span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">widths =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.01</span>,<span class="fl">0.5</span>)) <span class="sc">+</span> </span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"15% MVC"</span>, </span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">theme =</span> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 35% MVC</span></span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>combined_35_cluster_vs_pooled_ci <span class="ot">&lt;-</span> plot_35mvc_str_ci <span class="sc">+</span> <span class="fu">plot_spacer</span>() <span class="sc">+</span> plot_35mvc_dext_ci <span class="sc">+</span> </span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">widths =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.01</span>,<span class="fl">0.5</span>)) <span class="sc">+</span> </span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"35% MVC"</span>, </span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">theme =</span> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-24"><a href="#cb78-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-25"><a href="#cb78-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function to create titles</span></span>
<span id="cb78-26"><a href="#cb78-26" aria-hidden="true" tabindex="-1"></a>title_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(title_text) {</span>
<span id="cb78-27"><a href="#cb78-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb78-28"><a href="#cb78-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Draw a grey rectangle</span></span>
<span id="cb78-29"><a href="#cb78-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">xmax =</span> <span class="cn">Inf</span>, <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">ymax =</span> <span class="cn">Inf</span>, <span class="at">fill =</span> <span class="st">"grey90"</span>) <span class="sc">+</span></span>
<span id="cb78-30"><a href="#cb78-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add centered title text</span></span>
<span id="cb78-31"><a href="#cb78-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">label =</span> title_text, <span class="at">size =</span> <span class="dv">5</span>, </span>
<span id="cb78-32"><a href="#cb78-32" aria-hidden="true" tabindex="-1"></a>             <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb78-33"><a href="#cb78-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ensure no axis lines, ticks, or labels</span></span>
<span id="cb78-34"><a href="#cb78-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb78-35"><a href="#cb78-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb78-36"><a href="#cb78-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>) </span>
<span id="cb78-37"><a href="#cb78-37" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb78-38"><a href="#cb78-38" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-39"><a href="#cb78-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-40"><a href="#cb78-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Create titles</span></span>
<span id="cb78-41"><a href="#cb78-41" aria-hidden="true" tabindex="-1"></a>title_15 <span class="ot">&lt;-</span> <span class="fu">title_plot</span>(<span class="st">"15% MVC"</span>)</span>
<span id="cb78-42"><a href="#cb78-42" aria-hidden="true" tabindex="-1"></a>title_35 <span class="ot">&lt;-</span> <span class="fu">title_plot</span>(<span class="st">"35% MVC"</span>)</span>
<span id="cb78-43"><a href="#cb78-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-44"><a href="#cb78-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all plots together</span></span>
<span id="cb78-45"><a href="#cb78-45" aria-hidden="true" tabindex="-1"></a>cluster_coherence_plot <span class="ot">&lt;-</span> <span class="fu">free</span>(title_15) <span class="sc">/</span> combined_15_cluster_vs_pooled_ci <span class="sc">/</span> <span class="fu">plot_spacer</span>() <span class="sc">/</span><span class="fu">free</span>(title_35) <span class="sc">/</span> combined_35_cluster_vs_pooled_ci <span class="sc">+</span></span>
<span id="cb78-46"><a href="#cb78-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">heights =</span> <span class="fu">c</span>(<span class="fl">0.07</span>,<span class="fl">0.5</span>, <span class="fl">0.001</span>, <span class="fl">0.07</span>, <span class="fl">0.5</span>))</span>
<span id="cb78-47"><a href="#cb78-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-48"><a href="#cb78-48" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cluster_coherence_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="statistical_analysis_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid figure-img" width="652"></p>
</figure>
</div>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>